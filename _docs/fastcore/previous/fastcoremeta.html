<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>debuggable – delegates</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">debuggable</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/EmbraceLife/debuggable/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">(Untitled)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Fastai Debuggable</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../README.html" class="sidebar-item-text sidebar-link">Fastai Debuggable</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../utils.html" class="sidebar-item-text sidebar-link">debuggable utils</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">fastcore</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../fastcore/classes_metaclasses.html" class="sidebar-item-text sidebar-link">classes and metaclasses</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">findings</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../fastcore/findings/00F_delegates_keep.html" class="sidebar-item-text sidebar-link">Findings from <a href="https://fastcore.fast.ai/meta.html#delegates"><code>fastcore.meta.delegates</code></a></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">meta</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../fastcore/meta/00_delegates.html" class="sidebar-item-text sidebar-link">fastcore.meta.delegates</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../fastcore/meta/01_mk_param.html" class="sidebar-item-text sidebar-link">fastcore.meta._mk_param</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../fastcore/meta/02_use_kwargs_dict.html" class="sidebar-item-text sidebar-link">fastcore.meta.use_kwargs_dict</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">previous</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../fastcore/previous/fastcoremeta.html" class="sidebar-item-text sidebar-link active">fastcore_meta</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#fastcore_meta" id="toc-fastcore_meta" class="nav-link active" data-scroll-target="#fastcore_meta">fastcore_meta</a>
  <ul class="collapse">
  <li><a href="#delegates" id="toc-delegates" class="nav-link" data-scroll-target="#delegates">Delegates</a>
  <ul class="collapse">
  <li><a href="#import-libraries" id="toc-import-libraries" class="nav-link" data-scroll-target="#import-libraries">Import libraries</a></li>
  <li><a href="#reading-the-doc" id="toc-reading-the-doc" class="nav-link" data-scroll-target="#reading-the-doc">Reading the doc</a>
  <ul class="collapse">
  <li><a href="#how-sig-access-signature-quick-doc-and-full-doc" id="toc-how-sig-access-signature-quick-doc-and-full-doc" class="nav-link" data-scroll-target="#how-sig-access-signature-quick-doc-and-full-doc">how-sig: access signature, quick doc and full doc</a></li>
  <li><a href="#how-assert-use-assert" id="toc-how-assert-use-assert" class="nav-link" data-scroll-target="#how-assert-use-assert">how-assert: use <code>assert</code></a></li>
  <li><a href="#how-delegates-which-params-passed-to-f-from-to-in-source" id="toc-how-delegates-which-params-passed-to-f-from-to-in-source" class="nav-link" data-scroll-target="#how-delegates-which-params-passed-to-f-from-to-in-source">how-delegates: Which params passed to <code>f</code> from <code>to</code> in source?</a></li>
  <li><a href="#how-deletates-when-params-in-f-conflict-with-kwargs-of-to" id="toc-how-deletates-when-params-in-f-conflict-with-kwargs-of-to" class="nav-link" data-scroll-target="#how-deletates-when-params-in-f-conflict-with-kwargs-of-to">how-deletates: when params in <code>f</code> conflict with kwargs of <code>to</code></a></li>
  <li><a href="#how-sig-test_sig" id="toc-how-sig-test_sig" class="nav-link" data-scroll-target="#how-sig-test_sig">how-sig: <code>test_sig</code></a></li>
  <li><a href="#how-delegates-on-classmethod-and-instant-method" id="toc-how-delegates-on-classmethod-and-instant-method" class="nav-link" data-scroll-target="#how-delegates-on-classmethod-and-instant-method">how-delegates: on classmethod and instant method</a></li>
  <li><a href="#how-delegates-on-super-class-or-__init__-func-in-fact" id="toc-how-delegates-on-super-class-or-__init__-func-in-fact" class="nav-link" data-scroll-target="#how-delegates-on-super-class-or-__init__-func-in-fact">how-delegates: on super class or <code>__init__</code> func in fact</a></li>
  <li><a href="#how-delegates-on-other-class" id="toc-how-delegates-on-other-class" class="nav-link" data-scroll-target="#how-delegates-on-other-class">how-delegates: on other class</a></li>
  <li><a href="#how-delegates-before-its-time" id="toc-how-delegates-before-its-time" class="nav-link" data-scroll-target="#how-delegates-before-its-time">how-delegates: before its time</a></li>
  <li><a href="#how-delegates-under-its-reign" id="toc-how-delegates-under-its-reign" class="nav-link" data-scroll-target="#how-delegates-under-its-reign">how-delegates: under its reign</a></li>
  <li><a href="#how-show_doc-show_doc-can-even-informs-you-which-kwargs-are-passed-to-other-funcs" id="toc-how-show_doc-show_doc-can-even-informs-you-which-kwargs-are-passed-to-other-funcs" class="nav-link" data-scroll-target="#how-show_doc-show_doc-can-even-informs-you-which-kwargs-are-passed-to-other-funcs">how-show_doc: <code>show_doc</code> can even informs you which kwargs are passed to other funcs</a></li>
  <li><a href="#how-delegates-use-keeptrue-and-but" id="toc-how-delegates-use-keeptrue-and-but" class="nav-link" data-scroll-target="#how-delegates-use-keeptrue-and-but">how-delegates: use <code>keep=True</code> and <code>but</code></a></li>
  <li><a href="#how-delegates-without" id="toc-how-delegates-without" class="nav-link" data-scroll-target="#how-delegates-without">how-delegates: without <code>@</code></a></li>
  </ul></li>
  <li><a href="#the-anatomy-of-delegates" id="toc-the-anatomy-of-delegates" class="nav-link" data-scroll-target="#the-anatomy-of-delegates">The anatomy of <code>delegates</code></a>
  <ul class="collapse">
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  <li><a href="#params-and-inputs" id="toc-params-and-inputs" class="nav-link" data-scroll-target="#params-and-inputs">Params and inputs</a></li>
  <li><a href="#prepare-to-and-f" id="toc-prepare-to-and-f" class="nav-link" data-scroll-target="#prepare-to-and-f">Prepare <code>to</code> and <code>f</code></a></li>
  <li><a href="#how-attr-get-attr-by-name-or-else-getattr" id="toc-how-attr-get-attr-by-name-or-else-getattr" class="nav-link" data-scroll-target="#how-attr-get-attr-by-name-or-else-getattr">how-attr: get attr by name or else: <code>getattr</code></a></li>
  <li><a href="#how-code-assign-values-to-a-tuple-else-to_ffrom_f-to.__init__-if-isinstancetotype-else-tof" id="toc-how-code-assign-values-to-a-tuple-else-to_ffrom_f-to.__init__-if-isinstancetotype-else-tof" class="nav-link" data-scroll-target="#how-code-assign-values-to-a-tuple-else-to_ffrom_f-to.__init__-if-isinstancetotype-else-tof">how-code: assign values to a tuple <code>else: to_f,from_f = to.__init__ if isinstance(to,type) else to,f</code></a></li>
  <li><a href="#how-class-check-object-is-a-class-isinstanceto-type-true" id="toc-how-class-check-object-is-a-class-isinstanceto-type-true" class="nav-link" data-scroll-target="#how-class-check-object-is-a-class-isinstanceto-type-true">how-class: check object is a class <code>isinstance(to, type) == True</code></a></li>
  <li><a href="#make-sure-no-delegates-apply-to-f-without-kwargs" id="toc-make-sure-no-delegates-apply-to-f-without-kwargs" class="nav-link" data-scroll-target="#make-sure-no-delegates-apply-to-f-without-kwargs">Make sure no delegates apply to <code>f</code> without <code>**kwargs</code></a></li>
  <li><a href="#how-attr-whether-a-function-has-an-attr-or-not-hasattr" id="toc-how-attr-whether-a-function-has-an-attr-or-not-hasattr" class="nav-link" data-scroll-target="#how-attr-whether-a-function-has-an-attr-or-not-hasattr">How-attr: whether a function has an attr or not: <code>hasattr</code></a></li>
  <li><a href="#apply-fastcore.delegates-multiple-times-to-a-func-when-keeptrue" id="toc-apply-fastcore.delegates-multiple-times-to-a-func-when-keeptrue" class="nav-link" data-scroll-target="#apply-fastcore.delegates-multiple-times-to-a-func-when-keeptrue">apply <code>fastcore.delegates</code> multiple times to a func when <code>keep=True</code></a></li>
  <li><a href="#remove-kwargs-and-add-kwargs-with-default" id="toc-remove-kwargs-and-add-kwargs-with-default" class="nav-link" data-scroll-target="#remove-kwargs-and-add-kwargs-with-default">Remove <code>**kwargs</code> and add kwargs with default</a></li>
  <li><a href="#how-dict-pop-out-an-item-by-key-name-kwargs" id="toc-how-dict-pop-out-an-item-by-key-name-kwargs" class="nav-link" data-scroll-target="#how-dict-pop-out-an-item-by-key-name-kwargs">how-dict: pop out an item by key name <code>**kwargs</code></a></li>
  <li><a href="#how-try-except-when-f-has-no-kwargs-keyerror-occurs" id="toc-how-try-except-when-f-has-no-kwargs-keyerror-occurs" class="nav-link" data-scroll-target="#how-try-except-when-f-has-no-kwargs-keyerror-occurs">how-try-except: When <code>f</code> has no <code>**kwargs</code>, KeyError occurs</a></li>
  <li><a href="#get-default-kwargs-from-to" id="toc-get-default-kwargs-from-to" class="nav-link" data-scroll-target="#get-default-kwargs-from-to">get default kwargs from <code>to</code></a></li>
  <li><a href="#how-inspect.signature-replace-parameters-kind-to-parameter.keyword_only" id="toc-how-inspect.signature-replace-parameters-kind-to-parameter.keyword_only" class="nav-link" data-scroll-target="#how-inspect.signature-replace-parameters-kind-to-parameter.keyword_only">how-inspect.Signature: replace parameter’s kind to <code>Parameter.KEYWORD_ONLY</code></a></li>
  <li><a href="#how-inspect.parameter-empty-default-value-with-inspect.parameter.empty" id="toc-how-inspect.parameter-empty-default-value-with-inspect.parameter.empty" class="nav-link" data-scroll-target="#how-inspect.parameter-empty-default-value-with-inspect.parameter.empty">how-inspect.Parameter: empty default value with <code>inspect.Parameter.empty</code></a></li>
  <li><a href="#how-dict-update-add-additional-items-into-a-dict" id="toc-how-dict-update-add-additional-items-into-a-dict" class="nav-link" data-scroll-target="#how-dict-update-add-additional-items-into-a-dict">how-dict: update: add additional items into a dict</a></li>
  <li><a href="#if-keeptrue-then-add-kwargs-back-to-from_fs-signature" id="toc-if-keeptrue-then-add-kwargs-back-to-from_fs-signature" class="nav-link" data-scroll-target="#if-keeptrue-then-add-kwargs-back-to-from_fs-signature">If <code>keep=True</code>, then add <code>**kwargs</code> back to <code>from_f</code>’s signature</a></li>
  <li><a href="#if-keepfalse-do-from_f.setattr__delwrap__-to_f" id="toc-if-keepfalse-do-from_f.setattr__delwrap__-to_f" class="nav-link" data-scroll-target="#if-keepfalse-do-from_f.setattr__delwrap__-to_f">If <code>keep=False</code>, do <code>from_f.setattr("__delwrap__", to_f)</code></a></li>
  <li><a href="#how-attr-two-ways-of-setting-attr-setattr-or-from_f.__signature__-..." id="toc-how-attr-two-ways-of-setting-attr-setattr-or-from_f.__signature__-..." class="nav-link" data-scroll-target="#how-attr-two-ways-of-setting-attr-setattr-or-from_f.__signature__-...">how-attr: two ways of setting attr: <code>setattr</code> or <code>from_f.__signature__= ...</code></a></li>
  <li><a href="#how-attr-set-and-delete-an-attr" id="toc-how-attr-set-and-delete-an-attr" class="nav-link" data-scroll-target="#how-attr-set-and-delete-an-attr">how-attr: set and delete an attr</a></li>
  <li><a href="#replace-the-new-args-dict-with-the-old-args-in-the-signature-of-from_f" id="toc-replace-the-new-args-dict-with-the-old-args-in-the-signature-of-from_f" class="nav-link" data-scroll-target="#replace-the-new-args-dict-with-the-old-args-in-the-signature-of-from_f">Replace the new args dict with the old args in the signature of <code>from_f</code></a></li>
  <li><a href="#how-dict-get-all-items-key-and-value-of-a-dict" id="toc-how-dict-get-all-items-key-and-value-of-a-dict" class="nav-link" data-scroll-target="#how-dict-get-all-items-key-and-value-of-a-dict">how-dict: get all items (key and value) of a dict</a></li>
  <li><a href="#how-dict-get-only-values-of-a-dict" id="toc-how-dict-get-only-values-of-a-dict" class="nav-link" data-scroll-target="#how-dict-get-only-values-of-a-dict">how-dict: get only values of a dict</a></li>
  <li><a href="#how-inspect-getdoc-and-signature.replace" id="toc-how-inspect-getdoc-and-signature.replace" class="nav-link" data-scroll-target="#how-inspect-getdoc-and-signature.replace">how-inspect: getdoc and Signature.replace</a></li>
  </ul></li>
  <li><a href="#problem-delegates-what-may-go-wrong-when-keeptrue-and-func-low-has-no-kwargs" id="toc-problem-delegates-what-may-go-wrong-when-keeptrue-and-func-low-has-no-kwargs" class="nav-link" data-scroll-target="#problem-delegates-what-may-go-wrong-when-keeptrue-and-func-low-has-no-kwargs">problem-delegates: What may go wrong when <code>keep=True</code> and func <code>low</code> has no <code>**kwargs</code></a></li>
  <li><a href="#fastai-makes-no-mistake-like-this" id="toc-fastai-makes-no-mistake-like-this" class="nav-link" data-scroll-target="#fastai-makes-no-mistake-like-this">fastai makes no mistake like this</a></li>
  <li><a href="#tinker-delegates-warn-user-the-lowest-level-to-has-no-kwargs-dont-pass-expected-params" id="toc-tinker-delegates-warn-user-the-lowest-level-to-has-no-kwargs-dont-pass-expected-params" class="nav-link" data-scroll-target="#tinker-delegates-warn-user-the-lowest-level-to-has-no-kwargs-dont-pass-expected-params">tinker-delegates: warn user the lowest level <code>to</code> has no <code>**kwargs</code>, don’t pass expected params</a>
  <ul class="collapse">
  <li><a href="#how-try-except-replace-the-combination-of-if-else-hasattr" id="toc-how-try-except-replace-the-combination-of-if-else-hasattr" class="nav-link" data-scroll-target="#how-try-except-replace-the-combination-of-if-else-hasattr">how-try-except: replace the combination of <code>if else</code> + <code>hasattr</code></a></li>
  <li><a href="#how-attr-every-func-has-an-attr-__name__" id="toc-how-attr-every-func-has-an-attr-__name__" class="nav-link" data-scroll-target="#how-attr-every-func-has-an-attr-__name__">how-attr: every func has an attr <code>__name__</code></a></li>
  <li><a href="#delegates_v1" id="toc-delegates_v1" class="nav-link" data-scroll-target="#delegates_v1">delegates_v1</a></li>
  <li><a href="#examples-of-v_1" id="toc-examples-of-v_1" class="nav-link" data-scroll-target="#examples-of-v_1">examples of v_1</a></li>
  </ul></li>
  <li><a href="#problem-delegates-params-from-to-act-as-keyword_only-but-its-type-says-otherwirse" id="toc-problem-delegates-params-from-to-act-as-keyword_only-but-its-type-says-otherwirse" class="nav-link" data-scroll-target="#problem-delegates-params-from-to-act-as-keyword_only-but-its-type-says-otherwirse">problem-delegates: params from <code>to</code> act as KEYWORD_ONLY but its type says otherwirse</a>
  <ul class="collapse">
  <li><a href="#how-inspect-check-param-kind" id="toc-how-inspect-check-param-kind" class="nav-link" data-scroll-target="#how-inspect-check-param-kind">how-inspect: check param kind</a></li>
  </ul></li>
  <li><a href="#tinker-delegates-printing-a-warning-message-about-param-kind" id="toc-tinker-delegates-printing-a-warning-message-about-param-kind" class="nav-link" data-scroll-target="#tinker-delegates-printing-a-warning-message-about-param-kind">tinker-delegates: printing a warning message about param kind</a>
  <ul class="collapse">
  <li><a href="#delegates_v2" id="toc-delegates_v2" class="nav-link" data-scroll-target="#delegates_v2">delegates_v2</a></li>
  <li><a href="#delegates_v2-examples" id="toc-delegates_v2-examples" class="nav-link" data-scroll-target="#delegates_v2-examples">delegates_v2 examples</a></li>
  </ul></li>
  <li><a href="#tinker-delegates-change-parameter-type-to-parameter.keyword_only" id="toc-tinker-delegates-change-parameter-type-to-parameter.keyword_only" class="nav-link" data-scroll-target="#tinker-delegates-change-parameter-type-to-parameter.keyword_only">tinker-delegates: change parameter type to <code>Parameter.KEYWORD_ONLY</code></a>
  <ul class="collapse">
  <li><a href="#delegates_v3" id="toc-delegates_v3" class="nav-link" data-scroll-target="#delegates_v3">delegates_v3</a></li>
  </ul></li>
  <li><a href="#contribute-delegates-pr-accepted-on-august-11-2022" id="toc-contribute-delegates-pr-accepted-on-august-11-2022" class="nav-link" data-scroll-target="#contribute-delegates-pr-accepted-on-august-11-2022">contribute-delegates: <span>PR</span> accepted on August 11 2022</a></li>
  </ul></li>
  <li><a href="#mk_param" id="toc-mk_param" class="nav-link" data-scroll-target="#mk_param">_mk_param</a>
  <ul class="collapse">
  <li><a href="#how-import-what-does-from-fastcore.meta-import-mean" id="toc-how-import-what-does-from-fastcore.meta-import-mean" class="nav-link" data-scroll-target="#how-import-what-does-from-fastcore.meta-import-mean">how-import: What does <code>from fastcore.meta import *</code> mean</a></li>
  <li><a href="#mk_param-examples" id="toc-mk_param-examples" class="nav-link" data-scroll-target="#mk_param-examples"><code>_mk_param</code> examples</a></li>
  <li><a href="#mk_param-source" id="toc-mk_param-source" class="nav-link" data-scroll-target="#mk_param-source"><code>_mk_param</code> source</a></li>
  <li><a href="#mk_param-anatomy" id="toc-mk_param-anatomy" class="nav-link" data-scroll-target="#mk_param-anatomy"><code>_mk_param</code> anatomy</a>
  <ul class="collapse">
  <li><a href="#how-inspect-get-signature" id="toc-how-inspect-get-signature" class="nav-link" data-scroll-target="#how-inspect-get-signature">how-inspect: get signature</a></li>
  <li><a href="#how-inspect-getdoc" id="toc-how-inspect-getdoc" class="nav-link" data-scroll-target="#how-inspect-getdoc">how-inspect: getdoc</a></li>
  <li><a href="#how-inspect-create-parameter" id="toc-how-inspect-create-parameter" class="nav-link" data-scroll-target="#how-inspect-create-parameter">how-inspect: create Parameter</a></li>
  </ul></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  </ul></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#use_kwargs_dict" id="toc-use_kwargs_dict" class="nav-link" data-scroll-target="#use_kwargs_dict">use_kwargs_dict</a>
  <ul class="collapse">
  <li><a href="#use_kwargs_dic-source" id="toc-use_kwargs_dic-source" class="nav-link" data-scroll-target="#use_kwargs_dic-source"><code>use_kwargs_dic</code> source</a>
  <ul class="collapse">
  <li><a href="#how-code-put-for-in-and-if-else-in-a-single-line" id="toc-how-code-put-for-in-and-if-else-in-a-single-line" class="nav-link" data-scroll-target="#how-code-put-for-in-and-if-else-in-a-single-line">how-code: put <code>for in</code> and <code>if else</code> in a single line</a></li>
  <li><a href="#most-attributes-like-__signature__-__func__-are-added-by-decorators" id="toc-most-attributes-like-__signature__-__func__-are-added-by-decorators" class="nav-link" data-scroll-target="#most-attributes-like-__signature__-__func__-are-added-by-decorators">most attributes like <code>__signature__</code>, <code>__func__</code> are added by decorators</a></li>
  </ul></li>
  <li><a href="#use_kwargs_dict-examples" id="toc-use_kwargs_dict-examples" class="nav-link" data-scroll-target="#use_kwargs_dict-examples"><code>use_kwargs_dict</code> examples</a></li>
  </ul></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  <li><a href="#use_kwargs" id="toc-use_kwargs" class="nav-link" data-scroll-target="#use_kwargs">use_kwargs</a>
  <ul class="collapse">
  <li><a href="#use_kwargs-source" id="toc-use_kwargs-source" class="nav-link" data-scroll-target="#use_kwargs-source"><code>use_kwargs</code> source</a></li>
  <li><a href="#use_kwargs-examples" id="toc-use_kwargs-examples" class="nav-link" data-scroll-target="#use_kwargs-examples"><code>use_kwargs</code> examples</a></li>
  <li><a href="#how-code-how-args-in-signature-behave" id="toc-how-code-how-args-in-signature-behave" class="nav-link" data-scroll-target="#how-code-how-args-in-signature-behave">how-code: how <code>*args</code> in signature behave?</a></li>
  </ul></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a></li>
  <li><a href="#test_sig" id="toc-test_sig" class="nav-link" data-scroll-target="#test_sig">test_sig</a>
  <ul class="collapse">
  <li><a href="#test_sig-source" id="toc-test_sig-source" class="nav-link" data-scroll-target="#test_sig-source"><code>test_sig</code> source</a></li>
  <li><a href="#test_sig-examples" id="toc-test_sig-examples" class="nav-link" data-scroll-target="#test_sig-examples"><code>test_sig</code> examples</a></li>
  <li><a href="#test_sig-anatomy" id="toc-test_sig-anatomy" class="nav-link" data-scroll-target="#test_sig-anatomy"><code>test_sig</code> anatomy</a>
  <ul class="collapse">
  <li><a href="#how-str-turn-signature-into-string" id="toc-how-str-turn-signature-into-string" class="nav-link" data-scroll-target="#how-str-turn-signature-into-string">how-str: turn signature into string</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"></a></li>
  <li><a href="#rm_self" id="toc-rm_self" class="nav-link" data-scroll-target="#rm_self"><code>_rm_self</code></a>
  <ul class="collapse">
  <li><a href="#rm_self-source" id="toc-rm_self-source" class="nav-link" data-scroll-target="#rm_self-source"><code>_rm_self</code> source</a></li>
  <li><a href="#rm_self-examples" id="toc-rm_self-examples" class="nav-link" data-scroll-target="#rm_self-examples"><code>_rm_self</code> examples</a></li>
  <li><a href="#rm_self-anatomy" id="toc-rm_self-anatomy" class="nav-link" data-scroll-target="#rm_self-anatomy"><code>_rm_self</code> anatomy</a></li>
  </ul></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5"></a></li>
  <li><a href="#fixsigmeta" id="toc-fixsigmeta" class="nav-link" data-scroll-target="#fixsigmeta">FixSigMeta</a>
  <ul class="collapse">
  <li><a href="#fixsigmeta-examples" id="toc-fixsigmeta-examples" class="nav-link" data-scroll-target="#fixsigmeta-examples"><span><code>FixSigMeta</code></span> examples</a>
  <ul class="collapse">
  <li><a href="#examples-not-really-working-effectively" id="toc-examples-not-really-working-effectively" class="nav-link" data-scroll-target="#examples-not-really-working-effectively">examples not really working effectively</a></li>
  <li><a href="#how-fixsigmeta-when-inherit-a-class-override-__new__" id="toc-how-fixsigmeta-when-inherit-a-class-override-__new__" class="nav-link" data-scroll-target="#how-fixsigmeta-when-inherit-a-class-override-__new__">how-FixSigMeta: when inherit a class override <code>__new__</code></a></li>
  </ul></li>
  <li><a href="#fixsigmeta-1" id="toc-fixsigmeta-1" class="nav-link" data-scroll-target="#fixsigmeta-1">FixSigMeta</a>
  <ul class="collapse">
  <li><a href="#how-fixsigmeta-when-inherit-a-metaclass-to-override-__call__" id="toc-how-fixsigmeta-when-inherit-a-metaclass-to-override-__call__" class="nav-link" data-scroll-target="#how-fixsigmeta-when-inherit-a-metaclass-to-override-__call__">how-FixSigMeta: when inherit a metaclass to override <code>__call__</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6"></a></li>
  <li><a href="#prepostinitmeta" id="toc-prepostinitmeta" class="nav-link" data-scroll-target="#prepostinitmeta">PrePostInitMeta</a>
  <ul class="collapse">
  <li><a href="#relations-between-prepostinitmeta-and-fixsigmeta" id="toc-relations-between-prepostinitmeta-and-fixsigmeta" class="nav-link" data-scroll-target="#relations-between-prepostinitmeta-and-fixsigmeta">Relations between PrePostInitMeta and FixSigMeta</a></li>
  <li><a href="#prepostinitmeta-1" id="toc-prepostinitmeta-1" class="nav-link" data-scroll-target="#prepostinitmeta-1">PrePostInitMeta</a></li>
  <li><a href="#prepostinitmeta-examples" id="toc-prepostinitmeta-examples" class="nav-link" data-scroll-target="#prepostinitmeta-examples"><span><code>PrePostInitMeta</code></span> examples</a></li>
  </ul></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7"></a></li>
  <li><a href="#autoinit" id="toc-autoinit" class="nav-link" data-scroll-target="#autoinit"><span><code>AutoInit</code></span></a>
  <ul class="collapse">
  <li><a href="#autoinit-source" id="toc-autoinit-source" class="nav-link" data-scroll-target="#autoinit-source"><span><code>AutoInit</code></span> source</a></li>
  <li><a href="#autoinit-1" id="toc-autoinit-1" class="nav-link" data-scroll-target="#autoinit-1">AutoInit</a></li>
  <li><a href="#autoinit-examples" id="toc-autoinit-examples" class="nav-link" data-scroll-target="#autoinit-examples"><span><code>AutoInit</code></span> examples</a></li>
  </ul></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8"></a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9"></a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/EmbraceLife/debuggable/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="fastcore_meta" class="level1">
<h1>fastcore_meta</h1>
<section id="delegates" class="level2">
<h2 class="anchored" data-anchor-id="delegates">Delegates</h2>
<section id="import-libraries" class="level3">
<h3 class="anchored" data-anchor-id="import-libraries">Import libraries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nbdev.showdoc <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> IFrame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reading-the-doc" class="level3">
<h3 class="anchored" data-anchor-id="reading-the-doc">Reading the doc</h3>
<section id="how-sig-access-signature-quick-doc-and-full-doc" class="level4">
<h4 class="anchored" data-anchor-id="how-sig-access-signature-quick-doc-and-full-doc">how-sig: access signature, quick doc and full doc</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Signature (to: function = None, keep=False, but: list = None, verbose=True)&gt;
'Decorator: replace `**kwargs` in signature with params from `to`'</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-display">

        <iframe width="1200" height="500" src="https://fastcore.fast.ai/meta.html#delegates" frameborder="0" allowfullscreen=""></iframe>
        
</div>
</div>
</section>
<section id="how-assert-use-assert" class="level4">
<h4 class="anchored" data-anchor-id="how-assert-use-assert">how-assert: use <code>assert</code></h4>
<p>more <a href="https://realpython.com/python-testing/">examples</a></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> foo(c<span class="op">=</span><span class="dv">1</span>, a<span class="op">=</span><span class="dv">1</span>) <span class="op">==</span> <span class="dv">7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="how-delegates-which-params-passed-to-f-from-to-in-source" class="level4">
<h4 class="anchored" data-anchor-id="how-delegates-which-params-passed-to-f-from-to-in-source">how-delegates: Which params passed to <code>f</code> from <code>to</code> in source?</h4>
<ul>
<li>only keyword params (with default values) are delegated to <code>foo</code> from <code>baz</code></li>
<li>params (both positional and keyword) from <code>foo</code> suffice to fill positional params of <code>baz</code></li>
</ul>
</section>
<section id="how-deletates-when-params-in-f-conflict-with-kwargs-of-to" class="level4">
<h4 class="anchored" data-anchor-id="how-deletates-when-params-in-f-conflict-with-kwargs-of-to">how-deletates: when params in <code>f</code> conflict with kwargs of <code>to</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> baz(a, b<span class="op">=</span><span class="dv">2</span>, c<span class="op">=</span><span class="dv">3</span>): <span class="cf">return</span> a <span class="op">+</span> b <span class="op">+</span> c</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(baz)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo1(d, a, <span class="op">**</span>kwargs): <span class="co"># both b=2, c=3 are kept</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d <span class="op">+</span> baz(a, <span class="op">**</span>kwargs)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(baz)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo2(c, a, <span class="op">**</span>kwargs): <span class="co"># c in foo2 replaces c=3 in baz, only b=2 is kept</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c <span class="op">+</span> baz(a, <span class="op">**</span>kwargs)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>inspect.signature(foo1), inspect.signature(foo2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(&lt;Signature (d, a, *, b=2, c=3)&gt;, &lt;Signature (c, a, *, b=2)&gt;)</code></pre>
</div>
</div>
</section>
<section id="how-sig-test_sig" class="level4">
<h4 class="anchored" data-anchor-id="how-sig-test_sig">how-sig: <code>test_sig</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>test_sig(foo2, <span class="st">'(c, a, *, b=2)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="how-delegates-on-classmethod-and-instant-method" class="level4">
<h4 class="anchored" data-anchor-id="how-delegates-on-classmethod-and-instant-method">how-delegates: on classmethod and instant method</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> _T():</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> foo(cls, a<span class="op">=</span><span class="dv">1</span>, b<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">@classmethod</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">@delegates</span>(foo)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> bar(cls, c<span class="op">=</span><span class="dv">3</span>, <span class="op">**</span>kwargs):</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> _T()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>inspect.signature(t.bar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (c=3, *, a=1, b=2)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> _T():</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> foo(cls, a<span class="op">=</span><span class="dv">1</span>, b<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">@delegates</span>(foo)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> bar(cls, c<span class="op">=</span><span class="dv">3</span>, <span class="op">**</span>kwargs):</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> _T()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>inspect.signature(t.bar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (c=3, *, a=1, b=2)&gt;</code></pre>
</div>
</div>
</section>
<section id="how-delegates-on-super-class-or-__init__-func-in-fact" class="level4">
<h4 class="anchored" data-anchor-id="how-delegates-on-super-class-or-__init__-func-in-fact">how-delegates: on super class or <code>__init__</code> func in fact</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BaseFoo:</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, e, c<span class="op">=</span><span class="dv">2</span>): <span class="cf">pass</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Foo(BaseFoo):</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a, b<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="bu">super</span>().<span class="fu">__init__</span>(<span class="op">**</span>kwargs)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>test_sig(Foo, <span class="st">'(a, b=1, **kwargs)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BaseFoo:</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, e, c<span class="op">=</span><span class="dv">2</span>): <span class="cf">pass</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>()<span class="co"># since no argument was passsed here we delegate to the superclass</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Foo(BaseFoo):</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a, b<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="bu">super</span>().<span class="fu">__init__</span>(<span class="op">**</span>kwargs)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>test_sig(Foo, <span class="st">'(a, b=1, *, c=2)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="how-delegates-on-other-class" class="level4">
<h4 class="anchored" data-anchor-id="how-delegates-on-other-class">how-delegates: on other class</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BaseFoo:</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, e, c<span class="op">=</span><span class="dv">2</span>): pprint(<span class="bu">locals</span>())</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> OtherFoo:</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, d, f<span class="op">=</span><span class="dv">1</span>): pprint(<span class="bu">locals</span>())</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(OtherFoo)<span class="co"># since no argument was passsed here we delegate to the superclass</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Foo(BaseFoo):</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a, b<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        pprint(<span class="bu">locals</span>())</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(<span class="op">**</span>kwargs)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect.signature(Foo)</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>test_sig(Foo, <span class="st">'(a, b=1, *, f=1)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:        </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> Foo(<span class="dv">1</span>,<span class="dv">1</span>,f<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">TypeError</span> <span class="im">as</span> e:</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'__class__': &lt;class '__main__.Foo'&gt;,
 'a': 1,
 'b': 1,
 'kwargs': {'f': 1},
 'self': &lt;__main__.Foo object&gt;}
__init__() got an unexpected keyword argument 'f'</code></pre>
</div>
</div>
</section>
<section id="how-delegates-before-its-time" class="level4">
<h4 class="anchored" data-anchor-id="how-delegates-before-its-time">how-delegates: before its time</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a:<span class="bu">int</span>, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c:<span class="bu">int</span>, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): low(c, <span class="op">**</span>kwargs) <span class="op">+</span> d</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> high(e:<span class="bu">int</span>, f:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): mid(e, <span class="op">**</span>kwargs) <span class="op">+</span> f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"low: "</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(low))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"mid: "</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(mid))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"high: "</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(high))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>low: 
&lt;Signature (a: int, b: int = 1)&gt;
mid: 
&lt;Signature (c: int, d: int = 1, **kwargs)&gt;
high: 
&lt;Signature (e: int, f: int = 1, **kwargs)&gt;</code></pre>
</div>
</div>
</section>
<section id="how-delegates-under-its-reign" class="level4">
<h4 class="anchored" data-anchor-id="how-delegates-under-its-reign">how-delegates: under its reign</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a:<span class="bu">int</span>, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(low)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c:<span class="bu">int</span>, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): low(c, <span class="op">**</span>kwargs) <span class="op">+</span> d</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(mid)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> high(e:<span class="bu">int</span>, f:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): mid(e, <span class="op">**</span>kwargs) <span class="op">+</span> f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"low: "</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(low))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"mid: "</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(mid))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"high: "</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(high))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>low: 
&lt;Signature (a: int, b: int = 1)&gt;
mid: 
&lt;Signature (c: int, d: int = 1, *, b: int = 1)&gt;
high: 
&lt;Signature (e: int, f: int = 1, *, d: int = 1, b: int = 1)&gt;</code></pre>
</div>
</div>
</section>
<section id="how-show_doc-show_doc-can-even-informs-you-which-kwargs-are-passed-to-other-funcs" class="level4">
<h4 class="anchored" data-anchor-id="how-show_doc-show_doc-can-even-informs-you-which-kwargs-are-passed-to-other-funcs">how-show_doc: <code>show_doc</code> can even informs you which kwargs are passed to other funcs</h4>
</section>
<section id="how-delegates-use-keeptrue-and-but" class="level4">
<h4 class="anchored" data-anchor-id="how-delegates-use-keeptrue-and-but">how-delegates: use <code>keep=True</code> and <code>but</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(mid, keep<span class="op">=</span><span class="va">True</span>, but<span class="op">=</span>[<span class="st">'b'</span>])</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> high(e:<span class="bu">int</span>, f:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): mid(e, <span class="op">**</span>kwargs) <span class="op">+</span> f</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(high))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Signature (e: int, f: int = 1, *, d: int = 1, **kwargs)&gt;</code></pre>
</div>
</div>
</section>
<section id="how-delegates-without" class="level4">
<h4 class="anchored" data-anchor-id="how-delegates-without">how-delegates: without <code>@</code></h4>
<p>Using <code>delegates??</code> to get its source code</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> delegates(to<span class="op">=</span><span class="va">None</span>, keep<span class="op">=</span><span class="va">False</span>, but<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Decorator: replace `**kwargs` in signature with params from `to`"</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> but <span class="kw">is</span> <span class="va">None</span>: but <span class="op">=</span> []</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _f(f):</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> to <span class="kw">is</span> <span class="va">None</span>: to_f,from_f <span class="op">=</span> f.__base__.<span class="fu">__init__</span>,f.<span class="fu">__init__</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:          to_f,from_f <span class="op">=</span> to.<span class="fu">__init__</span> <span class="cf">if</span> <span class="bu">isinstance</span>(to,<span class="bu">type</span>) <span class="cf">else</span> to,f</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        from_f <span class="op">=</span> <span class="bu">getattr</span>(from_f,<span class="st">'__func__'</span>,from_f)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        to_f <span class="op">=</span> <span class="bu">getattr</span>(to_f,<span class="st">'__func__'</span>,to_f)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(from_f,<span class="st">'__delwrap__'</span>): <span class="cf">return</span> f</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        sig <span class="op">=</span> inspect.signature(from_f)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        sigd <span class="op">=</span> <span class="bu">dict</span>(sig.parameters)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        k <span class="op">=</span> sigd.pop(<span class="st">'kwargs'</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        s2 <span class="op">=</span> {k:v <span class="cf">for</span> k,v <span class="kw">in</span> inspect.signature(to_f).parameters.items()</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> v.default <span class="op">!=</span> inspect.Parameter.empty <span class="kw">and</span> k <span class="kw">not</span> <span class="kw">in</span> sigd <span class="kw">and</span> k <span class="kw">not</span> <span class="kw">in</span> but}</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        sigd.update(s2)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> keep: sigd[<span class="st">'kwargs'</span>] <span class="op">=</span> k</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: from_f.__delwrap__ <span class="op">=</span> to_f</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        from_f.__signature__ <span class="op">=</span> sig.replace(parameters<span class="op">=</span>sigd.values())</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> f</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a:<span class="bu">int</span>, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">return</span> a <span class="op">+</span> b</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c:<span class="bu">int</span>, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">return</span> low(c, <span class="op">**</span>kwargs) <span class="op">+</span> d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mid(<span class="dv">1</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>inspect.signature(mid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (c: int, d: int = 1, **kwargs)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>_f <span class="op">=</span> delegates(low)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mid <span class="op">=</span> _f(mid)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mid(<span class="dv">1</span>))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>inspect.signature(mid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (c: int, d: int = 1, *, b: int = 1)&gt;</code></pre>
</div>
</div>
<p><code>@delegates(low)</code> is equivalent to the first two lines in cell above</p>
</section>
</section>
<section id="the-anatomy-of-delegates" class="level3">
<h3 class="anchored" data-anchor-id="the-anatomy-of-delegates">The anatomy of <code>delegates</code></h3>
<section id="examples" class="level4">
<h4 class="anchored" data-anchor-id="examples">Examples</h4>
<p>Function example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a:<span class="bu">int</span>, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">return</span> a <span class="op">+</span> b</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c:<span class="bu">int</span>, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">return</span> low(c, <span class="op">**</span>kwargs) <span class="op">+</span> d</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> high(e:<span class="bu">int</span>, f:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">return</span> mid(e, <span class="op">**</span>kwargs) <span class="op">+</span> f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Class example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BaseFoo:</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, e, c<span class="op">=</span><span class="dv">2</span>): <span class="cf">pass</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> OtherFoo:</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, d, f<span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Foo(BaseFoo):</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a, b<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="bu">super</span>().<span class="fu">__init__</span>(<span class="op">**</span>kwargs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> delegates(to<span class="op">=</span><span class="va">None</span>, keep<span class="op">=</span><span class="va">False</span>, but<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Decorator: replace `**kwargs` in signature with params from `to`"</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> but <span class="kw">is</span> <span class="va">None</span>: but <span class="op">=</span> []</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _f(f):</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> to <span class="kw">is</span> <span class="va">None</span>: to_f,from_f <span class="op">=</span> f.__base__.<span class="fu">__init__</span>,f.<span class="fu">__init__</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:          to_f,from_f <span class="op">=</span> to.<span class="fu">__init__</span> <span class="cf">if</span> <span class="bu">isinstance</span>(to,<span class="bu">type</span>) <span class="cf">else</span> to,f</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        from_f <span class="op">=</span> <span class="bu">getattr</span>(from_f,<span class="st">'__func__'</span>,from_f)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        to_f <span class="op">=</span> <span class="bu">getattr</span>(to_f,<span class="st">'__func__'</span>,to_f)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(from_f,<span class="st">'__delwrap__'</span>): <span class="cf">return</span> f</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        sig <span class="op">=</span> inspect.signature(from_f)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        sigd <span class="op">=</span> <span class="bu">dict</span>(sig.parameters)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        k <span class="op">=</span> sigd.pop(<span class="st">'kwargs'</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        s2 <span class="op">=</span> {k:v <span class="cf">for</span> k,v <span class="kw">in</span> inspect.signature(to_f).parameters.items()</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> v.default <span class="op">!=</span> inspect.Parameter.empty <span class="kw">and</span> k <span class="kw">not</span> <span class="kw">in</span> sigd <span class="kw">and</span> k <span class="kw">not</span> <span class="kw">in</span> but}</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        sigd.update(s2)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> keep: sigd[<span class="st">'kwargs'</span>] <span class="op">=</span> k</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: from_f.__delwrap__ <span class="op">=</span> to_f</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>        from_f.__signature__ <span class="op">=</span> sig.replace(parameters<span class="op">=</span>sigd.values())</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> f</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="params-and-inputs" class="level4">
<h4 class="anchored" data-anchor-id="params-and-inputs">Params and inputs</h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> delegates(to<span class="op">=</span><span class="va">None</span>, keep<span class="op">=</span><span class="va">False</span>, but<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Decorator: replace `**kwargs` in signature with params from `to`"</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> but <span class="kw">is</span> <span class="va">None</span>: but <span class="op">=</span> []</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># def delegates(to=None, keep=False, but=None):</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     "Decorator: replace `**kwargs` in signature with params from `to`"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>to<span class="op">=</span>mid     <span class="co"># `to` is the func to delegate its kwargs with default values to `f` func</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>keep<span class="op">=</span><span class="va">False</span> <span class="co"># whether to keep `**kwargs` inside `f` signature or not</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>but<span class="op">=</span><span class="va">None</span>   <span class="co"># which default kwargs to remove from `f` signature</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> but <span class="kw">is</span> <span class="va">None</span>: but <span class="op">=</span> [] <span class="co"># if not None, but should be a list type</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prepare-to-and-f" class="level4">
<h4 class="anchored" data-anchor-id="prepare-to-and-f">Prepare <code>to</code> and <code>f</code></h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _f(f):</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> to <span class="kw">is</span> <span class="va">None</span>: to_f,from_f <span class="op">=</span> f.__base__.<span class="fu">__init__</span>,f.<span class="fu">__init__</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:          to_f,from_f <span class="op">=</span> to.<span class="fu">__init__</span> <span class="cf">if</span> <span class="bu">isinstance</span>(to,<span class="bu">type</span>) <span class="cf">else</span> to,f</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        from_f <span class="op">=</span> <span class="bu">getattr</span>(from_f,<span class="st">'__func__'</span>,from_f)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        to_f <span class="op">=</span> <span class="bu">getattr</span>(to_f,<span class="st">'__func__'</span>,to_f)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        ....</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>What can <code>to</code> and <code>f</code> be? - function - class method, instant method - class - type?</p>
<p>When dealing with class and superclass</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>to <span class="op">=</span> <span class="va">None</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> Foo</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> to <span class="kw">is</span> <span class="va">None</span>: to_f,from_f <span class="op">=</span> f.__base__.<span class="fu">__init__</span>,f.<span class="fu">__init__</span> <span class="co"># use delegates on class</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>to_f, from_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(&lt;function __main__.BaseFoo.__init__(self, e, c=2)&gt;,
 &lt;function __main__.Foo.__init__(self, a, b=1, **kwargs)&gt;)</code></pre>
</div>
</div>
</section>
<section id="how-attr-get-attr-by-name-or-else-getattr" class="level4">
<h4 class="anchored" data-anchor-id="how-attr-get-attr-by-name-or-else-getattr">how-attr: get attr by name or else: <code>getattr</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>from_f <span class="op">=</span> <span class="bu">getattr</span>(from_f,<span class="st">'__func__'</span>,from_f)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>to_f <span class="op">=</span> <span class="bu">getattr</span>(to_f,<span class="st">'__func__'</span>,to_f)<span class="op">;</span> to_f, from_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(&lt;function __main__.BaseFoo.__init__(self, e, c=2)&gt;,
 &lt;function __main__.Foo.__init__(self, a, b=1, **kwargs)&gt;)</code></pre>
</div>
</div>
</section>
<section id="how-code-assign-values-to-a-tuple-else-to_ffrom_f-to.__init__-if-isinstancetotype-else-tof" class="level4">
<h4 class="anchored" data-anchor-id="how-code-assign-values-to-a-tuple-else-to_ffrom_f-to.__init__-if-isinstancetotype-else-tof">how-code: assign values to a tuple <code>else: to_f,from_f = to.__init__ if isinstance(to,type) else to,f</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>to <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="dv">34</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">True</span>: to_f,from_f <span class="op">=</span> <span class="dv">3</span> <span class="cf">if</span> to <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> to,f </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(to_f, from_f, f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3 34 34</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>to <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="dv">34</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">True</span>: </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to <span class="op">==</span> <span class="dv">1</span>: </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>        to_f <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>        from_f <span class="op">=</span> f</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>        to_f <span class="op">=</span> to</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>        from_f <span class="op">=</span> f</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(to_f, from_f, f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3 34 34</code></pre>
</div>
</div>
</section>
<section id="how-class-check-object-is-a-class-isinstanceto-type-true" class="level4">
<h4 class="anchored" data-anchor-id="how-class-check-object-is-a-class-isinstanceto-type-true">how-class: check object is a class <code>isinstance(to, type) == True</code></h4>
<p>how-type: learn more of <a href="https://hyp.is/nean3hlREe2QFO-_fpoP7g/stackoverflow.com/questions/100003/what-are-metaclasses-in-python">type</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>to <span class="op">=</span> OtherFoo</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> Foo</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">isinstance</span>(to,<span class="bu">type</span>))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># if isinstance(to,type): to_f,from_f = to.__init__ </span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> to <span class="kw">is</span> <span class="va">None</span>: to_f,from_f <span class="op">=</span> f.__base__.<span class="fu">__init__</span>,f.<span class="fu">__init__</span> <span class="co"># use delegates on class</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:          to_f,from_f <span class="op">=</span> to.<span class="fu">__init__</span> <span class="cf">if</span> <span class="bu">isinstance</span>(to,<span class="bu">type</span>) <span class="cf">else</span> to,f </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>to_f, from_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>(&lt;function __main__.OtherFoo.__init__(self, d, f=1)&gt;, __main__.Foo)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>from_f <span class="op">=</span> <span class="bu">getattr</span>(from_f,<span class="st">'__func__'</span>,from_f)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>to_f <span class="op">=</span> <span class="bu">getattr</span>(to_f,<span class="st">'__func__'</span>,to_f)<span class="op">;</span>  to_f, from_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(&lt;function __main__.OtherFoo.__init__(self, d, f=1)&gt;, __main__.Foo)</code></pre>
</div>
</div>
<p>Working with function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># def _f(f):</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>to <span class="op">=</span> low</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> mid</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> to <span class="kw">is</span> <span class="va">None</span>: to_f,from_f <span class="op">=</span> f.__base__.<span class="fu">__init__</span>,f.<span class="fu">__init__</span> <span class="co"># use delegates on class</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:          to_f,from_f <span class="op">=</span> to.<span class="fu">__init__</span> <span class="cf">if</span> <span class="bu">isinstance</span>(to,<span class="bu">type</span>) <span class="cf">else</span> to,f </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="co"># secret use of delegates on type</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                                         <span class="co"># finally delegates on functions</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>to_f, from_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(&lt;function __main__.low(a: int, b: int = 1)&gt;,
 &lt;function __main__.mid(c: int, d: int = 1, **kwargs)&gt;)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>from_f <span class="op">=</span> <span class="bu">getattr</span>(from_f,<span class="st">'__func__'</span>,from_f)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>to_f <span class="op">=</span> <span class="bu">getattr</span>(to_f,<span class="st">'__func__'</span>,to_f)<span class="op">;</span>  to_f, from_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(&lt;function __main__.low(a: int, b: int = 1)&gt;,
 &lt;function __main__.mid(c: int, d: int = 1, **kwargs)&gt;)</code></pre>
</div>
</div>
</section>
<section id="make-sure-no-delegates-apply-to-f-without-kwargs" class="level4">
<h4 class="anchored" data-anchor-id="make-sure-no-delegates-apply-to-f-without-kwargs">Make sure no delegates apply to <code>f</code> without <code>**kwargs</code></h4>
<p>see when <code>__delwrap__</code> attr is set below.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">hasattr</span>(from_f,<span class="st">'__delwrap__'</span>): <span class="cf">return</span> f <span class="co"># don't do it more than once</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="how-attr-whether-a-function-has-an-attr-or-not-hasattr" class="level4">
<h4 class="anchored" data-anchor-id="how-attr-whether-a-function-has-an-attr-or-not-hasattr">How-attr: whether a function has an attr or not: <code>hasattr</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="bu">hasattr</span>(from_f,<span class="st">'__delwrap__'</span>) <span class="op">==</span> <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(from_f))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="bu">hasattr</span>(from_f,<span class="st">'__signature__'</span>) <span class="op">==</span> <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Signature (c: int, d: int = 1, **kwargs)&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
<p>Function Example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(low)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>inspect.signature(mid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (c, d: int = 1, *, b: int = 1)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>mid.__delwrap__, <span class="bu">hasattr</span>(mid, <span class="st">'__delwrap__'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(&lt;function __main__.low(a, b: int = 1)&gt;, True)</code></pre>
</div>
</div>
<p>Class Example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BaseFoo:</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, e, c<span class="op">=</span><span class="dv">2</span>): <span class="cf">pass</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>()<span class="co"># since no argument was passsed here we delegate to the superclass</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Foo(BaseFoo):</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a, b<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="bu">super</span>().<span class="fu">__init__</span>(<span class="op">**</span>kwargs)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>inspect.signature(Foo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (a, b=1, *, c=2)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>Foo.<span class="fu">__init__</span>.__delwrap__, <span class="bu">hasattr</span>(Foo.<span class="fu">__init__</span>, <span class="st">'__delwrap__'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(&lt;function __main__.BaseFoo.__init__(self, e, c=2)&gt;, True)</code></pre>
</div>
</div>
</section>
<section id="apply-fastcore.delegates-multiple-times-to-a-func-when-keeptrue" class="level4">
<h4 class="anchored" data-anchor-id="apply-fastcore.delegates-multiple-times-to-a-func-when-keeptrue">apply <code>fastcore.delegates</code> multiple times to a func when <code>keep=True</code></h4>
<p>You could do it with no <code>@</code>, but no useful usecases for it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>inspect.signature(mid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (c, d: int = 1, **kwargs)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>mid1 <span class="op">=</span> delegates(low, keep<span class="op">=</span><span class="va">True</span>)(mid)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>test_sig(mid, <span class="st">'(c, d: int = 1, *, b: int = 1, **kwargs)'</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low1(a1, b1:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>mid2 <span class="op">=</span> delegates(low1, keep<span class="op">=</span><span class="va">True</span>)(mid)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>test_sig(mid, <span class="st">'(c, d: int = 1, *, b: int = 1, b1: int = 1, **kwargs)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remove-kwargs-and-add-kwargs-with-default" class="level4">
<h4 class="anchored" data-anchor-id="remove-kwargs-and-add-kwargs-with-default">Remove <code>**kwargs</code> and add kwargs with default</h4>
<div class="sourceCode" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _f(f):</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>        ...</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>        sig <span class="op">=</span> inspect.signature(from_f)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>        sigd <span class="op">=</span> <span class="bu">dict</span>(sig.parameters)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>        k <span class="op">=</span> sigd.pop(<span class="st">'kwargs'</span>)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>        s2 <span class="op">=</span> {k:v <span class="cf">for</span> k,v <span class="kw">in</span> inspect.signature(to_f).parameters.items()</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> v.default <span class="op">!=</span> inspect.Parameter.empty <span class="kw">and</span> k <span class="kw">not</span> <span class="kw">in</span> sigd <span class="kw">and</span> k <span class="kw">not</span> <span class="kw">in</span> but}</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>        sigd.update(s2)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>        ...</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> f</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="how-dict-pop-out-an-item-by-key-name-kwargs" class="level4">
<h4 class="anchored" data-anchor-id="how-dict-pop-out-an-item-by-key-name-kwargs">how-dict: pop out an item by key name <code>**kwargs</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>sig <span class="op">=</span> inspect.signature(from_f) <span class="co"># get signature</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sig, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>sigd <span class="op">=</span> <span class="bu">dict</span>(sig.parameters) <span class="co"># turn signature into a dict</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>pprint(sigd)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> sigd.pop(<span class="st">'kwargs'</span>) <span class="co"># take **kwargs parameter out of the dict and keep it</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>pprint(k) <span class="co"># **kwargs parameter</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>pprint(sig) <span class="co"># unchanged</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>pprint(sigd) <span class="co"># changed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(c: int, d: int = 1, **kwargs) 

{'c': &lt;Parameter "c: int"&gt;,
 'd': &lt;Parameter "d: int = 1"&gt;,
 'kwargs': &lt;Parameter "**kwargs"&gt;}

&lt;Parameter "**kwargs"&gt;
&lt;Signature (c: int, d: int = 1, **kwargs)&gt;
{'c': &lt;Parameter "c: int"&gt;, 'd': &lt;Parameter "d: int = 1"&gt;}</code></pre>
</div>
</div>
</section>
<section id="how-try-except-when-f-has-no-kwargs-keyerror-occurs" class="level4">
<h4 class="anchored" data-anchor-id="how-try-except-when-f-has-no-kwargs-keyerror-occurs">how-try-except: When <code>f</code> has no <code>**kwargs</code>, KeyError occurs</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">@delegates</span>(low)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> mid(c, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">KeyError</span> <span class="im">as</span> e:</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"when mid has no **kwargs parameter in its signature, fastcore.delegates will throw an KeyError: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>when mid has no **kwargs parameter in its signature, fastcore.delegates will throw an KeyError: 'kwargs'</code></pre>
</div>
</div>
</section>
<section id="get-default-kwargs-from-to" class="level4">
<h4 class="anchored" data-anchor-id="get-default-kwargs-from-to">get default kwargs from <code>to</code></h4>
<p>Those kwargs must meet 3 conditions - have default values or <code>!= inspect.Parameter.empty</code> - not conflict with parameters in <code>f</code> - not in the list of <code>but</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, c:<span class="bu">int</span><span class="op">=</span><span class="dv">2</span>, e:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>to_f <span class="op">=</span> low</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>sig <span class="op">=</span> inspect.signature(mid)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>pprint(sig.parameters)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>sigd <span class="op">=</span> <span class="bu">dict</span>(sig.parameters) <span class="co"># Note: sig.parameters</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> sigd.pop(<span class="st">"kwargs"</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>but <span class="op">=</span> [<span class="st">'b'</span>]</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> {k:v <span class="cf">for</span> k,v <span class="kw">in</span> inspect.signature(to_f).parameters.items()</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> v.default <span class="op">!=</span> inspect.Parameter.empty <span class="kw">and</span> k <span class="kw">not</span> <span class="kw">in</span> sigd <span class="kw">and</span> k <span class="kw">not</span> <span class="kw">in</span> but}<span class="op">;</span> </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>s2 <span class="co"># is empty dict because c is part of `mid` too, b is in the `but` list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mappingproxy(OrderedDict([('c', &lt;Parameter "c"&gt;),
                          ('d', &lt;Parameter "d: int = 1"&gt;),
                          ('kwargs', &lt;Parameter "**kwargs"&gt;)]))</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>{'e': &lt;Parameter "e: int = 1"&gt;}</code></pre>
</div>
</div>
</section>
<section id="how-inspect.signature-replace-parameters-kind-to-parameter.keyword_only" class="level4">
<h4 class="anchored" data-anchor-id="how-inspect.signature-replace-parameters-kind-to-parameter.keyword_only">how-inspect.Signature: replace parameter’s kind to <code>Parameter.KEYWORD_ONLY</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> {name: param.replace(kind<span class="op">=</span>inspect.Parameter.KEYWORD_ONLY) <span class="cf">for</span> name, param <span class="kw">in</span> s2.items()} </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>s2[<span class="st">'e'</span>].kind</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;_ParameterKind.KEYWORD_ONLY: 3&gt;</code></pre>
</div>
</div>
</section>
<section id="how-inspect.parameter-empty-default-value-with-inspect.parameter.empty" class="level4">
<h4 class="anchored" data-anchor-id="how-inspect.parameter-empty-default-value-with-inspect.parameter.empty">how-inspect.Parameter: empty default value with <code>inspect.Parameter.empty</code></h4>
<div class="sourceCode" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> v.default <span class="op">!=</span> inspect.Parameter.empty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="how-dict-update-add-additional-items-into-a-dict" class="level4">
<h4 class="anchored" data-anchor-id="how-dict-update-add-additional-items-into-a-dict">how-dict: update: add additional items into a dict</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>sigd.update(s2)<span class="op">;</span> sigd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'c': &lt;Parameter "c"&gt;,
 'd': &lt;Parameter "d: int = 1"&gt;,
 'e': &lt;Parameter "e: int = 1"&gt;}</code></pre>
</div>
</div>
</section>
<section id="if-keeptrue-then-add-kwargs-back-to-from_fs-signature" class="level4">
<h4 class="anchored" data-anchor-id="if-keeptrue-then-add-kwargs-back-to-from_fs-signature">If <code>keep=True</code>, then add <code>**kwargs</code> back to <code>from_f</code>’s signature</h4>
<div class="sourceCode" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _f(f):</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>        ...</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> keep: sigd[<span class="st">'kwargs'</span>] <span class="op">=</span> k</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: from_f.__delwrap__ <span class="op">=</span> to_f</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>        from_f.__signature__ <span class="op">=</span> sig.replace(parameters<span class="op">=</span>sigd.values())</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> f</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b<span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="bu">hasattr</span>(mid, <span class="st">'__signature__'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b<span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(low)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="bu">hasattr</span>(mid, <span class="st">'__signature__'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="if-keepfalse-do-from_f.setattr__delwrap__-to_f" class="level4">
<h4 class="anchored" data-anchor-id="if-keepfalse-do-from_f.setattr__delwrap__-to_f">If <code>keep=False</code>, do <code>from_f.setattr("__delwrap__", to_f)</code></h4>
</section>
<section id="how-attr-two-ways-of-setting-attr-setattr-or-from_f.__signature__-..." class="level4">
<h4 class="anchored" data-anchor-id="how-attr-two-ways-of-setting-attr-setattr-or-from_f.__signature__-...">how-attr: two ways of setting attr: <code>setattr</code> or <code>from_f.__signature__= ...</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>: </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    from_f.__delwrap__</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">AttributeError</span> <span class="im">as</span> e:</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>to_f, from_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'function' object has no attribute '__delwrap__'</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>(&lt;function __main__.low(a, b: int = 1, c: int = 2, e: int = 1)&gt;,
 &lt;function __main__.mid(c: int, d: int = 1, **kwargs)&gt;)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>keep <span class="op">=</span> <span class="va">False</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> keep <span class="op">==</span> <span class="va">False</span>: from_f.__delwrap__ <span class="op">=</span> to_f <span class="co"># another way to set attr</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>from_f.__delwrap__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;function __main__.low(a, b: int = 1, c: int = 2, e: int = 1)&gt;</code></pre>
</div>
</div>
</section>
<section id="how-attr-set-and-delete-an-attr" class="level4">
<h4 class="anchored" data-anchor-id="how-attr-set-and-delete-an-attr">how-attr: set and delete an attr</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tst(): <span class="cf">pass</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>tst.<span class="fu">__setattr__</span>(<span class="st">"__delwrap__"</span>, <span class="st">"a"</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tst.__delwrap__)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>tst.__delwrap__ <span class="op">=</span> <span class="st">"b"</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tst.__delwrap__)</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>tst.<span class="fu">__delattr__</span>(<span class="st">"__delwrap__"</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>: </span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(tst.__delwrap__)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>: </span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"no more"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a
b
no more</code></pre>
</div>
</div>
</section>
<section id="replace-the-new-args-dict-with-the-old-args-in-the-signature-of-from_f" class="level4">
<h4 class="anchored" data-anchor-id="replace-the-new-args-dict-with-the-old-args-in-the-signature-of-from_f">Replace the new args dict with the old args in the signature of <code>from_f</code></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>sigd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'c': &lt;Parameter "c"&gt;,
 'd': &lt;Parameter "d: int = 1"&gt;,
 'e': &lt;Parameter "e: int = 1"&gt;}</code></pre>
</div>
</div>
</section>
<section id="how-dict-get-all-items-key-and-value-of-a-dict" class="level4">
<h4 class="anchored" data-anchor-id="how-dict-get-all-items-key-and-value-of-a-dict">how-dict: get all items (key and value) of a dict</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>sigd.items()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>dict_items([('c', &lt;Parameter "c"&gt;), ('d', &lt;Parameter "d: int = 1"&gt;), ('e', &lt;Parameter "e: int = 1"&gt;)])</code></pre>
</div>
</div>
</section>
<section id="how-dict-get-only-values-of-a-dict" class="level4">
<h4 class="anchored" data-anchor-id="how-dict-get-only-values-of-a-dict">how-dict: get only values of a dict</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>sigd.values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>dict_values([&lt;Parameter "c"&gt;, &lt;Parameter "d: int = 1"&gt;, &lt;Parameter "e: int = 1"&gt;])</code></pre>
</div>
</div>
</section>
<section id="how-inspect-getdoc-and-signature.replace" class="level4">
<h4 class="anchored" data-anchor-id="how-inspect-getdoc-and-signature.replace">how-inspect: getdoc and Signature.replace</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>pprint(inspect.getdoc(sig.replace))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>('Creates a customized copy of the Signature.\n'
 "Pass 'parameters' and/or 'return_annotation' arguments\n"
 'to override them in the new copy.')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    from_f.__signature__</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">AttributeError</span> <span class="im">as</span> e:</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>from_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'function' object has no attribute '__signature__'</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;function __main__.mid(c: int, d: int = 1, **kwargs)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>from_f.__signature__ <span class="op">=</span> sig.replace(parameters<span class="op">=</span>sigd.values())</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>pprint(from_f.__signature__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Signature (c, d: int = 1, *, e: int = 1)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>from_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;function __main__.mid(c, d: int = 1, *, e: int = 1)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return _f</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="problem-delegates-what-may-go-wrong-when-keeptrue-and-func-low-has-no-kwargs" class="level3">
<h3 class="anchored" data-anchor-id="problem-delegates-what-may-go-wrong-when-keeptrue-and-func-low-has-no-kwargs">problem-delegates: What may go wrong when <code>keep=True</code> and func <code>low</code> has no <code>**kwargs</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a:<span class="bu">int</span>,   </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>        b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>       ):</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"the locals of low: "</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    pprint(<span class="bu">locals</span>())</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(low)</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c:<span class="bu">int</span>,   </span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>        d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">**</span>kwargs </span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>       ):</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"the locals of mid: "</span>)</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>    pprint(<span class="bu">locals</span>())</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> low(c, <span class="op">**</span>kwargs) <span class="op">+</span> d</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(mid)</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> high(e:<span class="bu">int</span>,   </span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>         f:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>         <span class="op">**</span>kwargs </span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"the locals of high: "</span>)</span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>    pprint(<span class="bu">locals</span>())</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mid(e, <span class="op">**</span>kwargs) <span class="op">+</span> f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>mid(c<span class="op">=</span><span class="dv">2</span>,d<span class="op">=</span><span class="dv">1</span>,b<span class="op">=</span><span class="dv">1</span>) <span class="co"># use shift + tab</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>the locals of mid: 
{'c': 2, 'd': 1, 'kwargs': {'b': 1}}
the locals of low: 
{'a': 2, 'b': 1}</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>high(e<span class="op">=</span><span class="dv">2</span>,f<span class="op">=</span><span class="dv">1</span>,d<span class="op">=</span><span class="dv">1</span>,b<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>the locals of high: 
{'e': 2, 'f': 1, 'kwargs': {'b': 1, 'd': 1}}
the locals of mid: 
{'c': 2, 'd': 1, 'kwargs': {'b': 1}}
the locals of low: 
{'a': 2, 'b': 1}</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>5</code></pre>
</div>
</div>
<p>When <code>keep=True</code>, we can assume the user of <code>delegates</code> would like to make <code>**kwargs</code> visible and use additional keyword args at some point.</p>
<p>But when <code>low</code> has no <code>**kwargs</code>, and any additional kwargs (e.g.&nbsp;<code>g=1</code>) introduced will cause <code>low</code>to throw a TypeError. See example below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a:<span class="bu">int</span>,   </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>        b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>       ):</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"the locals of low: "</span>)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    pprint(<span class="bu">locals</span>())</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(low, keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c:<span class="bu">int</span>,   </span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>        d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">**</span>kwargs </span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>       ):</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"the locals of mid: "</span>)</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    pprint(<span class="bu">locals</span>())</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> low(c, <span class="op">**</span>kwargs) <span class="op">+</span> d</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(mid, keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> high(e:<span class="bu">int</span>,   </span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>         f:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>         <span class="op">**</span>kwargs </span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"the locals of high: "</span>)</span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>    pprint(<span class="bu">locals</span>())</span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mid(e, <span class="op">**</span>kwargs) <span class="op">+</span> f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>: </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>    high(e<span class="op">=</span><span class="dv">2</span>,f<span class="op">=</span><span class="dv">1</span>,d<span class="op">=</span><span class="dv">1</span>,b<span class="op">=</span><span class="dv">1</span>,g<span class="op">=</span><span class="dv">1</span>) <span class="co"># shift + tab to see **kwargs available</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">TypeError</span> <span class="im">as</span> e: </span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>the locals of high: 
{'e': 2, 'f': 1, 'kwargs': {'b': 1, 'd': 1, 'g': 1}}
the locals of mid: 
{'c': 2, 'd': 1, 'kwargs': {'b': 1, 'g': 1}}
low() got an unexpected keyword argument 'g'</code></pre>
</div>
</div>
<p>After inserting <code>**kwargs</code> into function <code>low</code>, <code>g=1</code> is happily accepted by <code>low</code> in <code>kwargs</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a:<span class="bu">int</span>, b:<span class="bu">int</span><span class="op">=</span><span class="dv">2</span>, <span class="op">**</span>kwargs): </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"the locals of low: "</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    pprint(<span class="bu">locals</span>())</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>test_eq(high(e<span class="op">=</span><span class="dv">2</span>,f<span class="op">=</span><span class="dv">1</span>,d<span class="op">=</span><span class="dv">1</span>,b<span class="op">=</span><span class="dv">1</span>,g<span class="op">=</span><span class="dv">1</span>),<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>the locals of high: 
{'e': 2, 'f': 1, 'kwargs': {'b': 1, 'd': 1, 'g': 1}}
the locals of mid: 
{'c': 2, 'd': 1, 'kwargs': {'b': 1, 'g': 1}}
the locals of low: 
{'a': 2, 'b': 1, 'kwargs': {'g': 1}}</code></pre>
</div>
</div>
<p>Wouldn’t it be nicer if we can remind or warn the <code>delegates</code> user that <code>low</code> with no <code>**kwargs</code> will cause error when you set <code>keep=True</code>?</p>
</section>
<section id="fastai-makes-no-mistake-like-this" class="level3">
<h3 class="anchored" data-anchor-id="fastai-makes-no-mistake-like-this">fastai makes no mistake like this</h3>
<p>See below the <a href="https://github.com/fastai/fastai/blob/825c27624e4f6612fc0ce87769d9238d0ab96bab/fastai/torch_core.py#L40">one</a> of a few <a href="https://github.com/fastai/fastai/search?q=delegates+%22keep%3DTrue%22">examples</a> when fastai uses <code>keep=True</code> I have found on August 11 2022.</p>
<p>how-delegates: correct way of using <code>keep=True</code>: pay attention to the first line and last line of the code block below</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(plt.subplots, keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> subplots(</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>    nrows:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="co"># Number of rows in returned axes grid</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    ncols:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="co"># Number of columns in returned axes grid</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    figsize:<span class="bu">tuple</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Width, height in inches of the returned figure </span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    imsize:<span class="bu">int</span><span class="op">=</span><span class="dv">3</span>, <span class="co"># Size (in inches) of images that will be displayed in the returned figure</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>    suptitle:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># Title to be set to returned figure</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> (plt.Figure, plt.Axes): <span class="co"># Returns both fig and ax as a tuple </span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Returns a figure and set of subplots to display images of `imsize` inches"</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> figsize <span class="kw">is</span> <span class="va">None</span>: </span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>        h<span class="op">=</span>nrows<span class="op">*</span>imsize <span class="cf">if</span> suptitle <span class="kw">is</span> <span class="va">None</span> <span class="kw">or</span> imsize<span class="op">&gt;</span><span class="dv">2</span> <span class="cf">else</span> nrows<span class="op">*</span>imsize<span class="op">+</span><span class="fl">0.6</span> <span class="co">#https://github.com/matplotlib/matplotlib/issues/5355</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>        figsize<span class="op">=</span>(ncols<span class="op">*</span>imsize, h)</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>    fig,ax <span class="op">=</span> plt.subplots(nrows, ncols, figsize<span class="op">=</span>figsize, <span class="op">**</span>kwargs) <span class="co"># must have **kwargs here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tinker-delegates-warn-user-the-lowest-level-to-has-no-kwargs-dont-pass-expected-params" class="level3">
<h3 class="anchored" data-anchor-id="tinker-delegates-warn-user-the-lowest-level-to-has-no-kwargs-dont-pass-expected-params">tinker-delegates: warn user the lowest level <code>to</code> has no <code>**kwargs</code>, don’t pass expected params</h3>
<section id="how-try-except-replace-the-combination-of-if-else-hasattr" class="level4">
<h4 class="anchored" data-anchor-id="how-try-except-replace-the-combination-of-if-else-hasattr">how-try-except: replace the combination of <code>if else</code> + <code>hasattr</code></h4>
</section>
<section id="how-attr-every-func-has-an-attr-__name__" class="level4">
<h4 class="anchored" data-anchor-id="how-attr-every-func-has-an-attr-__name__">how-attr: every func has an attr <code>__name__</code></h4>
<hr>
</section>
<section id="delegates_v1" class="level4">
<h4 class="anchored" data-anchor-id="delegates_v1">delegates_v1</h4>
<blockquote class="blockquote">
<pre><code> delegates_v1 (to=None, keep=False, but:list=None)</code></pre>
</blockquote>
<p>Decorator: replace <code>**kwargs</code> in signature with params from <code>to</code>. If <code>keep=True</code>and <code>to</code> has no <code>**kwargs</code> in its signature, a warning of TypeError will be generated.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>to</td>
<td>NoneType</td>
<td>None</td>
<td>delegates <code>to</code> to replace <code>**kwargs</code> with its own params</td>
</tr>
<tr class="even">
<td>keep</td>
<td>bool</td>
<td>False</td>
<td>keep <code>**kwargs</code> in the signature or not</td>
</tr>
<tr class="odd">
<td>but</td>
<td>list</td>
<td>None</td>
<td>leave out certain params from the signature</td>
</tr>
</tbody>
</table>
</section>
<section id="examples-of-v_1" class="level4">
<h4 class="anchored" data-anchor-id="examples-of-v_1">examples of v_1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a:<span class="bu">int</span>, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates_v1</span>(low, keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c:<span class="bu">int</span>, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: adding extra kwargs to mid will cause TypeError to low
</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates_v1</span>(mid, keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> high(e:<span class="bu">int</span>, f:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: adding extra kwargs to high will cause TypeError to low
</code></pre>
</div>
</div>
</section>
</section>
<section id="problem-delegates-params-from-to-act-as-keyword_only-but-its-type-says-otherwirse" class="level3">
<h3 class="anchored" data-anchor-id="problem-delegates-params-from-to-act-as-keyword_only-but-its-type-says-otherwirse">problem-delegates: params from <code>to</code> act as KEYWORD_ONLY but its type says otherwirse</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fastcore.meta <span class="im">as</span> fm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="at">@fm.delegates</span>(low, keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>inspect.signature(mid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (c, d: int = 1, *, b: int = 1, **kwargs)&gt;</code></pre>
</div>
</div>
<p>The signature above indicate that <code>b</code> from <code>low</code> is <code>POSITIONAL_OR_KEYWORD</code> kind. However, if you run <code>b</code> as so, it causes a TypeError like below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>: </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>    mid(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">TypeError</span> <span class="im">as</span> e:</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mid() takes from 1 to 2 positional arguments but 3 were given</code></pre>
</div>
</div>
<section id="how-inspect-check-param-kind" class="level4">
<h4 class="anchored" data-anchor-id="how-inspect-check-param-kind">how-inspect: check param kind</h4>
<p><code>b</code> in practice is a <code>KEYWORD_ONLY</code> param but when its type checked it is not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>{p.name: p.kind <span class="cf">for</span> p <span class="kw">in</span> inspect.signature(mid).parameters.values()}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'c': &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: 1&gt;,
 'd': &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: 1&gt;,
 'b': &lt;_ParameterKind.KEYWORD_ONLY: 3&gt;,
 'kwargs': &lt;_ParameterKind.VAR_KEYWORD: 4&gt;}</code></pre>
</div>
</div>
</section>
</section>
<section id="tinker-delegates-printing-a-warning-message-about-param-kind" class="level3">
<h3 class="anchored" data-anchor-id="tinker-delegates-printing-a-warning-message-about-param-kind">tinker-delegates: printing a warning message about param kind</h3>
<p>Let’s make <code>Core.delegates_v2</code> to print a message for users to use params from <code>to</code> as Keyword only params</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> {<span class="st">'a'</span>:<span class="dv">1</span>, <span class="st">'b'</span>:<span class="dv">2</span>}</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>[i <span class="cf">for</span> i <span class="kw">in</span> s.keys()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>['a', 'b']</code></pre>
</div>
</div>
<hr>
<section id="delegates_v2" class="level4">
<h4 class="anchored" data-anchor-id="delegates_v2">delegates_v2</h4>
<blockquote class="blockquote">
<pre><code> delegates_v2 (to=None, keep=False, but:list=None)</code></pre>
</blockquote>
<p>Compared with v1, delegates_v2 func add a feature to remind users that params from <code>to</code> are keyword-only params for <code>f</code>.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>to</td>
<td>NoneType</td>
<td>None</td>
<td>delegates <code>to</code> to replace <code>**kwargs</code> with its own params</td>
</tr>
<tr class="even">
<td>keep</td>
<td>bool</td>
<td>False</td>
<td>keep <code>**kwargs</code> in the signature or not</td>
</tr>
<tr class="odd">
<td>but</td>
<td>list</td>
<td>None</td>
<td>leave out certain params from the signature</td>
</tr>
</tbody>
</table>
</section>
<section id="delegates_v2-examples" class="level4">
<h4 class="anchored" data-anchor-id="delegates_v2-examples">delegates_v2 examples</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates_v2</span>(low, keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates_v2</span>(mid, keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> high(e, f:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mid has ['b'] as keyword only params, not to be used as positional.
Warning: adding extra kwargs to mid will cause TypeError to low

high has ['d', 'b'] as keyword only params, not to be used as positional.
Warning: adding extra kwargs to high will cause TypeError to low
</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>{p.name: p.kind <span class="cf">for</span> p <span class="kw">in</span> inspect.signature(mid).parameters.values()}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'c': &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: 1&gt;,
 'd': &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: 1&gt;,
 'b': &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: 1&gt;,
 'kwargs': &lt;_ParameterKind.VAR_KEYWORD: 4&gt;}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>: </span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>    mid(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">TypeError</span> <span class="im">as</span> e:</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mid() takes from 1 to 2 positional arguments but 3 were given</code></pre>
</div>
</div>
</section>
</section>
<section id="tinker-delegates-change-parameter-type-to-parameter.keyword_only" class="level3">
<h3 class="anchored" data-anchor-id="tinker-delegates-change-parameter-type-to-parameter.keyword_only">tinker-delegates: change parameter type to <code>Parameter.KEYWORD_ONLY</code></h3>
<hr>
<section id="delegates_v3" class="level4">
<h4 class="anchored" data-anchor-id="delegates_v3">delegates_v3</h4>
<blockquote class="blockquote">
<pre><code> delegates_v3 (to=None, keep=False, but:list=None)</code></pre>
</blockquote>
<p>Compared with v1, delegates_v2 func add a feature to remind users that params from <code>to</code> are keyword-only params for <code>f</code>.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>to</td>
<td>NoneType</td>
<td>None</td>
<td>delegates <code>to</code> to replace <code>**kwargs</code> with its own params</td>
</tr>
<tr class="even">
<td>keep</td>
<td>bool</td>
<td>False</td>
<td>keep <code>**kwargs</code> in the signature or not</td>
</tr>
<tr class="odd">
<td>but</td>
<td>list</td>
<td>None</td>
<td>leave out certain params from the signature</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="contribute-delegates-pr-accepted-on-august-11-2022" class="level3">
<h3 class="anchored" data-anchor-id="contribute-delegates-pr-accepted-on-august-11-2022">contribute-delegates: <a href="https://app.reviewnb.com/fastai/fastcore/pull/459/">PR</a> accepted on August 11 2022</h3>
<p>By adding a single line of code below the line where <code>s2</code> occurs.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change type from POSITIONAL_OR_KEYWORD to KEYWORD_ONLY for all parameters in s2</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> {name: param.replace(kind<span class="op">=</span>inspect.Parameter.KEYWORD_ONLY) <span class="cf">for</span> name, param <span class="kw">in</span> s2.items()} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>With Jeremy’s <a href="https://github.com/fastai/fastcore/pull/459#discussion_r942706390">help</a>, I have shortened the code by simply modifying the line started with <code>s2=</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> delegates(to<span class="op">=</span><span class="va">None</span>, keep<span class="op">=</span><span class="va">False</span>, but<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Decorator: replace `**kwargs` in signature with params from `to`"</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> but <span class="kw">is</span> <span class="va">None</span>: but <span class="op">=</span> []</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _f(f):</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> to <span class="kw">is</span> <span class="va">None</span>: to_f,from_f <span class="op">=</span> f.__base__.<span class="fu">__init__</span>,f.<span class="fu">__init__</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:          to_f,from_f <span class="op">=</span> to.<span class="fu">__init__</span> <span class="cf">if</span> <span class="bu">isinstance</span>(to,<span class="bu">type</span>) <span class="cf">else</span> to,f</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>        from_f <span class="op">=</span> <span class="bu">getattr</span>(from_f,<span class="st">'__func__'</span>,from_f)</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>        to_f <span class="op">=</span> <span class="bu">getattr</span>(to_f,<span class="st">'__func__'</span>,to_f)</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(from_f,<span class="st">'__delwrap__'</span>): <span class="cf">return</span> f</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>        sig <span class="op">=</span> inspect.signature(from_f)</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>        sigd <span class="op">=</span> <span class="bu">dict</span>(sig.parameters)</span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>        k <span class="op">=</span> sigd.pop(<span class="st">'kwargs'</span>)</span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>        s2 <span class="op">=</span> {k:v.replace(kind<span class="op">=</span>inspect.Parameter.KEYWORD_ONLY) <span class="cf">for</span> k,v <span class="kw">in</span> inspect.signature(to_f).parameters.items()</span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a>              <span class="cf">if</span> v.default <span class="op">!=</span> inspect.Parameter.empty <span class="kw">and</span> k <span class="kw">not</span> <span class="kw">in</span> sigd <span class="kw">and</span> k <span class="kw">not</span> <span class="kw">in</span> but}</span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a>        sigd.update(s2)</span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> keep: sigd[<span class="st">'kwargs'</span>] <span class="op">=</span> k</span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: from_f.__delwrap__ <span class="op">=</span> to_f</span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a>        from_f.__signature__ <span class="op">=</span> sig.replace(parameters<span class="op">=</span>sigd.values())</span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> f</span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(low, keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="at">@delegates</span>(mid, keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> high(e, f:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>{p.name: p.kind <span class="cf">for</span> p <span class="kw">in</span> inspect.signature(mid).parameters.values()}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'c': &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: 1&gt;,
 'd': &lt;_ParameterKind.POSITIONAL_OR_KEYWORD: 1&gt;,
 'b': &lt;_ParameterKind.KEYWORD_ONLY: 3&gt;,
 'kwargs': &lt;_ParameterKind.VAR_KEYWORD: 4&gt;}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>inspect.signature(mid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (c, d: int = 1, *, b: int = 1, **kwargs)&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="mk_param" class="level2">
<h2 class="anchored" data-anchor-id="mk_param">_mk_param</h2>
<p>how-parameter: How to make a parameter</p>
<section id="how-import-what-does-from-fastcore.meta-import-mean" class="level3">
<h3 class="anchored" data-anchor-id="how-import-what-does-from-fastcore.meta-import-mean">how-import: What does <code>from fastcore.meta import *</code> mean</h3>
<p><code>from fastcore.meta import *</code> won’t give you everything inside <code>meta</code> module but a selective group contained in a list <code>__all__</code>, to use the unselected ones, you can:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fastcore.met <span class="im">as</span> fm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and use <code>fm. + tab</code> to check out everything.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>head <span class="op">/</span>Users<span class="op">/</span>Natsume<span class="op">/</span>mambaforge<span class="op">/</span>lib<span class="op">/</span>python3<span class="fl">.9</span><span class="op">/</span>site<span class="op">-</span>packages<span class="op">/</span>fastcore<span class="op">/</span>meta.py</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>head: /Users/Natsume/mambaforge/lib/python3.9/site-packages/fastcore/meta.py: No such file or directory</code></pre>
</div>
</div>
</section>
<section id="mk_param-examples" class="level3">
<h3 class="anchored" data-anchor-id="mk_param-examples"><code>_mk_param</code> examples</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastcore.meta <span class="im">import</span> _mk_param</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>_mk_param(<span class="st">'b'</span>), _mk_param(<span class="st">'b'</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(&lt;Parameter "b=None"&gt;, &lt;Parameter "b=1"&gt;)</code></pre>
</div>
</div>
</section>
<section id="mk_param-source" class="level3">
<h3 class="anchored" data-anchor-id="mk_param-source"><code>_mk_param</code> source</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _mk_param(n,d<span class="op">=</span><span class="va">None</span>): <span class="cf">return</span> inspect.Parameter(n, inspect.Parameter.KEYWORD_ONLY, default<span class="op">=</span>d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="sourceCode" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _mk_param(n,d<span class="op">=</span><span class="va">None</span>): <span class="cf">return</span> inspect.Parameter(n, inspect.Parameter.KEYWORD_ONLY, default<span class="op">=</span>d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="mk_param-anatomy" class="level3">
<h3 class="anchored" data-anchor-id="mk_param-anatomy"><code>_mk_param</code> anatomy</h3>
<section id="how-inspect-get-signature" class="level4">
<h4 class="anchored" data-anchor-id="how-inspect-get-signature">how-inspect: get signature</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>inspect.signature(inspect.Parameter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (name, kind, *, default, annotation)&gt;</code></pre>
</div>
</div>
</section>
<section id="how-inspect-getdoc" class="level4">
<h4 class="anchored" data-anchor-id="how-inspect-getdoc">how-inspect: getdoc</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>pprint(inspect.getdoc(inspect.Parameter))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>('Represents a parameter in a function signature.\n'
 '\n'
 'Has the following public attributes:\n'
 '\n'
 '* name : str\n'
 '    The name of the parameter as a string.\n'
 '* default : object\n'
 '    The default value for the parameter if specified.  If the\n'
 '    parameter has no default value, this attribute is set to\n'
 '    `Parameter.empty`.\n'
 '* annotation\n'
 '    The annotation for the parameter if specified.  If the\n'
 '    parameter has no annotation, this attribute is set to\n'
 '    `Parameter.empty`.\n'
 '* kind : str\n'
 '    Describes how argument values are bound to the parameter.\n'
 '    Possible values: `Parameter.POSITIONAL_ONLY`,\n'
 '    `Parameter.POSITIONAL_OR_KEYWORD`, `Parameter.VAR_POSITIONAL`,\n'
 '    `Parameter.KEYWORD_ONLY`, `Parameter.VAR_KEYWORD`.')</code></pre>
</div>
</div>
</section>
<section id="how-inspect-create-parameter" class="level4">
<h4 class="anchored" data-anchor-id="how-inspect-create-parameter">how-inspect: create Parameter</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> inspect.Parameter(<span class="st">"b"</span>, inspect.Parameter.KEYWORD_ONLY, default<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(p), p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(inspect.Parameter, &lt;Parameter "b=None"&gt;)</code></pre>
</div>
</div>
</section>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
</section>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
</section>
<section id="use_kwargs_dict" class="level2">
<h2 class="anchored" data-anchor-id="use_kwargs_dict">use_kwargs_dict</h2>
<p>how-kwargs: replace <code>**kwargs</code> with a dict of params</p>
<section id="use_kwargs_dic-source" class="level3">
<h3 class="anchored" data-anchor-id="use_kwargs_dic-source"><code>use_kwargs_dic</code> source</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> use_kwargs_dict(keep<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>kwargs):</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Decorator: replace `**kwargs` in signature with `names` params"</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _f(f):</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>        sig <span class="op">=</span> inspect.signature(f)</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>        sigd <span class="op">=</span> <span class="bu">dict</span>(sig.parameters)</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>        k <span class="op">=</span> sigd.pop(<span class="st">'kwargs'</span>)</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>        s2 <span class="op">=</span> {n:_mk_param(n,d) <span class="cf">for</span> n,d <span class="kw">in</span> kwargs.items() <span class="cf">if</span> n <span class="kw">not</span> <span class="kw">in</span> sigd}</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>        sigd.update(s2)</span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> keep: sigd[<span class="st">'kwargs'</span>] <span class="op">=</span> k</span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>        f.__signature__ <span class="op">=</span> sig.replace(parameters<span class="op">=</span>sigd.values())</span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> f</span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="how-code-put-for-in-and-if-else-in-a-single-line" class="level4">
<h4 class="anchored" data-anchor-id="how-code-put-for-in-and-if-else-in-a-single-line">how-code: put <code>for in</code> and <code>if else</code> in a single line</h4>
<div class="sourceCode" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> {n:_mk_param(n,d) <span class="cf">for</span> n,d <span class="kw">in</span> kwargs.items() <span class="cf">if</span> n <span class="kw">not</span> <span class="kw">in</span> sigd}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="most-attributes-like-__signature__-__func__-are-added-by-decorators" class="level4">
<h4 class="anchored" data-anchor-id="most-attributes-like-__signature__-__func__-are-added-by-decorators">most attributes like <code>__signature__</code>, <code>__func__</code> are added by decorators</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo(a, b<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="bu">hasattr</span>(foo, <span class="st">'__signature__'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="at">@use_kwargs_dict</span>(y<span class="op">=</span><span class="dv">1</span>,z<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo(a, b<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="bu">hasattr</span>(foo, <span class="st">'__signature__'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
</section>
</section>
<section id="use_kwargs_dict-examples" class="level3">
<h3 class="anchored" data-anchor-id="use_kwargs_dict-examples"><code>use_kwargs_dict</code> examples</h3>
<p>Replace all **kwargs with named arguments like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="at">@use_kwargs_dict</span>(y<span class="op">=</span><span class="dv">1</span>,z<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo(a, b<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>test_sig(foo, <span class="st">'(a, b=1, *, y=1, z=None)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Add named arguments, but optionally keep **kwargs by setting keep=True:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="at">@use_kwargs_dict</span>(y<span class="op">=</span><span class="dv">1</span>,z<span class="op">=</span><span class="va">None</span>, keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo(a, b<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>test_sig(foo, <span class="st">'(a, b=1, *, y=1, z=None, **kwargs)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2"></h2>
</section>
<section id="use_kwargs" class="level2">
<h2 class="anchored" data-anchor-id="use_kwargs">use_kwargs</h2>
<p>how-kwargs: to replace <code>**kwargs</code> with a list of param names. <code>use_kwargs</code></p>
<section id="use_kwargs-source" class="level3">
<h3 class="anchored" data-anchor-id="use_kwargs-source"><code>use_kwargs</code> source</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> use_kwargs(names, keep<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Decorator: replace `**kwargs` in signature with `names` params"</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _f(f):</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>        sig <span class="op">=</span> inspect.signature(f)</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>        sigd <span class="op">=</span> <span class="bu">dict</span>(sig.parameters)</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>        k <span class="op">=</span> sigd.pop(<span class="st">'kwargs'</span>)</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>        s2 <span class="op">=</span> {n:_mk_param(n) <span class="cf">for</span> n <span class="kw">in</span> names <span class="cf">if</span> n <span class="kw">not</span> <span class="kw">in</span> sigd}</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>        sigd.update(s2)</span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> keep: sigd[<span class="st">'kwargs'</span>] <span class="op">=</span> k</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>        f.__signature__ <span class="op">=</span> sig.replace(parameters<span class="op">=</span>sigd.values())</span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> f</span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> _f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="use_kwargs-examples" class="level3">
<h3 class="anchored" data-anchor-id="use_kwargs-examples"><code>use_kwargs</code> examples</h3>
<p>use_kwargs is different than use_kwargs_dict as it only replaces **kwargs with named parameters without any default values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="at">@use_kwargs</span>([<span class="st">'y'</span>, <span class="st">'z'</span>])</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo(a, b<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>test_sig(foo, <span class="st">'(a, b=1, *, y=None, z=None)'</span>)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>inspect.signature(foo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (a, b=1, *, y=None, z=None)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>    foo(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">TypeError</span> <span class="im">as</span> e:</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(e)</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> foo(<span class="dv">1</span>,<span class="dv">1</span>,y<span class="op">=</span><span class="dv">1</span>) <span class="op">==</span> foo(<span class="dv">1</span>,<span class="dv">1</span>,y<span class="op">=</span><span class="dv">1</span>,z<span class="op">=</span><span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>foo() takes from 1 to 2 positional arguments but 3 were given</code></pre>
</div>
</div>
<p>You may optionally keep the <code>**kwargs</code> argument in your signature by setting <code>keep=True</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="at">@use_kwargs</span>([<span class="st">'y'</span>, <span class="st">'z'</span>], keep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> foo(a, <span class="op">*</span>args, b<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): pprint(<span class="bu">locals</span>())</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>test_sig(foo, <span class="st">'(a, *args, b=1, y=None, z=None, **kwargs)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="how-code-how-args-in-signature-behave" class="level3">
<h3 class="anchored" data-anchor-id="how-code-how-args-in-signature-behave">how-code: how <code>*args</code> in signature behave?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>foo(<span class="dv">1</span>,[<span class="dv">1</span>],y<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'a': 1, 'args': ([1],), 'b': 1, 'kwargs': {'y': 1}}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>foo(<span class="dv">1</span>,[<span class="dv">1</span>,<span class="dv">1</span>],y<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'a': 1, 'args': ([1, 1],), 'b': 1, 'kwargs': {'y': 1}}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>foo(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,y<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'a': 1, 'args': (1, 1), 'b': 1, 'kwargs': {'y': 1}}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>foo(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,b<span class="op">=</span><span class="dv">1</span>,y<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'a': 1, 'args': (1, 1), 'b': 1, 'kwargs': {'y': 1}}</code></pre>
</div>
</div>
</section>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3"></h2>
</section>
<section id="test_sig" class="level2">
<h2 class="anchored" data-anchor-id="test_sig">test_sig</h2>
<p>how-test: signature</p>
<section id="test_sig-source" class="level3">
<h3 class="anchored" data-anchor-id="test_sig-source"><code>test_sig</code> source</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test_sig(f, b):</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Test the signature of an object"</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>    test_eq(<span class="bu">str</span>(inspect.signature(f)), b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="test_sig-examples" class="level3">
<h3 class="anchored" data-anchor-id="test_sig-examples"><code>test_sig</code> examples</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> func_1(h,i,j): <span class="cf">pass</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> func_2(h,i<span class="op">=</span><span class="dv">3</span>, j<span class="op">=</span>[<span class="dv">5</span>,<span class="dv">6</span>]): <span class="cf">pass</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> T:</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a, b): <span class="cf">pass</span></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>test_sig(func_1, <span class="st">'(h, i, j)'</span>)</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>test_sig(func_2, <span class="st">'(h, i=3, j=[5, 6])'</span>)</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>test_sig(T, <span class="st">'(a, b)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="test_sig-anatomy" class="level3">
<h3 class="anchored" data-anchor-id="test_sig-anatomy"><code>test_sig</code> anatomy</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>inspect.signature(T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (a, b)&gt;</code></pre>
</div>
</div>
<section id="how-str-turn-signature-into-string" class="level4">
<h4 class="anchored" data-anchor-id="how-str-turn-signature-into-string">how-str: turn signature into string</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="bu">str</span>(inspect.signature(T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'(a, b)'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>inspect.signature(func_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (h, i=3, j=[5, 6])&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="bu">str</span>(inspect.signature(func_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'(h, i=3, j=[5, 6])'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">str</span>(inspect.signature(func_2)), <span class="st">'(h, i=3, j=[5, 6])'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> <span class="bu">str</span>(inspect.signature(func_2)) <span class="op">==</span> <span class="st">'(h, i=3, j=[5, 6])'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4"></h2>
</section>
<section id="rm_self" class="level2">
<h2 class="anchored" data-anchor-id="rm_self"><code>_rm_self</code></h2>
<p>how-inspect/how-self: remove <code>self</code> in signature</p>
<section id="rm_self-source" class="level3">
<h3 class="anchored" data-anchor-id="rm_self-source"><code>_rm_self</code> source</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _rm_self(sig):</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>    sigd <span class="op">=</span> <span class="bu">dict</span>(sig.parameters)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>    sigd.pop(<span class="st">'self'</span>)</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sig.replace(parameters<span class="op">=</span>sigd.values())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rm_self-examples" class="level3">
<h3 class="anchored" data-anchor-id="rm_self-examples"><code>_rm_self</code> examples</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Base:</span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a, b:<span class="bu">int</span><span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> test(<span class="va">self</span>, c, d): <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>inspect.signature(Base.<span class="fu">__init__</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (self, a, b: int = 1, **kwargs)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>_rm_self(inspect.signature(Base.<span class="fu">__init__</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (a, b: int = 1, **kwargs)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>inspect.signature(Base.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (self, c, d)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>_rm_self(inspect.signature(Base.test))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (c, d)&gt;</code></pre>
</div>
</div>
</section>
<section id="rm_self-anatomy" class="level3">
<h3 class="anchored" data-anchor-id="rm_self-anatomy"><code>_rm_self</code> anatomy</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>sig <span class="op">=</span> inspect.signature(Base.<span class="fu">__init__</span>)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>sig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (self, a, b: int = 1, **kwargs)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>sigd <span class="op">=</span> <span class="bu">dict</span>(sig.parameters)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>sigd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'self': &lt;Parameter "self"&gt;,
 'a': &lt;Parameter "a"&gt;,
 'b': &lt;Parameter "b: int = 1"&gt;,
 'kwargs': &lt;Parameter "**kwargs"&gt;}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>sigd.pop(<span class="st">'self'</span>)</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>sigd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'a': &lt;Parameter "a"&gt;,
 'b': &lt;Parameter "b: int = 1"&gt;,
 'kwargs': &lt;Parameter "**kwargs"&gt;}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>sigd.values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>dict_values([&lt;Parameter "a"&gt;, &lt;Parameter "b: int = 1"&gt;, &lt;Parameter "**kwargs"&gt;])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>sig.replace(parameters<span class="op">=</span>sigd.values())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (a, b: int = 1, **kwargs)&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="section-5" class="level2">
<h2 class="anchored" data-anchor-id="section-5"></h2>
</section>
<section id="fixsigmeta" class="level2">
<h2 class="anchored" data-anchor-id="fixsigmeta">FixSigMeta</h2>
<p>A metaclass that fixes the signature on classes that override <code>__new__</code></p>
<p>When you inherit from a class that defines <code>__new__</code>, or a metaclass that defines <code>__call__</code>, the signature of your <code>__init__</code> method is obfuscated such that tab completion no longer works. FixSigMeta fixes this issue and restores signatures.</p>
<p>To understand what <a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#fixsigmeta"><code>FixSigMeta</code></a> does, it is useful to inspect an object’s signature. You can inspect the signature of an object with <code>inspect.signature</code>:</p>
<p>Interesting! <code>FixSigMeta??</code> won’t give us the source code, neither can <code>inspect.getsource</code> on it.</p>
<section id="fixsigmeta-examples" class="level3">
<h3 class="anchored" data-anchor-id="fixsigmeta-examples"><a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#fixsigmeta"><code>FixSigMeta</code></a> examples</h3>
<section id="examples-not-really-working-effectively" class="level4">
<h4 class="anchored" data-anchor-id="examples-not-really-working-effectively">examples not really working effectively</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> T:</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a, b, c): <span class="cf">pass</span></span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>inspect.signature(T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Signature (a, b, c)&gt;</code></pre>
</div>
</div>
<p>This corresponds to tab completion working in the normal way:</p>
<p><code>T() + shift + tab</code> can provide the following info on the function</p>
<pre><code>Init signature: T(a, b, c)
Docstring:      &lt;no docstring&gt;
Type:           type</code></pre>
<p>What is the signature of <code>T.__init__</code></p>
<p>However, when you inherhit from a class that defines <code>__new__</code> or a metaclass that defines <code>__call__</code> this obfuscates the signature by overriding your class with the signature of <code>__new__</code>, which prevents tab completion from displaying useful information:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Foo:</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__new__</span>(<span class="va">self</span>, <span class="op">**</span>args): <span class="cf">pass</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Bar(Foo):</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, d, e, f): <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(Foo))</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(Foo.<span class="fu">__new__</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Signature (**args)&gt;
&lt;Signature (self, **args)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(Bar))</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(Bar.<span class="fu">__new__</span>))</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>pprint(inspect.signature(Bar.<span class="fu">__init__</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Signature (d, e, f)&gt;
&lt;Signature (self, **args)&gt;
&lt;Signature (self, d, e, f)&gt;</code></pre>
</div>
</div>
<p>Finally, the signature and tab completion can be restored by inheriting from the metaclass&nbsp;<a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#fixsigmeta"><code>FixSigMeta</code></a>&nbsp;as shown below:</p>
</section>
<section id="how-fixsigmeta-when-inherit-a-class-override-__new__" class="level4">
<h4 class="anchored" data-anchor-id="how-fixsigmeta-when-inherit-a-class-override-__new__">how-FixSigMeta: when inherit a class override <code>__new__</code></h4>
<hr>
</section>
</section>
<section id="fixsigmeta-1" class="level3">
<h3 class="anchored" data-anchor-id="fixsigmeta-1">FixSigMeta</h3>
<blockquote class="blockquote">
<pre><code> FixSigMeta (name, bases, dict)</code></pre>
</blockquote>
<p>A metaclass that fixes the signature on classes that override <code>__new__</code> of <code>type</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Foo:</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__new__</span>(cls, <span class="op">*</span>args): <span class="co"># to create an instance of class Foo</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"============================</span><span class="ch">\n</span><span class="st">Running Foo.__new__"</span>)</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"local variables inside Foo.__new__:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>        pprint(<span class="bu">locals</span>())</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"cls.__class__ is: </span><span class="sc">{</span>cls<span class="sc">.</span>__class__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">what is super():</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>        pprint(<span class="bu">super</span>())</span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> <span class="bu">super</span>().<span class="fu">__new__</span>(cls) <span class="co"># equivalent to object.__new__(cls), </span></span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># it is to create an object of class Bar whose superclass is Foo</span></span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"super().__new__ created: </span><span class="sc">{</span>res<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-15"><a href="#cb235-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> res</span>
<span id="cb235-16"><a href="#cb235-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-17"><a href="#cb235-17" aria-hidden="true" tabindex="-1"></a><span class="co"># FixSigMeta is called here to create Bar class, not to create instance of Bar</span></span>
<span id="cb235-18"><a href="#cb235-18" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Bar(Foo, metaclass<span class="op">=</span>FixSigMeta): </span>
<span id="cb235-19"><a href="#cb235-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># running Foo.__new__ here</span></span>
<span id="cb235-20"><a href="#cb235-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"=================================We are in the context of Bar: </span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb235-21"><a href="#cb235-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-22"><a href="#cb235-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, d, e, f): </span>
<span id="cb235-23"><a href="#cb235-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">==================================</span><span class="ch">\n</span><span class="st"> we are inside Bar.__init__"</span>)</span>
<span id="cb235-24"><a href="#cb235-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"local variables available to Bar.__init__:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb235-25"><a href="#cb235-25" aria-hidden="true" tabindex="-1"></a>        pprint(<span class="bu">locals</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=================================We are in the context of Bar: 

============================
running metaclass FixSigMeta.__new__

local variables are:

{'__class__': &lt;class '__main__.FixSigMeta'&gt;,
 'bases': (&lt;class '__main__.Foo'&gt;,),
 'cls': &lt;class '__main__.FixSigMeta'&gt;,
 'dict': {'__init__': &lt;function Bar.__init__&gt;,
          '__module__': '__main__',
          '__qualname__': 'Bar'},
 'name': 'Bar'}

Using type.__new__ to create a class instance of type: &lt;class '__main__.Bar'&gt;
"Bar's type should and is: &lt;class '__main__.FixSigMeta'&gt;"

Bar's inheritance tree: (&lt;class '__main__.Bar'&gt;, &lt;class '__main__.Foo'&gt;, &lt;class 'object'&gt;)
In other words, Bar's bases are: (&lt;class '__main__.Foo'&gt;,)


does Bar have attr `__signature__`:False
&lt;Signature (d, e, f)&gt;
if Bar has its own __init__, then update with __init__'s signature

now, Bar.__signature__ becomes:(d, e, f)

end of metaclass FixSigMeta.__new__
============================</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">isinstance</span>(Bar, FixSigMeta), <span class="va">True</span>) <span class="co"># FixSigMeta created Bar</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">isinstance</span>(Bar, Foo), <span class="va">False</span>) </span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">issubclass</span>(Bar, Foo), <span class="va">True</span>) <span class="co"># Bar inherited from Foo</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>test_eq(<span class="bu">issubclass</span>(Foo, <span class="bu">object</span>), <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># When creating an instance of Bar</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It will not run FixSigMeta.__new__, but run FixSigMeta.__call__ (not specified) </span></span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="co"># as a result, inside Bar it inherits and runs Foo.__new__, </span></span>
<span id="cb238-4"><a href="#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and then inherits and overrides Foo.__init__ with Bar.__init__</span></span>
<span id="cb238-5"><a href="#cb238-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> Bar(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>============================
Running Foo.__new__
local variables inside Foo.__new__:

{'__class__': &lt;class '__main__.Foo'&gt;,
 'args': (1, 2, 3),
 'cls': &lt;class '__main__.Bar'&gt;}
cls.__class__ is: &lt;class '__main__.FixSigMeta'&gt;

what is super():

&lt;super: &lt;class 'Foo'&gt;, &lt;Bar object&gt;&gt;
super().__new__ created: &lt;__main__.Bar object&gt;


==================================
 we are inside Bar.__init__
local variables available to Bar.__init__:

{'d': 1, 'e': 2, 'f': 3, 'self': &lt;__main__.Bar object&gt;}</code></pre>
</div>
</div>
<section id="how-fixsigmeta-when-inherit-a-metaclass-to-override-__call__" class="level4">
<h4 class="anchored" data-anchor-id="how-fixsigmeta-when-inherit-a-metaclass-to-override-__call__">how-FixSigMeta: when inherit a metaclass to override <code>__call__</code></h4>
<p>If you need to define a metaclass that overrides&nbsp;<code>__call__</code>&nbsp;(as done in&nbsp;<a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#prepostinitmeta"><code>PrePostInitMeta</code></a>), you need to inherit from&nbsp;<a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#fixsigmeta"><code>FixSigMeta</code></a>&nbsp;instead of&nbsp;<code>type</code>&nbsp;when constructing the metaclass to preserve the signature in&nbsp;<code>__init__</code>. Be careful not to override&nbsp;<code>__new__</code>&nbsp;when doing this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TestMeta(FixSigMeta): <span class="co"># making a subclass of FixSigMeta, which overrides __call__</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># __new__ comes from FixSigMeta</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(cls, <span class="op">*</span>args, <span class="op">**</span>kwargs): <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> T(metaclass<span class="op">=</span>TestMeta):</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a, b): <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>============================
running metaclass FixSigMeta.__new__

local variables are:

{'__class__': &lt;class '__main__.FixSigMeta'&gt;,
 'bases': (),
 'cls': &lt;class '__main__.TestMeta'&gt;,
 'dict': {'__init__': &lt;function T.__init__&gt;,
          '__module__': '__main__',
          '__qualname__': 'T'},
 'name': 'T'}

Using type.__new__ to create a class instance of type: &lt;class '__main__.T'&gt;
"T's type should and is: &lt;class '__main__.TestMeta'&gt;"

T's inheritance tree: (&lt;class '__main__.T'&gt;, &lt;class 'object'&gt;)
In other words, T's bases are: (&lt;class 'object'&gt;,)


does T have attr `__signature__`:False
&lt;Signature (*args, **kwargs)&gt;
if T has its own __init__, then update with __init__'s signature

now, T.__signature__ becomes:(a, b)

end of metaclass FixSigMeta.__new__
============================</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>test_sig(T, <span class="st">'(a, b)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On the other hand, if you fail to inherit from&nbsp;<a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#fixsigmeta"><code>FixSigMeta</code></a>&nbsp;when inheriting from a metaclass that overrides&nbsp;<code>__call__</code>, your signature will reflect that of&nbsp;<code>__call__</code>&nbsp;instead (which is often undesirable):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GenericMeta(<span class="bu">type</span>): <span class="co"># create a metaclass from type and overrides both __new__ and __call_</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"A boilerplate metaclass that doesn't do anything for testing."</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__new__</span>(cls, name, bases, <span class="bu">dict</span>):</span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"============================</span><span class="ch">\n</span><span class="st">running metaclass GenericMeta.__new__</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"local variables available to GenericMeta.__new__:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>        pprint(<span class="bu">locals</span>())</span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> <span class="bu">super</span>().<span class="fu">__new__</span>(cls, name, bases, <span class="bu">dict</span>) <span class="co"># run type.__new__()</span></span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">type.__new__ created: </span><span class="sc">{</span>res<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a>        pprint(<span class="ss">f"</span><span class="sc">{</span>res<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss">'s type is </span><span class="sc">{</span><span class="bu">type</span>(res)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>res<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss">'s inheritance tree: </span><span class="sc">{</span>res<span class="sc">.</span>__mro__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb244-13"><a href="#cb244-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">does </span><span class="sc">{</span>res<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss"> have attr `__signature__`:</span><span class="sc">{</span><span class="bu">hasattr</span>(res, <span class="st">'__signature__'</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb244-14"><a href="#cb244-14" aria-hidden="true" tabindex="-1"></a>        pprint(inspect.signature(res))</span>
<span id="cb244-15"><a href="#cb244-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>res<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss">'s bases are: </span><span class="sc">{</span>res<span class="sc">.</span>__bases__<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb244-16"><a href="#cb244-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb244-17"><a href="#cb244-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> res</span>
<span id="cb244-18"><a href="#cb244-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb244-19"><a href="#cb244-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(cls, <span class="op">*</span>args, <span class="op">**</span>kwargs): <span class="bu">print</span>(<span class="st">"==========================</span><span class="ch">\n</span><span class="st">running GenericMeta.__call__"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> T2(metaclass<span class="op">=</span>GenericMeta):</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a, b): <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>============================
running metaclass GenericMeta.__new__

local variables available to GenericMeta.__new__:

{'__class__': &lt;class '__main__.GenericMeta'&gt;,
 'bases': (),
 'cls': &lt;class '__main__.GenericMeta'&gt;,
 'dict': {'__init__': &lt;function T2.__init__&gt;,
          '__module__': '__main__',
          '__qualname__': 'T2'},
 'name': 'T2'}

type.__new__ created: &lt;class '__main__.T2'&gt;
"T2's type is &lt;class '__main__.GenericMeta'&gt;"

T2's inheritance tree: (&lt;class '__main__.T2'&gt;, &lt;class 'object'&gt;)

does T2 have attr `__signature__`:False
&lt;Signature (*args, **kwargs)&gt;
T2's bases are: (&lt;class 'object'&gt;,)
</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>T2() <span class="co"># to instantiate an object of T2 class, GenericMeta.__call__ is called under the scene</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==========================
running GenericMeta.__call__</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> GenericMeta(FixSigMeta): <span class="co"># make GenericMeta a subclass of metaclass FixSigMeta</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"A boilerplate metaclass that doesn't do anything for testing."</span></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__new__</span>(cls, name, bases, <span class="bu">dict</span>):</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"============================</span><span class="ch">\n</span><span class="st">running metaclass GenericMeta.__new__</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"local variables available to GenericMeta.__new__:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a>        pprint(<span class="bu">locals</span>())</span>
<span id="cb249-7"><a href="#cb249-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb249-8"><a href="#cb249-8" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> <span class="bu">super</span>().<span class="fu">__new__</span>(cls, name, bases, <span class="bu">dict</span>) <span class="co"># run type.__new__()</span></span>
<span id="cb249-9"><a href="#cb249-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">type.__new__ created: </span><span class="sc">{</span>res<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb249-10"><a href="#cb249-10" aria-hidden="true" tabindex="-1"></a>        pprint(<span class="ss">f"</span><span class="sc">{</span>res<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss">'s type is </span><span class="sc">{</span><span class="bu">type</span>(res)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb249-11"><a href="#cb249-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>res<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss">'s inheritance tree: </span><span class="sc">{</span>res<span class="sc">.</span>__mro__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb249-12"><a href="#cb249-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">does </span><span class="sc">{</span>res<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss"> have attr `__signature__`:</span><span class="sc">{</span><span class="bu">hasattr</span>(res, <span class="st">'__signature__'</span>)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb249-13"><a href="#cb249-13" aria-hidden="true" tabindex="-1"></a>        pprint(inspect.signature(res))</span>
<span id="cb249-14"><a href="#cb249-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>res<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss">'s bases are: </span><span class="sc">{</span>res<span class="sc">.</span>__bases__<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb249-15"><a href="#cb249-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb249-16"><a href="#cb249-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> res</span>
<span id="cb249-17"><a href="#cb249-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb249-18"><a href="#cb249-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb249-19"><a href="#cb249-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(cls, <span class="op">*</span>args, <span class="op">**</span>kwargs): <span class="bu">print</span>(<span class="st">"==========================</span><span class="ch">\n</span><span class="st">running GenericMeta.__call__"</span>)</span>
<span id="cb249-20"><a href="#cb249-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-21"><a href="#cb249-21" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> T2(metaclass<span class="op">=</span>GenericMeta): <span class="co"># create T2 class as an instance of GenericMeta class</span></span>
<span id="cb249-22"><a href="#cb249-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, a, b): <span class="cf">pass</span></span>
<span id="cb249-23"><a href="#cb249-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-24"><a href="#cb249-24" aria-hidden="true" tabindex="-1"></a>test_sig(T2, <span class="st">'(a, b)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>============================
running metaclass GenericMeta.__new__

local variables available to GenericMeta.__new__:

{'__class__': &lt;class '__main__.GenericMeta'&gt;,
 'bases': (),
 'cls': &lt;class '__main__.GenericMeta'&gt;,
 'dict': {'__init__': &lt;function T2.__init__&gt;,
          '__module__': '__main__',
          '__qualname__': 'T2'},
 'name': 'T2'}
============================
running metaclass FixSigMeta.__new__

local variables are:

{'__class__': &lt;class '__main__.FixSigMeta'&gt;,
 'bases': (),
 'cls': &lt;class '__main__.GenericMeta'&gt;,
 'dict': {'__init__': &lt;function T2.__init__&gt;,
          '__module__': '__main__',
          '__qualname__': 'T2'},
 'name': 'T2'}

Using type.__new__ to create a class instance of type: &lt;class '__main__.T2'&gt;
"T2's type should and is: &lt;class '__main__.GenericMeta'&gt;"

T2's inheritance tree: (&lt;class '__main__.T2'&gt;, &lt;class 'object'&gt;)
In other words, T2's bases are: (&lt;class 'object'&gt;,)


does T2 have attr `__signature__`:False
&lt;Signature (*args, **kwargs)&gt;
if T2 has its own __init__, then update with __init__'s signature

now, T2.__signature__ becomes:(a, b)

end of metaclass FixSigMeta.__new__
============================

type.__new__ created: &lt;class '__main__.T2'&gt;
"T2's type is &lt;class '__main__.GenericMeta'&gt;"

T2's inheritance tree: (&lt;class '__main__.T2'&gt;, &lt;class 'object'&gt;)

does T2 have attr `__signature__`:True
&lt;Signature (a, b)&gt;
T2's bases are: (&lt;class 'object'&gt;,)
</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>FixSigMeta??</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="section-6" class="level2">
<h2 class="anchored" data-anchor-id="section-6"></h2>
</section>
<section id="prepostinitmeta" class="level2">
<h2 class="anchored" data-anchor-id="prepostinitmeta">PrePostInitMeta</h2>
<section id="relations-between-prepostinitmeta-and-fixsigmeta" class="level3">
<h3 class="anchored" data-anchor-id="relations-between-prepostinitmeta-and-fixsigmeta">Relations between PrePostInitMeta and FixSigMeta</h3>
<hr>
</section>
<section id="prepostinitmeta-1" class="level3">
<h3 class="anchored" data-anchor-id="prepostinitmeta-1">PrePostInitMeta</h3>
<blockquote class="blockquote">
<pre><code> PrePostInitMeta (name, bases, dict)</code></pre>
</blockquote>
<p>A metaclass that calls optional <code>__pre_init__</code> and <code>__post_init__</code> methods</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(PrePostInitMeta) <span class="op">==</span> PrePostInitMeta.__class__ <span class="op">==</span> <span class="bu">type</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>PrePostInitMeta.__bases__ <span class="co"># so will inherit __new__, __init__ from FixSigMeta</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(__main__.FixSigMeta,)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>PrePostInitMeta.__mro__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(__main__.PrePostInitMeta, __main__.FixSigMeta, type, object)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>FixSigMeta.__mro__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>(__main__.FixSigMeta, type, object)</code></pre>
</div>
</div>
</section>
<section id="prepostinitmeta-examples" class="level3">
<h3 class="anchored" data-anchor-id="prepostinitmeta-examples"><a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#prepostinitmeta"><code>PrePostInitMeta</code></a> examples</h3>
<p>A metaclass that calls optional <code>__pre_init__</code> and <code>__post_init__</code> methods <code>__pre_init__</code> and <code>__post_init__</code> are useful for initializing variables or performing tasks prior to or after <code>__init__</code> being called, respectively. Fore example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># When creating an instance class by metaclass PrePostInitMeta, </span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="co"># PrePostInitMeta.__new__ is called, but PrePostInitMeta inherit __new__ from FixSigMeta</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="co"># so FixSigMeta.__new__ is actually called below</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="co"># _T is inherited from object and will use object.__new__ and object.__init__ </span></span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a><span class="co"># _T needs to create its own instance objects</span></span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true" tabindex="-1"></a><span class="co"># _T builts its own 3 instance methods which all related to __init__</span></span>
<span id="cb261-9"><a href="#cb261-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-10"><a href="#cb261-10" aria-hidden="true" tabindex="-1"></a><span class="co"># todo: export my debugging version of FixSigMeta to the library</span></span>
<span id="cb261-11"><a href="#cb261-11" aria-hidden="true" tabindex="-1"></a><span class="co"># todo: maybe the first problem of delegates do need attention</span></span>
<span id="cb261-12"><a href="#cb261-12" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> _T(metaclass<span class="op">=</span>PrePostInitMeta):</span>
<span id="cb261-13"><a href="#cb261-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">===============Running inside _T</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb261-14"><a href="#cb261-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> __pre_init__(<span class="va">self</span>):  </span>
<span id="cb261-15"><a href="#cb261-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"====Running inside _T.__pre_init__</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb261-16"><a href="#cb261-16" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.a  <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> </span>
<span id="cb261-17"><a href="#cb261-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,b<span class="op">=</span><span class="dv">0</span>):  </span>
<span id="cb261-18"><a href="#cb261-18" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.b <span class="op">=</span> <span class="va">self</span>.a <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">assert</span> <span class="va">self</span>.b<span class="op">==</span><span class="dv">1</span></span>
<span id="cb261-19"><a href="#cb261-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"====Running inside _T.__init__</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb261-20"><a href="#cb261-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> __post_init__(<span class="va">self</span>): </span>
<span id="cb261-21"><a href="#cb261-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.c <span class="op">=</span> <span class="va">self</span>.b <span class="op">+</span> <span class="dv">2</span><span class="op">;</span> <span class="cf">assert</span> <span class="va">self</span>.c<span class="op">==</span><span class="dv">3</span></span>
<span id="cb261-22"><a href="#cb261-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"====Running inside _T.__post_init__</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============Running inside _T

============================
running metaclass FixSigMeta.__new__

local variables are:

{'__class__': &lt;class '__main__.FixSigMeta'&gt;,
 'bases': (),
 'cls': &lt;class '__main__.PrePostInitMeta'&gt;,
 'dict': {'__init__': &lt;function _T.__init__&gt;,
          '__module__': '__main__',
          '__post_init__': &lt;function _T.__post_init__&gt;,
          '__pre_init__': &lt;function _T.__pre_init__&gt;,
          '__qualname__': '_T'},
 'name': '_T'}

Using type.__new__ to create a class instance of type: &lt;class '__main__._T'&gt;
"_T's type should and is: &lt;class '__main__.PrePostInitMeta'&gt;"

_T's inheritance tree: (&lt;class '__main__._T'&gt;, &lt;class 'object'&gt;)
In other words, _T's bases are: (&lt;class 'object'&gt;,)


does _T have attr `__signature__`:False
&lt;Signature (*args, **kwargs)&gt;
if _T has its own __init__, then update with __init__'s signature

now, _T.__signature__ becomes:(b=0)

end of metaclass FixSigMeta.__new__
============================</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># when _T is instantiated, _T's metaclass'__call__ (i.e., PrePostInitMeta.__call__) is called </span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="co"># _T.__class__.__call__ in general will use _T.__new__ and _T.__init__ </span></span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="co"># to create and initialize an instance object of _T.</span></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="co"># PrePostInitMeta.__call__: has a particular way of creating and initializing an object</span></span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a><span class="co"># using _T.__new__, _T.__init__, and _T.__pre_init__, _T.__post_init__ </span></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> _T() <span class="co"># only instantiate an object, to do so, PrePostInitMeta.__call__ is called</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==================
Running PrePostInitMeta.__call__

local variables:
{'args': (), 'cls': &lt;class '__main__._T'&gt;, 'kwargs': {}}

Task 1 running res = _T.__new__(cls) to create an obj instance of _T: &lt;__main__._T object&gt;

Task 2: 
if _T object is an instance of _T and _T has '__pre_init__' attr, then run _T.__pre_init__ on the object.
====Running inside _T.__pre_init__


Task 3: 
if _T object is an instance of _T, then run _T.__init__ on the object.
====Running inside _T.__init__


Task 4: 
if _T object is an instance of _T and _T has '__post_init__' attr, then run _T.__post_init__ on the object.
====Running inside _T.__post_init__


finally, return the initialized object of class _T
====================end of PrePostInitMeta.__call__</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>test_eq(t.a, <span class="dv">0</span>) <span class="co"># set with __pre_init__</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>test_eq(t.b, <span class="dv">1</span>) <span class="co"># set with __init__</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>test_eq(t.c, <span class="dv">3</span>) <span class="co"># set with __post_init__</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>how-prepostinitmeta: One use for PrePostInitMeta is avoiding the <strong>super</strong>().__init__() boilerplate associated with subclassing, such as used in AutoInit.</p>
</section>
</section>
<section id="section-7" class="level2">
<h2 class="anchored" data-anchor-id="section-7"></h2>
</section>
<section id="autoinit" class="level2">
<h2 class="anchored" data-anchor-id="autoinit"><a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#autoinit"><code>AutoInit</code></a></h2>
<p>how-super: a good <a href="https://stackoverflow.com/questions/576169/understanding-python-super-with-init-methods">answer</a> on <code>super</code> and a <a href="https://rhettinger.wordpress.com/2011/05/26/super-considered-super/">great guide</a>? and see <a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#prepostinitmeta"><code>PrePostInitMeta</code></a> and <a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#autoinit"><code>AutoInit</code></a> make it even better!</p>
<section id="autoinit-source" class="level3">
<h3 class="anchored" data-anchor-id="autoinit-source"><a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#autoinit"><code>AutoInit</code></a> source</h3>
<hr>
</section>
<section id="autoinit-1" class="level3">
<h3 class="anchored" data-anchor-id="autoinit-1">AutoInit</h3>
<blockquote class="blockquote">
<pre><code> AutoInit (*args, **kwargs)</code></pre>
</blockquote>
<p>Same as <code>object</code>, but no need for subclasses to call <code>super().__init__</code></p>
</section>
<section id="autoinit-examples" class="level3">
<h3 class="anchored" data-anchor-id="autoinit-examples"><a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#autoinit"><code>AutoInit</code></a> examples</h3>
<p>how-prepostinitmeta: in fastai <a href="https://github.com/fastai/fastai/search?q=PrePostInitMeta">code</a></p>
<p>how-autoinit: use <a href="https://EmbraceLife.github.io/debuggable/fastcoremeta.html#autoinit"><code>AutoInit</code></a> in real life. This is normally used as a mixin, eg:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TestParent():</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>): <span class="va">self</span>.h <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TestChild(AutoInit, TestParent): <span class="co"># how AutoInit used as mixin</span></span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"============Running inside TestChild class:</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>): </span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.k <span class="op">=</span> <span class="va">self</span>.h <span class="op">+</span> <span class="dv">2</span> <span class="co"># No More worry about super().__init__ </span></span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"====running TestChild.__init__</span><span class="ch">\n</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>============Running inside TestChild class:

============================
running metaclass FixSigMeta.__new__

local variables are:

{'__class__': &lt;class '__main__.FixSigMeta'&gt;,
 'bases': (&lt;class '__main__.AutoInit'&gt;, &lt;class '__main__.TestParent'&gt;),
 'cls': &lt;class '__main__.PrePostInitMeta'&gt;,
 'dict': {'__init__': &lt;function TestChild.__init__&gt;,
          '__module__': '__main__',
          '__qualname__': 'TestChild'},
 'name': 'TestChild'}

Using type.__new__ to create a class instance of type: &lt;class '__main__.TestChild'&gt;
"TestChild's type should and is: &lt;class '__main__.PrePostInitMeta'&gt;"

TestChild's inheritance tree: (&lt;class '__main__.TestChild'&gt;, &lt;class '__main__.AutoInit'&gt;, &lt;class '__main__.TestParent'&gt;, &lt;class 'object'&gt;)
In other words, TestChild's bases are: (&lt;class '__main__.AutoInit'&gt;, &lt;class '__main__.TestParent'&gt;)


does TestChild have attr `__signature__`:False
&lt;Signature (*args, **kwargs)&gt;
if TestChild has its own __init__, then update with __init__'s signature

now, TestChild.__signature__ becomes:()

end of metaclass FixSigMeta.__new__
============================</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> TestChild()</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>test_eq(t.h, <span class="dv">10</span>) <span class="co"># h=10 is initialized in the parent class</span></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>test_eq(t.k, <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==================
Running PrePostInitMeta.__call__

local variables:
{'args': (), 'cls': &lt;class '__main__.TestChild'&gt;, 'kwargs': {}}

Task 1 running res = TestChild.__new__(cls) to create an obj instance of TestChild: &lt;__main__.TestChild object&gt;

Task 2: 
if TestChild object is an instance of TestChild and TestChild has '__pre_init__' attr, then run TestChild.__pre_init__ on the object.

====Running inside AutoInit.__pre_init__: 

Now, object.__init__ is called to initialize, so that subclasses of AutoInit         not need to run this line of code.

Task 3: 
if TestChild object is an instance of TestChild, then run TestChild.__init__ on the object.
====running TestChild.__init__


Task 4: 
if TestChild object is an instance of TestChild and TestChild has '__post_init__' attr, then run TestChild.__post_init__ on the object.

finally, return the initialized object of class TestChild
====================end of PrePostInitMeta.__call__</code></pre>
</div>
</div>
<p>how-class: how-metaclass: a great answer on <a href="https://stackoverflow.com/questions/100003/what-are-metaclasses-in-python/6581949#6581949">class</a> and on <a href="https://hyp.is/Z7kBshlQEe25MUNPsjGP0w/stackoverflow.com/questions/100003/what-are-metaclasses-in-python">metaclass</a></p>
</section>
</section>
<section id="section-8" class="level2">
<h2 class="anchored" data-anchor-id="section-8"></h2>
</section>
<section id="section-9" class="level2">
<h2 class="anchored" data-anchor-id="section-9"></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>jupyter nbconvert <span class="op">--</span>config <span class="op">/</span>Users<span class="op">/</span>Natsume<span class="op">/</span>Documents<span class="op">/</span>mynbcfg.py <span class="op">--</span>to markdown <span class="op">\</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="op">--</span>output<span class="op">-</span><span class="bu">dir</span> <span class="op">/</span>Users<span class="op">/</span>Natsume<span class="op">/</span>Documents<span class="op">/</span>divefastai<span class="op">/</span>Debuggable<span class="op">/</span>nbconvert</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[NbConvertApp] Converting notebook /Users/Natsume/Documents/debuggable/index.ipynb to markdown
[NbConvertApp] Writing 7680 bytes to /Users/Natsume/Documents/divefastai/Debuggable/nbconvert/index.md
[NbConvertApp] Converting notebook /Users/Natsume/Documents/debuggable/utils.ipynb to markdown
[NbConvertApp] Writing 14526 bytes to /Users/Natsume/Documents/divefastai/Debuggable/nbconvert/utils.md
[NbConvertApp] Converting notebook /Users/Natsume/Documents/debuggable/fastcore/delegates_keep.ipynb to markdown
[NbConvertApp] Writing 11469 bytes to /Users/Natsume/Documents/divefastai/Debuggable/nbconvert/delegates_keep.md
[NbConvertApp] Converting notebook /Users/Natsume/Documents/debuggable/fastcore/00_delegates.ipynb to markdown
[NbConvertApp] Writing 69707 bytes to /Users/Natsume/Documents/divefastai/Debuggable/nbconvert/00_delegates.md
[NbConvertApp] Converting notebook /Users/Natsume/Documents/debuggable/fastcore/classes_metaclasses.ipynb to markdown
[NbConvertApp] Writing 27393 bytes to /Users/Natsume/Documents/divefastai/Debuggable/nbconvert/classes_metaclasses.md</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>