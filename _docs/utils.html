<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>debuggable - debuggable utils</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="debuggable - debuggable utils">
<meta property="og:description" content="Nice tutorial on how to use eval">
<meta property="og:site-name" content="debuggable">
<meta name="twitter:title" content="debuggable - debuggable utils">
<meta name="twitter:description" content="Nice tutorial on how to use eval">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">debuggable</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/EmbraceLife/debuggable/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">debuggable utils</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Fastai Debuggable</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./README.html" class="sidebar-item-text sidebar-link">Fastai Debuggable</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utils.html" class="sidebar-item-text sidebar-link active">debuggable utils</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">fastcore</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fastcore/classes_metaclasses.html" class="sidebar-item-text sidebar-link">classes and metaclasses</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">findings</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fastcore/findings/00F_delegates_keep.html" class="sidebar-item-text sidebar-link">Findings from <code>fastcore.meta.delegates</code></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">meta</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fastcore/meta/00_delegates.html" class="sidebar-item-text sidebar-link">fastcore.meta.delegates</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fastcore/meta/01_mk_param.html" class="sidebar-item-text sidebar-link">fastcore.meta._mk_param</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fastcore/meta/02_use_kwargs_dict.html" class="sidebar-item-text sidebar-link">fastcore.meta.use_kwargs_dict</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">previous</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fastcore/previous/fastcoremeta.html" class="sidebar-item-text sidebar-link">fastcore_meta</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#find-out-everything-about-a-module" id="toc-find-out-everything-about-a-module" class="nav-link active" data-scroll-target="#find-out-everything-about-a-module">Find out everything about a module</a>
  <ul class="collapse">
  <li><a href="#whatinside" id="toc-whatinside" class="nav-link" data-scroll-target="#whatinside">whatinside</a></li>
  </ul></li>
  <li><a href="#find-out-the-version-of-a-library" id="toc-find-out-the-version-of-a-library" class="nav-link" data-scroll-target="#find-out-the-version-of-a-library">Find out the version of a library</a>
  <ul class="collapse">
  <li><a href="#whichversion-source" id="toc-whichversion-source" class="nav-link" data-scroll-target="#whichversion-source"><span><code>whichversion</code></span> source</a></li>
  <li><a href="#whichversion" id="toc-whichversion" class="nav-link" data-scroll-target="#whichversion">whichversion</a>
  <ul class="collapse">
  <li><a href="#how-to-break-a-line-in-python-code" id="toc-how-to-break-a-line-in-python-code" class="nav-link" data-scroll-target="#how-to-break-a-line-in-python-code">How to break a line in python code</a></li>
  </ul></li>
  <li><a href="#whichversion-examples" id="toc-whichversion-examples" class="nav-link" data-scroll-target="#whichversion-examples"><span><code>whichversion</code></span> examples</a></li>
  </ul></li>
  <li><a href="#print-out-info-during-debugging" id="toc-print-out-info-during-debugging" class="nav-link" data-scroll-target="#print-out-info-during-debugging">print out info during debugging</a>
  <ul class="collapse">
  <li><a href="#dbprint-to-display-evalutaion" id="toc-dbprint-to-display-evalutaion" class="nav-link" data-scroll-target="#dbprint-to-display-evalutaion">dbprint to display evalutaion</a></li>
  <li><a href="#dbprint-to-handle-assignment-too" id="toc-dbprint-to-handle-assignment-too" class="nav-link" data-scroll-target="#dbprint-to-handle-assignment-too">dbprint to handle assignment too</a></li>
  <li><a href="#the-simple-working-version" id="toc-the-simple-working-version" class="nav-link" data-scroll-target="#the-simple-working-version">The simple working version</a></li>
  <li><a href="#a-working-version-but-slightly-longer" id="toc-a-working-version-but-slightly-longer" class="nav-link" data-scroll-target="#a-working-version-but-slightly-longer">A working version but slightly longer</a></li>
  <li><a href="#exec-and-evals-locals-has-priority-over-global" id="toc-exec-and-evals-locals-has-priority-over-global" class="nav-link" data-scroll-target="#exec-and-evals-locals-has-priority-over-global">exec and eval’s locals has priority over global</a></li>
  <li><a href="#a-trial-and-error-version" id="toc-a-trial-and-error-version" class="nav-link" data-scroll-target="#a-trial-and-error-version">A trial and error version</a></li>
  <li><a href="#to-differentiate-between-assignment-and-and" id="toc-to-differentiate-between-assignment-and-and" class="nav-link" data-scroll-target="#to-differentiate-between-assignment-and-and">to differentiate between assignment and != and ==</a></li>
  <li><a href="#handle-if-statement" id="toc-handle-if-statement" class="nav-link" data-scroll-target="#handle-if-statement">handle if statement</a></li>
  <li><a href="#handle-for-in-loop-and-in-block-printing" id="toc-handle-for-in-loop-and-in-block-printing" class="nav-link" data-scroll-target="#handle-for-in-loop-and-in-block-printing">Handle for in loop and in-block printing</a></li>
  <li><a href="#checksource" id="toc-checksource" class="nav-link" data-scroll-target="#checksource">checksource</a></li>
  <li><a href="#clean-up-the-format-for-readability" id="toc-clean-up-the-format-for-readability" class="nav-link" data-scroll-target="#clean-up-the-format-for-readability">clean up the format for readability</a></li>
  <li><a href="#add-a-few-more-caution-messages-for-avoiding-unnecessary-errors-in-using-dbprint" id="toc-add-a-few-more-caution-messages-for-avoiding-unnecessary-errors-in-using-dbprint" class="nav-link" data-scroll-target="#add-a-few-more-caution-messages-for-avoiding-unnecessary-errors-in-using-dbprint">Add a few more caution messages for avoiding unnecessary errors in using dbprint</a></li>
  <li><a href="#make-the-output-more-distinguishable-between-in-and-out-of-code-block" id="toc-make-the-output-more-distinguishable-between-in-and-out-of-code-block" class="nav-link" data-scroll-target="#make-the-output-more-distinguishable-between-in-and-out-of-code-block">Make the output more distinguishable between in and out of code block</a></li>
  <li><a href="#adding-features-to-handle-a-block-of-code-execution" id="toc-adding-features-to-handle-a-block-of-code-execution" class="nav-link" data-scroll-target="#adding-features-to-handle-a-block-of-code-execution">adding features to handle a block of code execution</a></li>
  <li><a href="#add-feature-to-print-out-source-code-in-both-line-and-block-to-the-right-end-of-the-page" id="toc-add-feature-to-print-out-source-code-in-both-line-and-block-to-the-right-end-of-the-page" class="nav-link" data-scroll-target="#add-feature-to-print-out-source-code-in-both-line-and-block-to-the-right-end-of-the-page">add feature to print out source code in both line and block to the right end of the page</a></li>
  <li><a href="#add-feature-if-abc-from-for-k-v-in-abc-is-empty-then-skip-the-current-iteration" id="toc-add-feature-if-abc-from-for-k-v-in-abc-is-empty-then-skip-the-current-iteration" class="nav-link" data-scroll-target="#add-feature-if-abc-from-for-k-v-in-abc-is-empty-then-skip-the-current-iteration">add feature: if <code>abc</code> from <code>for k, v in abc:</code> is empty, then skip the current iteration</a></li>
  <li><a href="#nicer-output-spacing" id="toc-nicer-output-spacing" class="nav-link" data-scroll-target="#nicer-output-spacing">nicer output spacing</a></li>
  <li><a href="#print-output-left-and-right-reverted" id="toc-print-output-left-and-right-reverted" class="nav-link" data-scroll-target="#print-output-left-and-right-reverted">print output left and right reverted</a></li>
  <li><a href="#add-feature-print-out-the-entire-source-code-and-use-to-mark-the-source-code-line-at-debugging" id="toc-add-feature-print-out-the-entire-source-code-and-use-to-mark-the-source-code-line-at-debugging" class="nav-link" data-scroll-target="#add-feature-print-out-the-entire-source-code-and-use-to-mark-the-source-code-line-at-debugging">add feature: print out the entire source code and use ====== to mark the source code line at debugging</a></li>
  <li><a href="#defaults.block-is-no-longer-needed-i-think" id="toc-defaults.block-is-no-longer-needed-i-think" class="nav-link" data-scroll-target="#defaults.block-is-no-longer-needed-i-think">defaults.block is no longer needed I think</a></li>
  <li><a href="#add-features-to-colorize-question-feature-and-comment" id="toc-add-features-to-colorize-question-feature-and-comment" class="nav-link" data-scroll-target="#add-features-to-colorize-question-feature-and-comment">add features to colorize question, feature and comment</a></li>
  </ul></li>
  <li><a href="#alignright-a-block-of-codes" id="toc-alignright-a-block-of-codes" class="nav-link" data-scroll-target="#alignright-a-block-of-codes">Alignright a block of codes</a>
  <ul class="collapse">
  <li><a href="#alignright" id="toc-alignright" class="nav-link" data-scroll-target="#alignright">alignright</a></li>
  <li><a href="#dbcolors" id="toc-dbcolors" class="nav-link" data-scroll-target="#dbcolors">dbcolors</a></li>
  <li><a href="#colorize" id="toc-colorize" class="nav-link" data-scroll-target="#colorize">colorize</a></li>
  <li><a href="#add-feature-when-handling-assignment-2.-when-occur-before-if-1.-when-no-if-only" id="toc-add-feature-when-handling-assignment-2.-when-occur-before-if-1.-when-no-if-only" class="nav-link" data-scroll-target="#add-feature-when-handling-assignment-2.-when-occur-before-if-1.-when-no-if-only">add feature when handling assignment: 2. when = occur before if; 1. when no if only =</a></li>
  <li><a href="#alignright-the-colored-comment" id="toc-alignright-the-colored-comment" class="nav-link" data-scroll-target="#alignright-the-colored-comment">alignright the colored comment</a></li>
  <li><a href="#dbprint" id="toc-dbprint" class="nav-link" data-scroll-target="#dbprint">dbprint</a></li>
  </ul></li>
  <li><a href="#insert-dbprint-and-make-a-new-source-function-for-debugging-line-by-line" id="toc-insert-dbprint-and-make-a-new-source-function-for-debugging-line-by-line" class="nav-link" data-scroll-target="#insert-dbprint-and-make-a-new-source-function-for-debugging-line-by-line">insert dbprint and make a new source function for debugging line by line</a>
  <ul class="collapse">
  <li><a href="#remove-return-none-so-that-we-can-run-multiple-delegates-in-one-cell-without-error" id="toc-remove-return-none-so-that-we-can-run-multiple-delegates-in-one-cell-without-error" class="nav-link" data-scroll-target="#remove-return-none-so-that-we-can-run-multiple-delegates-in-one-cell-without-error">remove <code>return None</code>, so that we can run multiple <code>delegates</code> in one cell without error</a></li>
  <li><a href="#major-problems-solved" id="toc-major-problems-solved" class="nav-link" data-scroll-target="#major-problems-solved">major problems solved</a></li>
  <li><a href="#debugging-error" id="toc-debugging-error" class="nav-link" data-scroll-target="#debugging-error">debugging error</a></li>
  <li><a href="#insert2debug" id="toc-insert2debug" class="nav-link" data-scroll-target="#insert2debug">insert2debug</a></li>
  </ul></li>
  <li><a href="#exporting-the-debuggable-source-and-major-problems-solved" id="toc-exporting-the-debuggable-source-and-major-problems-solved" class="nav-link" data-scroll-target="#exporting-the-debuggable-source-and-major-problems-solved">Exporting the debuggable source and major problems solved</a>
  <ul class="collapse">
  <li><a href="#improve-the-print-feature-of-dbscrlines" id="toc-improve-the-print-feature-of-dbscrlines" class="nav-link" data-scroll-target="#improve-the-print-feature-of-dbscrlines">improve the print feature of dbscrlines</a></li>
  <li><a href="#add-return-to-the-last-dbcode-for-debugging-examples-which-cause-errors" id="toc-add-return-to-the-last-dbcode-for-debugging-examples-which-cause-errors" class="nav-link" data-scroll-target="#add-return-to-the-last-dbcode-for-debugging-examples-which-cause-errors">add return to the last dbcode for debugging examples which cause errors</a></li>
  <li><a href="#dbsrclines" id="toc-dbsrclines" class="nav-link" data-scroll-target="#dbsrclines">dbsrclines</a></li>
  </ul></li>
  <li><a href="#check-official-source-against-debuggable-source" id="toc-check-official-source-against-debuggable-source" class="nav-link" data-scroll-target="#check-official-source-against-debuggable-source">check official source against debuggable source</a>
  <ul class="collapse">
  <li><a href="#add-markers-and-raise-error-when-there-is-update-of-the-srcode" id="toc-add-markers-and-raise-error-when-there-is-update-of-the-srcode" class="nav-link" data-scroll-target="#add-markers-and-raise-error-when-there-is-update-of-the-srcode">Add markers and raise error when there is update of the srcode</a></li>
  <li><a href="#checksrc" id="toc-checksrc" class="nav-link" data-scroll-target="#checksrc">checksrc</a></li>
  <li><a href="#strip_ansi" id="toc-strip_ansi" class="nav-link" data-scroll-target="#strip_ansi">strip_ansi</a></li>
  <li><a href="#alignright-1" id="toc-alignright-1" class="nav-link" data-scroll-target="#alignright-1">alignright</a></li>
  </ul></li>
  <li><a href="#how-to-shuffle" id="toc-how-to-shuffle" class="nav-link" data-scroll-target="#how-to-shuffle">How to shuffle</a>
  <ul class="collapse">
  <li><a href="#matchsrcorder" id="toc-matchsrcorder" class="nav-link" data-scroll-target="#matchsrcorder">matchsrcorder</a></li>
  </ul></li>
  <li><a href="#display-official-source-code-with-index-markers" id="toc-display-official-source-code-with-index-markers" class="nav-link" data-scroll-target="#display-official-source-code-with-index-markers">display official source code with index markers</a>
  <ul class="collapse">
  <li><a href="#add-index-marker-for-debuggable-source-lines" id="toc-add-index-marker-for-debuggable-source-lines" class="nav-link" data-scroll-target="#add-index-marker-for-debuggable-source-lines">add index marker for debuggable source lines</a></li>
  <li><a href="#marking-the-debuggable-srcline-with-its-own-index" id="toc-marking-the-debuggable-srcline-with-its-own-index" class="nav-link" data-scroll-target="#marking-the-debuggable-srcline-with-its-own-index">Marking the debuggable srcline with its own index</a></li>
  <li><a href="#displaysrc" id="toc-displaysrc" class="nav-link" data-scroll-target="#displaysrc">displaysrc</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/EmbraceLife/debuggable/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">debuggable utils</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="find-out-everything-about-a-module" class="level2">
<h2 class="anchored" data-anchor-id="find-out-everything-about-a-module">Find out everything about a module</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fastcore.meta <span class="im">as</span> fm</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fastai.basics <span class="im">as</span> fb</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nbdev.showdoc <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="whatinside" class="level3">
<h3 class="anchored" data-anchor-id="whatinside">whatinside</h3>
<blockquote class="blockquote">
<pre><code> whatinside (mo, dun:bool=False, func:bool=False, clas:bool=False,
             bltin:bool=False, lib:bool=False, cal:bool=False)</code></pre>
</blockquote>
<p>Check what inside a module: <strong>all</strong>, functions, classes, builtins, and callables</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>mo</td>
<td></td>
<td></td>
<td>module, e.g., <code>import fastcore.all as fa</code>, use <code>fa</code> here</td>
</tr>
<tr class="even">
<td>dun</td>
<td>bool</td>
<td>False</td>
<td>print all items in <strong>all</strong></td>
</tr>
<tr class="odd">
<td>func</td>
<td>bool</td>
<td>False</td>
<td>print all user defined functions</td>
</tr>
<tr class="even">
<td>clas</td>
<td>bool</td>
<td>False</td>
<td>print all class objects</td>
</tr>
<tr class="odd">
<td>bltin</td>
<td>bool</td>
<td>False</td>
<td>print all builtin funcs or methods</td>
</tr>
<tr class="even">
<td>lib</td>
<td>bool</td>
<td>False</td>
<td>print all the modules of the library it belongs to</td>
</tr>
<tr class="odd">
<td>cal</td>
<td>bool</td>
<td>False</td>
<td>print all callables</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> whatinside(mo, <span class="co"># module, e.g., `import fastcore.all as fa`, use `fa` here</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               dun:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># print all items in __all__</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               func:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># print all user defined functions</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               clas:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># print all class objects</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>               bltin:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># print all builtin funcs or methods</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>               lib:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># print all the modules of the library it belongs to</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>               cal:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span> <span class="co"># print all callables</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>             ): </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">'Check what inside a module: __all__, functions, classes, builtins, and callables'</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    dun_all <span class="op">=</span> <span class="bu">len</span>(mo.__all__) <span class="cf">if</span> <span class="bu">hasattr</span>(mo, <span class="st">"__all__"</span>) <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    funcs <span class="op">=</span> getmembers(mo, isfunction)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    classes <span class="op">=</span> getmembers(mo, isclass)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    builtins <span class="op">=</span> getmembers(mo, isbuiltin)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    callables <span class="op">=</span> getmembers(mo, <span class="bu">callable</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    pkgpath <span class="op">=</span> os.path.dirname(mo.<span class="va">__file__</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>mo<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss"> has: </span><span class="ch">\n</span><span class="sc">{</span>dun_all<span class="sc">}</span><span class="ss"> items in its __all__, and </span><span class="ch">\n</span><span class="sc">{</span><span class="bu">len</span>(funcs)<span class="sc">}</span><span class="ss"> user defined functions, </span><span class="ch">\n</span><span class="sc">{</span><span class="bu">len</span>(classes)<span class="sc">}</span><span class="ss"> classes or class objects, </span><span class="ch">\n</span><span class="sc">{</span><span class="bu">len</span>(builtins)<span class="sc">}</span><span class="ss"> builtin funcs and methods, and</span><span class="ch">\n</span><span class="sc">{</span><span class="bu">len</span>(callables)<span class="sc">}</span><span class="ss"> callables.</span><span class="ch">\n</span><span class="ss">"</span>)  </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">hasattr</span>(mo, <span class="st">"__all__"</span>) <span class="kw">and</span> dun: pprint(mo.__all__)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> func: </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'The user defined functions are:'</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        pprint([i[<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> funcs])</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> clas: </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'The class objects are:'</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        pprint([i[<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> classes])</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> bltin: </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'The builtin functions or methods are:'</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        pprint([i[<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> builtins])</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cal: </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'The callables are: '</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        pprint([i[<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> callables])</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> lib: </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>        modules <span class="op">=</span> [name <span class="cf">for</span> _, name, _ <span class="kw">in</span> pkgutil.iter_modules([pkgpath])]</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'The library has </span><span class="sc">{</span><span class="bu">len</span>(modules)<span class="sc">}</span><span class="ss"> modules'</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        pprint(modules)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>whatinside(fm, func<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fastcore.meta has: 
13 items in its __all__, and 
43 user defined functions, 
19 classes or class objects, 
2 builtin funcs and methods, and
74 callables.

The user defined functions are:
['_funcs_kwargs',
 '_mk_param',
 '_rm_self',
 'all_equal',
 'anno_dict',
 'any_is_instance',
 'array_equal',
 'contextmanager',
 'copy',
 'delegates',
 'df_equal',
 'empty2none',
 'equals',
 'funcs_kwargs',
 'in_colab',
 'in_ipython',
 'in_jupyter',
 'in_notebook',
 'ipython_shell',
 'is_close',
 'is_coll',
 'is_iter',
 'isinstance_str',
 'method',
 'nequals',
 'noop',
 'noops',
 'remove_prefix',
 'remove_suffix',
 'test',
 'test_close',
 'test_eq',
 'test_eq_type',
 'test_fail',
 'test_fig_exists',
 'test_is',
 'test_ne',
 'test_shuffled',
 'test_sig',
 'test_stdout',
 'test_warns',
 'use_kwargs',
 'use_kwargs_dict']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>whatinside(fb, bltin<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fastai.basics has: 
0 items in its __all__, and 
430 user defined functions, 
237 classes or class objects, 
4 builtin funcs and methods, and
696 callables.

The builtin functions or methods are:
['array', 'as_tensor', 'reduce', 'warn']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>whatinside(fb, lib<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fastai.basics has: 
0 items in its __all__, and 
430 user defined functions, 
237 classes or class objects, 
4 builtin funcs and methods, and
696 callables.

The library has 24 modules
['_modidx',
 '_nbdev',
 '_pytorch_doc',
 'basics',
 'callback',
 'collab',
 'data',
 'distributed',
 'fp16_utils',
 'imports',
 'interpret',
 'layers',
 'learner',
 'losses',
 'medical',
 'metrics',
 'optimizer',
 'tabular',
 'test_utils',
 'text',
 'torch_basics',
 'torch_core',
 'torch_imports',
 'vision']</code></pre>
</div>
</div>
</section>
</section>
<section id="find-out-the-version-of-a-library" class="level2">
<h2 class="anchored" data-anchor-id="find-out-the-version-of-a-library">Find out the version of a library</h2>
<section id="whichversion-source" class="level3">
<h3 class="anchored" data-anchor-id="whichversion-source"><a href="https://EmbraceLife.github.io/debuggable/utils.html#whichversion"><code>whichversion</code></a> source</h3>
<hr>
</section>
<section id="whichversion" class="level3">
<h3 class="anchored" data-anchor-id="whichversion">whichversion</h3>
<blockquote class="blockquote">
<pre><code> whichversion (libname:str, req:bool=False, file:bool=False)</code></pre>
</blockquote>
<p>Give you library version and other basic info.</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>libname</td>
<td>str</td>
<td></td>
<td>library name</td>
</tr>
<tr class="even">
<td>req</td>
<td>bool</td>
<td>False</td>
<td>print lib requirements</td>
</tr>
<tr class="odd">
<td>file</td>
<td>bool</td>
<td>False</td>
<td>print all lib files</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pprint(getsource(whichversion))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>('def whichversion(libname:str, # library name\n'
 '                req:bool=False, # print lib requirements \n'
 '                file:bool=False): # print all lib files\n'
 '    "Give you library version and other basic info."\n'
 "    if libname=='python':\n"
 '        print(f"python: {python_version()}")\n'
 '    else: \n'
 '        print(f"{metadata(libname)[\'Name\']}: {version(libname)} '
 "\\n{metadata(libname)['Summary']}\\\n"
 "    \\n{metadata(libname)['Author']} \\n{metadata(libname)['Home-page']} \\\n"
 "    \\npython_version: {metadata(libname)['Requires-Python']} \\\n"
 '    \\n{distribution(libname).locate_file(libname)}")\n'
 '\n'
 '    if req: \n'
 '        print(f"\\n{libname} requires: ")\n'
 '        pprint(distribution(libname).requires)\n'
 '    if file: \n'
 '        print(f"\\n{libname} has: ")\n'
 '        pprint(distribution(libname).files)\n')</code></pre>
</div>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> importlib.metadata <span class="im">import</span> version, metadata, distribution</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> platform <span class="im">import</span> python_version </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> whichversion(libname:<span class="bu">str</span>, <span class="co"># library name</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                req:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, <span class="co"># print lib requirements </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                <span class="bu">file</span>:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>): <span class="co"># print all lib files</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Give you library version and other basic info."</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> libname<span class="op">==</span><span class="st">'python'</span>:</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"python: </span><span class="sc">{</span>python_version()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>metadata(libname)[<span class="st">'Name'</span>]<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>version(libname)<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="sc">{</span>metadata(libname)[<span class="st">'Summary'</span>]<span class="sc">}</span><span class="ch">\</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span><span class="ch">\n</span><span class="sc">{</span>metadata(libname)[<span class="st">'Author'</span>]<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="sc">{</span>metadata(libname)[<span class="st">'Home-page'</span>]<span class="sc">}</span><span class="ss"> </span><span class="ch">\</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span><span class="ch">\n</span><span class="ss">python_version: </span><span class="sc">{</span>metadata(libname)[<span class="st">'Requires-Python'</span>]<span class="sc">}</span><span class="ss"> </span><span class="ch">\</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span><span class="ch">\n</span><span class="sc">{</span>distribution(libname)<span class="sc">.</span>locate_file(libname)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> req: </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>libname<span class="sc">}</span><span class="ss"> requires: "</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        pprint(distribution(libname).requires)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">file</span>: </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>libname<span class="sc">}</span><span class="ss"> has: "</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        pprint(distribution(libname).files)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="how-to-break-a-line-in-python-code" class="level4">
<h4 class="anchored" data-anchor-id="how-to-break-a-line-in-python-code">How to break a line in python code</h4>
<p>see the code above</p>
</section>
</section>
<section id="whichversion-examples" class="level3">
<h3 class="anchored" data-anchor-id="whichversion-examples"><a href="https://EmbraceLife.github.io/debuggable/utils.html#whichversion"><code>whichversion</code></a> examples</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>whichversion(<span class="st">'python'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>python: 3.9.13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>whichversion(<span class="st">'fastcore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>fastcore: 1.5.22 
Python supercharged for fastai development    
Jeremy Howard and Sylvain Gugger 
https://github.com/fastai/fastcore/     
python_version: &gt;=3.7     
/Users/Natsume/mambaforge/lib/python3.9/site-packages/fastcore</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>whichversion(<span class="st">'nbdev'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>nbdev: 2.2.6 
Create delightful software with Jupyter Notebooks    
Jeremy Howard and Hamel Husain 
https://github.com/fastai/nbdev     
python_version: &gt;=3.7     
/Users/Natsume/mambaforge/lib/python3.9/site-packages/nbdev</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>whichversion(<span class="st">'nbdev'</span>, req<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>nbdev: 2.2.6 
Create delightful software with Jupyter Notebooks    
Jeremy Howard and Hamel Husain 
https://github.com/fastai/nbdev     
python_version: &gt;=3.7     
/Users/Natsume/mambaforge/lib/python3.9/site-packages/nbdev

nbdev requires: 
['fastcore (&gt;=1.5.19)',
 'execnb (&gt;=0.0.10)',
 'astunparse',
 'ghapi',
 'PyYAML',
 'asttokens ; python_version=="3.7"',
 "nbdev-numpy ; extra == 'dev'",
 "nbdev-stdlib ; extra == 'dev'",
 "pandas ; extra == 'dev'",
 "matplotlib ; extra == 'dev'",
 "black ; extra == 'dev'"]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>whichversion(<span class="st">'nbdev'</span>, <span class="bu">file</span><span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>nbdev: 2.2.6 
Create delightful software with Jupyter Notebooks    
Jeremy Howard and Hamel Husain 
https://github.com/fastai/nbdev     
python_version: &gt;=3.7     
/Users/Natsume/mambaforge/lib/python3.9/site-packages/nbdev

nbdev has: 
[PackagePath('../../../bin/nbdev_bump_version'),
 PackagePath('../../../bin/nbdev_changelog'),
 PackagePath('../../../bin/nbdev_clean'),
 PackagePath('../../../bin/nbdev_conda'),
 PackagePath('../../../bin/nbdev_create_config'),
 PackagePath('../../../bin/nbdev_deploy'),
 PackagePath('../../../bin/nbdev_docs'),
 PackagePath('../../../bin/nbdev_export'),
 PackagePath('../../../bin/nbdev_filter'),
 PackagePath('../../../bin/nbdev_fix'),
 PackagePath('../../../bin/nbdev_help'),
 PackagePath('../../../bin/nbdev_install'),
 PackagePath('../../../bin/nbdev_install_hooks'),
 PackagePath('../../../bin/nbdev_install_quarto'),
 PackagePath('../../../bin/nbdev_merge'),
 PackagePath('../../../bin/nbdev_migrate'),
 PackagePath('../../../bin/nbdev_new'),
 PackagePath('../../../bin/nbdev_prepare'),
 PackagePath('../../../bin/nbdev_preview'),
 PackagePath('../../../bin/nbdev_pypi'),
 PackagePath('../../../bin/nbdev_quarto'),
 PackagePath('../../../bin/nbdev_readme'),
 PackagePath('../../../bin/nbdev_release_both'),
 PackagePath('../../../bin/nbdev_release_gh'),
 PackagePath('../../../bin/nbdev_release_git'),
 PackagePath('../../../bin/nbdev_sidebar'),
 PackagePath('../../../bin/nbdev_test'),
 PackagePath('../../../bin/nbdev_trust'),
 PackagePath('../../../bin/nbdev_update'),
 PackagePath('nbdev-2.2.6.dist-info/INSTALLER'),
 PackagePath('nbdev-2.2.6.dist-info/LICENSE'),
 PackagePath('nbdev-2.2.6.dist-info/METADATA'),
 PackagePath('nbdev-2.2.6.dist-info/RECORD'),
 PackagePath('nbdev-2.2.6.dist-info/REQUESTED'),
 PackagePath('nbdev-2.2.6.dist-info/WHEEL'),
 PackagePath('nbdev-2.2.6.dist-info/entry_points.txt'),
 PackagePath('nbdev-2.2.6.dist-info/top_level.txt'),
 PackagePath('nbdev/__init__.py'),
 PackagePath('nbdev/__pycache__/__init__.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/_modidx.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/clean.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/cli.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/config.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/doclinks.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/export.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/extract_attachments.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/frontmatter.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/imports.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/maker.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/merge.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/migrate.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/mkdocs.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/process.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/processors.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/qmd.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/quarto.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/release.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/showdoc.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/sync.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/test.cpython-39.pyc'),
 PackagePath('nbdev/__pycache__/tutorial.cpython-39.pyc'),
 PackagePath('nbdev/_modidx.py'),
 PackagePath('nbdev/clean.py'),
 PackagePath('nbdev/cli.py'),
 PackagePath('nbdev/config.py'),
 PackagePath('nbdev/doclinks.py'),
 PackagePath('nbdev/export.py'),
 PackagePath('nbdev/extract_attachments.py'),
 PackagePath('nbdev/frontmatter.py'),
 PackagePath('nbdev/imports.py'),
 PackagePath('nbdev/maker.py'),
 PackagePath('nbdev/merge.py'),
 PackagePath('nbdev/migrate.py'),
 PackagePath('nbdev/mkdocs.py'),
 PackagePath('nbdev/process.py'),
 PackagePath('nbdev/processors.py'),
 PackagePath('nbdev/qmd.py'),
 PackagePath('nbdev/quarto.py'),
 PackagePath('nbdev/release.py'),
 PackagePath('nbdev/showdoc.py'),
 PackagePath('nbdev/sync.py'),
 PackagePath('nbdev/test.py'),
 PackagePath('nbdev/tutorial.py')]</code></pre>
</div>
</div>
</section>
</section>
<section id="print-out-info-during-debugging" class="level2">
<h2 class="anchored" data-anchor-id="print-out-info-during-debugging">print out info during debugging</h2>
<p>Nice <a href="https://realpython.com/python-eval-function/">tutorial</a> on how to use <code>eval</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span> eval<span class="ansi-blue-fg">(</span>source<span class="ansi-blue-fg">,</span> globals<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> locals<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">/</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Evaluate the given source in the context of globals and locals.
The source may be a string representing a Python expression
or a code object as returned by compile().
The globals must be a dictionary and locals can be any mapping,
defaulting to the current globals and locals.
If only globals is given, locals defaults to it.
<span class="ansi-red-fg">Type:</span>      builtin_function_or_method
</pre>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span> exec<span class="ansi-blue-fg">(</span>source<span class="ansi-blue-fg">,</span> globals<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> locals<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">/</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Execute the given source in the context of globals and locals.
The source may be a string representing one or more Python statements
or a code object as returned by compile().
The globals must be a dictionary and locals can be any mapping,
defaulting to the current globals and locals.
If only globals is given, locals defaults to it.
<span class="ansi-red-fg">Type:</span>      builtin_function_or_method
</pre>
</div>
</div>
</div>
<section id="dbprint-to-display-evalutaion" class="level3">
<h3 class="anchored" data-anchor-id="dbprint-to-display-evalutaion">dbprint to display evalutaion</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(name:<span class="bu">str</span>, <span class="op">*</span>code, <span class="op">**</span>env):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:=============================="</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"="</span> <span class="kw">in</span> c:</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">"="</span>)[<span class="dv">0</span>]</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(c, {}, {<span class="op">**</span>env})<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b<span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>from_f <span class="op">=</span> mid</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>to_f <span class="op">=</span> low</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"getattr(from_f,'__func__',from_f)"</span>, <span class="st">"k = hasattr(from_f, '__func__')"</span>, <span class="st">"hasattr(to_f, '__func__')"</span>, <span class="st">"to_f"</span>, <span class="st">"from_f"</span>, from_f<span class="op">=</span>from_f, to_f<span class="op">=</span>to_f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
getattr(from_f,'__func__',from_f):==============================
k = hasattr(from_f, '__func__') =&gt; k : False
hasattr(to_f, '__func__'): False
to_f: &lt;function low&gt;
from_f: &lt;function mid&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test():</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> t1(): <span class="cf">pass</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> t2(): <span class="cf">pass</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    from_f <span class="op">=</span> t1</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    to_f <span class="op">=</span> t2</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    dbprint(<span class="st">"getattr(from_f,'__func__',from_f)"</span>, <span class="st">"hasattr(from_f, '__func__')"</span>, <span class="st">"hasattr(to_f, '__func__')"</span>, <span class="st">"to_f"</span>, <span class="st">"from_f"</span>, from_f<span class="op">=</span>from_f, to_f<span class="op">=</span>to_f)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>test()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
getattr(from_f,'__func__',from_f):==============================
hasattr(from_f, '__func__'): False
hasattr(to_f, '__func__'): False
to_f: &lt;function test.&lt;locals&gt;.t2&gt;
from_f: &lt;function test.&lt;locals&gt;.t1&gt;</code></pre>
</div>
</div>
</section>
<section id="dbprint-to-handle-assignment-too" class="level3">
<h3 class="anchored" data-anchor-id="dbprint-to-handle-assignment-too">dbprint to handle assignment too</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">"="</span> <span class="kw">in</span> <span class="st">"a = 1"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> <span class="op">*</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"print(dir())"</span>, <span class="bu">globals</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['AutoInit', 'BasicHtmlRenderer', 'BasicMarkdownRenderer', 'BuiltinFunctionType', 'BuiltinMethodType', 'BypassNewMeta', 'Dict', 'DocmentTbl', 'FixSigMeta', 'FunctionType', 'Generator', 'IN_COLAB', 'IN_IPYTHON', 'IN_JUPYTER', 'IN_NOTEBOOK', 'In', 'Iterable', 'Iterator', 'List', 'MethodDescriptorType', 'MethodType', 'MethodWrapperType', 'NewChkMeta', 'NoneType', 'Optional', 'Out', 'Path', 'PrePostInitMeta', 'Sequence', 'Set', 'ShowDocRenderer', 'SimpleNamespace', 'Tuple', 'Union', 'WrapperDescriptorType', '_', '__', '___', '__builtin__', '__builtins__', '__doc__', '__loader__', '__name__', '__package__', '__spec__', '_dh', '_ih', '_oh', 'acos', 'acosh', 'all_equal', 'anno_dict', 'any_is_instance', 'array_equal', 'asin', 'asinh', 'ast', 'atan', 'atan2', 'atanh', 'attrgetter', 'ceil', 'colab_link', 'comb', 'copysign', 'cos', 'cosh', 'degrees', 'delegates', 'df_equal', 'dist', 'distribution', 'doc', 'e', 'empty2none', 'enum', 'equals', 'erf', 'erfc', 'exit', 'exp', 'expm1', 'fabs', 'factorial', 'fb', 'floor', 'fm', 'fmod', 'frexp', 'fsum', 'funcs_kwargs', 'functools', 'gamma', 'gcd', 'get_ipython', 'getmembers', 'getsource', 'hypot', 'in_colab', 'in_ipython', 'in_jupyter', 'in_notebook', 'inf', 'inspect', 'io', 'ipython_shell', 'is_coll', 'is_iter', 'isbuiltin', 'isclass', 'isclose', 'isfinite', 'isfunction', 'isinf', 'isinstance_str', 'isnan', 'isqrt', 'itemgetter', 'itertools', 'lcm', 'ldexp', 'lgamma', 'log', 'log10', 'log1p', 'log2', 'math', 'metadata', 'method', 'modf', 'nan', 'nextafter', 'noop', 'noops', 'operator', 'os', 'partial', 'perm', 'pi', 'pkgutil', 'pow', 'pprint', 'prod', 'python_version', 'quit', 'radians', 're', 'reduce', 'remainder', 'remove_prefix', 'remove_suffix', 'show_doc', 'showdoc_nm', 'sin', 'sinh', 'sqrt', 'string_classes', 'sys', 'tan', 'tanh', 'tau', 'test_sig', 'trunc', 'typing', 'ulp', 'use_kwargs', 'use_kwargs_dict', 'version', 'warn', 'warnings', 'whatinside', 'whichversion']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> <span class="op">*</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"print(dir())"</span>, {}, {<span class="st">"sum"</span>: <span class="bu">sum</span>, <span class="st">"print"</span>: <span class="bu">print</span>, <span class="st">"dir"</span>: <span class="bu">dir</span>, <span class="st">"c"</span>: <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['c', 'dir', 'print', 'sum']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> <span class="op">*</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"print(dir())"</span>, {<span class="st">"__builtins__"</span> : __builtin__}, {<span class="st">"sum"</span>: <span class="bu">sum</span>, <span class="st">"print"</span>: <span class="bu">print</span>, <span class="st">"dir"</span>: <span class="bu">dir</span>, <span class="st">"c"</span>: <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['c', 'dir', 'print', 'sum']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> <span class="op">*</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"print(dir())"</span>, <span class="bu">globals</span>(), {<span class="st">"sum"</span>: <span class="bu">sum</span>, <span class="st">"print"</span>: <span class="bu">print</span>, <span class="st">"dir"</span>: <span class="bu">dir</span>, <span class="st">"c"</span>: <span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['c', 'dir', 'print', 'sum']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"e = 2 + 4"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"e"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"c = 2 + 9"</span>, <span class="bu">globals</span>())</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>11</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"d = 2 + 10"</span>, <span class="bu">globals</span>(), <span class="bu">locals</span>())</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>12</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"z = 2 + g"</span>, <span class="bu">globals</span>(), <span class="bu">locals</span>().update({<span class="st">'g'</span>:<span class="dv">3</span>}))</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"z"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"c = 2 + f"</span>, <span class="bu">globals</span>(), {<span class="st">'f'</span>:<span class="dv">3</span>})</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>11</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"c = 2 + f"</span>, <span class="bu">globals</span>(), <span class="bu">locals</span>().update({<span class="st">'f'</span>:<span class="dv">3</span>}))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"c = 2 + f"</span>, <span class="bu">globals</span>().update({<span class="st">'f'</span>:<span class="dv">4</span>}), <span class="bu">locals</span>())</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"print (dir())"</span>,{})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['__builtins__']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span> (<span class="st">"print (dir())"</span>,{}, {<span class="st">'a'</span>:<span class="dv">1</span>, <span class="st">'b'</span>:<span class="dv">2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['a', 'b']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span> (<span class="st">"print (dir())"</span>, {<span class="st">'c'</span>:<span class="dv">3</span>}, {<span class="st">'a'</span>:<span class="dv">1</span>, <span class="st">'b'</span>:<span class="dv">2</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['a', 'b']</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">'f'</span> <span class="kw">in</span> <span class="bu">locals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="bu">locals</span>().update({<span class="st">'f'</span>:<span class="dv">1</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">'f'</span> <span class="kw">in</span> <span class="bu">locals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="the-simple-working-version" class="level3">
<h3 class="anchored" data-anchor-id="the-simple-working-version">The simple working version</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(name:<span class="bu">str</span>, <span class="op">*</span>code, <span class="op">**</span>env):</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:=============================="</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"="</span> <span class="kw">in</span> c: <span class="co"># updated to handle assignment</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>(), <span class="bu">locals</span>().update(env)) </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">"="</span>)[<span class="dv">0</span>]</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(c, {}, {<span class="op">**</span>env})<span class="sc">}</span><span class="ss">"</span>) <span class="co"># working version</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(name:<span class="bu">str</span>, <span class="op">*</span>code, <span class="op">**</span>env):</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:=============================="</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"="</span> <span class="kw">in</span> c: <span class="co"># updated to handle assignment</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>(), <span class="bu">locals</span>().update(env)) </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">"="</span>)[<span class="dv">0</span>]</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>(), <span class="bu">locals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) <span class="co"># problematic</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c}: {eval(c, globals().update(env), locals().update(env))}")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>string <span class="op">=</span> <span class="st">"string"</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"test assignment with exec and eval"</span>, <span class="st">"k = 1 + 2 + a"</span>, a <span class="op">=</span> a, string<span class="op">=</span>string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
test assignment with exec and eval:==============================
k = 1 + 2 + a =&gt; k : 13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>string <span class="op">=</span> <span class="st">"string"</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"test assignment with exec and eval"</span>, <span class="st">"1 + 2 + a"</span>, a <span class="op">=</span> a, string<span class="op">=</span>string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
test assignment with exec and eval:==============================
1 + 2 + a: 13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test():</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> t1(): <span class="cf">pass</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> t2(): <span class="cf">pass</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    from_f <span class="op">=</span> t1</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    to_f <span class="op">=</span> t2</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    dbprint(<span class="st">"getattr(from_f,'__func__',from_f)"</span>, <span class="st">"hasattr(from_f, '__func__')"</span>, <span class="st">"hasattr(to_f, '__func__')"</span>, <span class="st">"to_f"</span>, <span class="st">"from_f"</span>, from_f<span class="op">=</span>from_f, to_f<span class="op">=</span>to_f)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>test()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
getattr(from_f,'__func__',from_f):==============================
hasattr(from_f, '__func__'): False
hasattr(to_f, '__func__'): False
to_f: &lt;function low&gt;
from_f: &lt;function mid&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b<span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>from_f <span class="op">=</span> mid</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>to_f <span class="op">=</span> low</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"getattr(from_f,'__func__',from_f)"</span>, <span class="st">"k = hasattr(from_f, '__func__')"</span>, <span class="st">"hasattr(to_f, '__func__')"</span>, <span class="st">"to_f"</span>, <span class="st">"from_f"</span>, from_f<span class="op">=</span>from_f, to_f<span class="op">=</span>to_f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
getattr(from_f,'__func__',from_f):==============================
k = hasattr(from_f, '__func__') =&gt; k : False
hasattr(to_f, '__func__'): False
to_f: &lt;function low&gt;
from_f: &lt;function mid&gt;</code></pre>
</div>
</div>
</section>
<section id="a-working-version-but-slightly-longer" class="level3">
<h3 class="anchored" data-anchor-id="a-working-version-but-slightly-longer">A working version but slightly longer</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(name:<span class="bu">str</span>, <span class="op">*</span>code, <span class="op">**</span>env):</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:=============================="</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"="</span> <span class="kw">in</span> c: <span class="co"># updated to handle assignment</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>(), <span class="bu">locals</span>().update(env)) </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">"="</span>)[<span class="dv">0</span>]</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c}: {eval(c, globals().update(env), locals().update(env))}") # working too</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) <span class="co"># working too</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>string <span class="op">=</span> <span class="st">"string"</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"test assignment with exec and eval"</span>, <span class="st">"k = 1 + 2 + a"</span>, a <span class="op">=</span> a, string<span class="op">=</span>string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
test assignment with exec and eval:==============================
k = 1 + 2 + a =&gt; k : 13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>string <span class="op">=</span> <span class="st">"string"</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"test assignment with exec and eval"</span>, <span class="st">"1 + 2 + a"</span>, a <span class="op">=</span> a, string<span class="op">=</span>string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
test assignment with exec and eval:==============================
1 + 2 + a: 13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> test():</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> t1(): <span class="cf">pass</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> t2(): <span class="cf">pass</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    from_f <span class="op">=</span> t1</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    to_f <span class="op">=</span> t2</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    dbprint(<span class="st">"getattr(from_f,'__func__',from_f)"</span>, <span class="st">"hasattr(from_f, '__func__')"</span>, <span class="st">"hasattr(to_f, '__func__')"</span>, <span class="st">"to_f"</span>, <span class="st">"from_f"</span>, from_f<span class="op">=</span>from_f, to_f<span class="op">=</span>to_f)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>test()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
getattr(from_f,'__func__',from_f):==============================
hasattr(from_f, '__func__'): False
hasattr(to_f, '__func__'): False
to_f: &lt;function test.&lt;locals&gt;.t2&gt;
from_f: &lt;function test.&lt;locals&gt;.t1&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b<span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>from_f <span class="op">=</span> mid</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>to_f <span class="op">=</span> low</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"getattr(from_f,'__func__',from_f)"</span>, <span class="st">"k = hasattr(from_f, '__func__')"</span>, <span class="st">"hasattr(to_f, '__func__')"</span>, <span class="st">"to_f"</span>, <span class="st">"from_f"</span>, from_f<span class="op">=</span>from_f, to_f<span class="op">=</span>to_f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
getattr(from_f,'__func__',from_f):==============================
k = hasattr(from_f, '__func__') =&gt; k : False
hasattr(to_f, '__func__'): False
to_f: &lt;function low&gt;
from_f: &lt;function mid&gt;</code></pre>
</div>
</div>
</section>
<section id="exec-and-evals-locals-has-priority-over-global" class="level3">
<h3 class="anchored" data-anchor-id="exec-and-evals-locals-has-priority-over-global">exec and eval’s locals has priority over global</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">'x'</span> <span class="kw">in</span> <span class="bu">globals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">'x'</span> <span class="kw">in</span> <span class="bu">locals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="bu">globals</span>()[<span class="st">'x'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="bu">globals</span>()[<span class="st">'x'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="bu">locals</span>()[<span class="st">'x'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="bu">locals</span>()[<span class="st">'x'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="bu">globals</span>()[<span class="st">'x'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"x = x + 1"</span>, <span class="bu">globals</span>())</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"x = x + 1"</span>, <span class="bu">globals</span>(), <span class="bu">locals</span>())</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"x = x + 1"</span>, <span class="bu">globals</span>(), <span class="bu">locals</span>().update({<span class="st">'x'</span>:<span class="dv">10</span>}))</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>11</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"x = x + 1"</span>, <span class="bu">globals</span>().update({<span class="st">'x'</span>:<span class="dv">20</span>}), <span class="bu">locals</span>().update({<span class="st">'x'</span>:<span class="dv">10</span>}))</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>11</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"x = x + 1"</span>, <span class="bu">globals</span>().update({<span class="st">'x'</span>:<span class="dv">20</span>}))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="bu">eval</span>(<span class="st">"x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>21</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(name:<span class="bu">str</span>, <span class="op">*</span>code, <span class="op">**</span>env):</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:=============================="</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"="</span> <span class="kw">in</span> c: <span class="co"># updated to handle assignment</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>(), <span class="bu">locals</span>().update(env)) </span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">"="</span>)[<span class="dv">0</span>]</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c}: {eval(c, globals().update(env), locals().update(env))}") # working too</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c}: {eval(c, globals().update(env))}") # working too</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>(), <span class="bu">locals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) <span class="co"># working too</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>string <span class="op">=</span> <span class="st">"string"</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"test assignment with exec and eval"</span>, <span class="st">"k = 1 + 2 + a"</span>, a <span class="op">=</span> a, string<span class="op">=</span>string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
test assignment with exec and eval:==============================
k = 1 + 2 + a =&gt; k : 13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>string <span class="op">=</span> <span class="st">"string"</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"test assignment with exec and eval"</span>, <span class="st">"1 + 2 + a"</span>, a <span class="op">=</span> a, string<span class="op">=</span>string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
test assignment with exec and eval:==============================
1 + 2 + a: 8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="bu">globals</span>()[<span class="st">'from_f'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;function __main__.mid(c, d=1, **kwargs)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="bu">locals</span>()[<span class="st">'from_f'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;function __main__.mid(c, d=1, **kwargs)&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> t1(): <span class="cf">pass</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> t2(): <span class="cf">pass</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>from_f <span class="op">=</span> t1</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>to_f <span class="op">=</span> t2</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"getattr(from_f,'__func__',from_f)"</span>, <span class="st">"hasattr(from_f, '__func__')"</span>, <span class="st">"hasattr(to_f, '__func__')"</span>, <span class="st">"to_f"</span>, <span class="st">"from_f"</span>, from_f<span class="op">=</span>t1, to_f<span class="op">=</span>t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
getattr(from_f,'__func__',from_f):==============================
hasattr(from_f, '__func__'): False
hasattr(to_f, '__func__'): False
to_f: &lt;function t2&gt;
from_f: &lt;function t1&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> low(a, b<span class="op">=</span><span class="dv">1</span>): <span class="cf">pass</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mid(c, d<span class="op">=</span><span class="dv">1</span>, <span class="op">**</span>kwargs): <span class="cf">pass</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>from_f <span class="op">=</span> mid</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>to_f <span class="op">=</span> low</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"getattr(from_f,'__func__',from_f)"</span>, <span class="st">"k = hasattr(from_f, '__func__')"</span>, <span class="st">"hasattr(to_f, '__func__')"</span>, <span class="st">"to_f"</span>, <span class="st">"from_f"</span>, from_f<span class="op">=</span>from_f, to_f<span class="op">=</span>to_f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
getattr(from_f,'__func__',from_f):==============================
k = hasattr(from_f, '__func__') =&gt; k : False
hasattr(to_f, '__func__'): False
to_f: &lt;function low&gt;
from_f: &lt;function mid&gt;</code></pre>
</div>
</div>
</section>
<section id="a-trial-and-error-version" class="level3">
<h3 class="anchored" data-anchor-id="a-trial-and-error-version">A trial and error version</h3>
<p>All the versions above seem working for the tests above, but the following one works for the real debugging codes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(name:<span class="bu">str</span>, <span class="op">*</span>code, <span class="op">**</span>env): </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:=============================="</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"="</span> <span class="kw">in</span> c: </span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">"="</span>)[<span class="dv">0</span>]</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="to-differentiate-between-assignment-and-and" class="level3">
<h3 class="anchored" data-anchor-id="to-differentiate-between-assignment-and-and">to differentiate between assignment and != and ==</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution: </span><span class="ch">\</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func."</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>src<span class="sc">}</span><span class="ss">:=============================="</span>)</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">"k.__delopt__ = {...}"</span>.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'k.__delopt__'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"tests = and != in the same line"</span>, <span class="st">"a = 5 == 4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
tests = and != in the same line:==============================
a = 5 == 4 =&gt; a: False</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>dbprint(<span class="st">"tests = and != in the same line"</span>, <span class="st">"a = 5 != 4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
tests = and != in the same line:==============================
a = 5 != 4 =&gt; a: True</code></pre>
</div>
</div>
</section>
<section id="handle-if-statement" class="level3">
<h3 class="anchored" data-anchor-id="handle-if-statement">handle if statement</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution: </span><span class="ch">\</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func."</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>src<span class="sc">}</span><span class="ss">:=============================="</span>)</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; "</span>)</span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="st">"if x: print(x)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>100</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="st">'if abc == def: print()'</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>cond</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>'abc == def'</code></pre>
</div>
</div>
</section>
<section id="handle-for-in-loop-and-in-block-printing" class="level3">
<h3 class="anchored" data-anchor-id="handle-for-in-loop-and-in-block-printing">Handle for in loop and in-block printing</h3>
<hr>
</section>
<section id="checksource" class="level3">
<h3 class="anchored" data-anchor-id="checksource">checksource</h3>
<blockquote class="blockquote">
<pre><code> checksource ()</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>defaults.src2dbp.delegates.append((<span class="st">'ab'</span>, <span class="st">'cd'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>defaults.src2dbp.delegates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[('ab', 'cd')]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure the include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes."</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>src<span class="sc">}</span><span class="ss">:===inside a block==="</span>) <span class="co"># inside a block</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>src<span class="sc">}</span><span class="ss">:================================================================================"</span>) </span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb139-28"><a href="#cb139-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb139-29"><a href="#cb139-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb139-30"><a href="#cb139-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb139-31"><a href="#cb139-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb139-32"><a href="#cb139-32" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb139-33"><a href="#cb139-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb139-34"><a href="#cb139-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb139-35"><a href="#cb139-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb139-36"><a href="#cb139-36" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb139-37"><a href="#cb139-37" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb139-38"><a href="#cb139-38" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)      </span>
<span id="cb139-39"><a href="#cb139-39" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb139-40"><a href="#cb139-40" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb139-41"><a href="#cb139-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb139-42"><a href="#cb139-42" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb139-43"><a href="#cb139-43" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb139-44"><a href="#cb139-44" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb139-45"><a href="#cb139-45" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb139-46"><a href="#cb139-46" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb139-47"><a href="#cb139-47" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb139-48"><a href="#cb139-48" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb139-49"><a href="#cb139-49" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb139-50"><a href="#cb139-50" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb139-51"><a href="#cb139-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb139-52"><a href="#cb139-52" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb139-53"><a href="#cb139-53" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb139-54"><a href="#cb139-54" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb139-55"><a href="#cb139-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb139-56"><a href="#cb139-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c: </span>
<span id="cb139-57"><a href="#cb139-57" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb139-58"><a href="#cb139-58" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:'</span></span>
<span id="cb139-59"><a href="#cb139-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb139-60"><a href="#cb139-60" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb139-61"><a href="#cb139-61" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb139-62"><a href="#cb139-62" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb139-63"><a href="#cb139-63" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb139-64"><a href="#cb139-64" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb139-65"><a href="#cb139-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">', '</span>) <span class="kw">in</span> variables: </span>
<span id="cb139-66"><a href="#cb139-66" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb139-67"><a href="#cb139-67" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb139-68"><a href="#cb139-68" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">', '</span>)</span>
<span id="cb139-69"><a href="#cb139-69" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb139-70"><a href="#cb139-70" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb139-71"><a href="#cb139-71" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb139-72"><a href="#cb139-72" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb139-73"><a href="#cb139-73" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, </span><span class="sc">{value}</span><span class="st">:{eval(value)}')"</span> </span>
<span id="cb139-74"><a href="#cb139-74" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; "</span>)          </span>
<span id="cb139-75"><a href="#cb139-75" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb139-76"><a href="#cb139-76" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb139-77"><a href="#cb139-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb139-78"><a href="#cb139-78" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" print(f'item:</span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb139-79"><a href="#cb139-79" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; "</span>)          </span>
<span id="cb139-80"><a href="#cb139-80" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb139-81"><a href="#cb139-81" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb139-82"><a href="#cb139-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-83"><a href="#cb139-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb139-84"><a href="#cb139-84" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; "</span>)          </span>
<span id="cb139-85"><a href="#cb139-85" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb139-86"><a href="#cb139-86" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb139-87"><a href="#cb139-87" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb139-88"><a href="#cb139-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb139-89"><a href="#cb139-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb139-90"><a href="#cb139-90" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb139-91"><a href="#cb139-91" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb139-92"><a href="#cb139-92" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb139-93"><a href="#cb139-93" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="clean-up-the-format-for-readability" class="level3">
<h3 class="anchored" data-anchor-id="clean-up-the-format-for-readability">clean up the format for readability</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure the include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes."</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>src<span class="sc">}</span><span class="ss">:===inside a block==="</span>) <span class="co"># inside a block</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>src<span class="sc">}</span><span class="ss">:================================================================================"</span>) </span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb140-33"><a href="#cb140-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb140-34"><a href="#cb140-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb140-35"><a href="#cb140-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb140-36"><a href="#cb140-36" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb140-37"><a href="#cb140-37" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb140-38"><a href="#cb140-38" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)      </span>
<span id="cb140-39"><a href="#cb140-39" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb140-40"><a href="#cb140-40" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb140-41"><a href="#cb140-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb140-42"><a href="#cb140-42" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb140-43"><a href="#cb140-43" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb140-44"><a href="#cb140-44" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb140-45"><a href="#cb140-45" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb140-46"><a href="#cb140-46" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb140-47"><a href="#cb140-47" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb140-48"><a href="#cb140-48" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb140-49"><a href="#cb140-49" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb140-50"><a href="#cb140-50" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb140-51"><a href="#cb140-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb140-52"><a href="#cb140-52" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb140-53"><a href="#cb140-53" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb140-54"><a href="#cb140-54" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb140-55"><a href="#cb140-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb140-56"><a href="#cb140-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c: </span>
<span id="cb140-57"><a href="#cb140-57" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb140-58"><a href="#cb140-58" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:'</span></span>
<span id="cb140-59"><a href="#cb140-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb140-60"><a href="#cb140-60" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb140-61"><a href="#cb140-61" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb140-62"><a href="#cb140-62" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb140-63"><a href="#cb140-63" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb140-64"><a href="#cb140-64" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb140-65"><a href="#cb140-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">', '</span>) <span class="kw">in</span> variables: </span>
<span id="cb140-66"><a href="#cb140-66" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb140-67"><a href="#cb140-67" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb140-68"><a href="#cb140-68" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">', '</span>)</span>
<span id="cb140-69"><a href="#cb140-69" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb140-70"><a href="#cb140-70" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb140-71"><a href="#cb140-71" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb140-72"><a href="#cb140-72" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb140-73"><a href="#cb140-73" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb140-74"><a href="#cb140-74" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb140-75"><a href="#cb140-75" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb140-76"><a href="#cb140-76" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb140-77"><a href="#cb140-77" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb140-78"><a href="#cb140-78" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb140-79"><a href="#cb140-79" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb140-80"><a href="#cb140-80" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb140-81"><a href="#cb140-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb140-82"><a href="#cb140-82" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb140-83"><a href="#cb140-83" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb140-84"><a href="#cb140-84" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb140-85"><a href="#cb140-85" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb140-86"><a href="#cb140-86" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb140-87"><a href="#cb140-87" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb140-88"><a href="#cb140-88" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb140-89"><a href="#cb140-89" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb140-90"><a href="#cb140-90" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb140-91"><a href="#cb140-91" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb140-92"><a href="#cb140-92" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb140-93"><a href="#cb140-93" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb140-94"><a href="#cb140-94" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb140-95"><a href="#cb140-95" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb140-96"><a href="#cb140-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb140-97"><a href="#cb140-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb140-98"><a href="#cb140-98" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb140-99"><a href="#cb140-99" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb140-100"><a href="#cb140-100" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb140-101"><a href="#cb140-101" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-a-few-more-caution-messages-for-avoiding-unnecessary-errors-in-using-dbprint" class="level3">
<h3 class="anchored" data-anchor-id="add-a-few-more-caution-messages-for-avoiding-unnecessary-errors-in-using-dbprint">Add a few more caution messages for avoiding unnecessary errors in using dbprint</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k, v in` </span><span class="ch">\</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>src<span class="sc">}</span><span class="ss">:===inside a block==="</span>) <span class="co"># inside a block</span></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>src<span class="sc">}</span><span class="ss">:================================================================================"</span>) </span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb141-21"><a href="#cb141-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb141-22"><a href="#cb141-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb141-23"><a href="#cb141-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb141-24"><a href="#cb141-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb141-25"><a href="#cb141-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb141-26"><a href="#cb141-26" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb141-27"><a href="#cb141-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb141-28"><a href="#cb141-28" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb141-29"><a href="#cb141-29" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb141-30"><a href="#cb141-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb141-31"><a href="#cb141-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb141-32"><a href="#cb141-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb141-33"><a href="#cb141-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb141-34"><a href="#cb141-34" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb141-35"><a href="#cb141-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb141-36"><a href="#cb141-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb141-37"><a href="#cb141-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb141-38"><a href="#cb141-38" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb141-39"><a href="#cb141-39" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb141-40"><a href="#cb141-40" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)      </span>
<span id="cb141-41"><a href="#cb141-41" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb141-42"><a href="#cb141-42" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb141-43"><a href="#cb141-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb141-44"><a href="#cb141-44" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb141-45"><a href="#cb141-45" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb141-46"><a href="#cb141-46" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb141-47"><a href="#cb141-47" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb141-48"><a href="#cb141-48" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb141-49"><a href="#cb141-49" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb141-50"><a href="#cb141-50" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb141-51"><a href="#cb141-51" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb141-52"><a href="#cb141-52" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb141-53"><a href="#cb141-53" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb141-54"><a href="#cb141-54" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb141-55"><a href="#cb141-55" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb141-56"><a href="#cb141-56" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb141-57"><a href="#cb141-57" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb141-58"><a href="#cb141-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c: </span>
<span id="cb141-59"><a href="#cb141-59" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb141-60"><a href="#cb141-60" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:'</span></span>
<span id="cb141-61"><a href="#cb141-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb141-62"><a href="#cb141-62" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb141-63"><a href="#cb141-63" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb141-64"><a href="#cb141-64" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb141-65"><a href="#cb141-65" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb141-66"><a href="#cb141-66" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb141-67"><a href="#cb141-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">', '</span>) <span class="kw">in</span> variables: </span>
<span id="cb141-68"><a href="#cb141-68" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb141-69"><a href="#cb141-69" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb141-70"><a href="#cb141-70" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">', '</span>)</span>
<span id="cb141-71"><a href="#cb141-71" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb141-72"><a href="#cb141-72" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb141-73"><a href="#cb141-73" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb141-74"><a href="#cb141-74" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb141-75"><a href="#cb141-75" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb141-76"><a href="#cb141-76" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb141-77"><a href="#cb141-77" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb141-78"><a href="#cb141-78" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb141-79"><a href="#cb141-79" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb141-80"><a href="#cb141-80" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb141-81"><a href="#cb141-81" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb141-82"><a href="#cb141-82" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb141-83"><a href="#cb141-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb141-84"><a href="#cb141-84" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb141-85"><a href="#cb141-85" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb141-86"><a href="#cb141-86" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb141-87"><a href="#cb141-87" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb141-88"><a href="#cb141-88" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb141-89"><a href="#cb141-89" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb141-90"><a href="#cb141-90" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb141-91"><a href="#cb141-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb141-92"><a href="#cb141-92" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb141-93"><a href="#cb141-93" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb141-94"><a href="#cb141-94" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb141-95"><a href="#cb141-95" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb141-96"><a href="#cb141-96" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb141-97"><a href="#cb141-97" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb141-98"><a href="#cb141-98" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb141-99"><a href="#cb141-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb141-100"><a href="#cb141-100" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb141-101"><a href="#cb141-101" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb141-102"><a href="#cb141-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb141-103"><a href="#cb141-103" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="make-the-output-more-distinguishable-between-in-and-out-of-code-block" class="level3">
<h3 class="anchored" data-anchor-id="make-the-output-more-distinguishable-between-in-and-out-of-code-block">Make the output more distinguishable between in and out of code block</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k, v in` </span><span class="ch">\</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===inside a block==="</span>))</span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"==================================================="</span>))</span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>src<span class="sc">}</span><span class="ss"> &lt;===== source code ======="</span>) </span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb142-31"><a href="#cb142-31" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb142-32"><a href="#cb142-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb142-33"><a href="#cb142-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb142-34"><a href="#cb142-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb142-35"><a href="#cb142-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb142-36"><a href="#cb142-36" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb142-37"><a href="#cb142-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb142-38"><a href="#cb142-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb142-39"><a href="#cb142-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb142-40"><a href="#cb142-40" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb142-41"><a href="#cb142-41" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb142-42"><a href="#cb142-42" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)      </span>
<span id="cb142-43"><a href="#cb142-43" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb142-44"><a href="#cb142-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb142-45"><a href="#cb142-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb142-46"><a href="#cb142-46" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb142-47"><a href="#cb142-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb142-48"><a href="#cb142-48" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb142-49"><a href="#cb142-49" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb142-50"><a href="#cb142-50" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb142-51"><a href="#cb142-51" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb142-52"><a href="#cb142-52" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb142-53"><a href="#cb142-53" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb142-54"><a href="#cb142-54" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb142-55"><a href="#cb142-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb142-56"><a href="#cb142-56" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb142-57"><a href="#cb142-57" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb142-58"><a href="#cb142-58" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb142-59"><a href="#cb142-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb142-60"><a href="#cb142-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c: </span>
<span id="cb142-61"><a href="#cb142-61" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb142-62"><a href="#cb142-62" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:'</span></span>
<span id="cb142-63"><a href="#cb142-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb142-64"><a href="#cb142-64" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb142-65"><a href="#cb142-65" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb142-66"><a href="#cb142-66" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb142-67"><a href="#cb142-67" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb142-68"><a href="#cb142-68" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb142-69"><a href="#cb142-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">', '</span>) <span class="kw">in</span> variables: </span>
<span id="cb142-70"><a href="#cb142-70" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb142-71"><a href="#cb142-71" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb142-72"><a href="#cb142-72" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">', '</span>)</span>
<span id="cb142-73"><a href="#cb142-73" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb142-74"><a href="#cb142-74" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb142-75"><a href="#cb142-75" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb142-76"><a href="#cb142-76" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb142-77"><a href="#cb142-77" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb142-78"><a href="#cb142-78" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb142-79"><a href="#cb142-79" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb142-80"><a href="#cb142-80" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb142-81"><a href="#cb142-81" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb142-82"><a href="#cb142-82" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb142-83"><a href="#cb142-83" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb142-84"><a href="#cb142-84" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb142-85"><a href="#cb142-85" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb142-86"><a href="#cb142-86" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb142-87"><a href="#cb142-87" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb142-88"><a href="#cb142-88" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb142-89"><a href="#cb142-89" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb142-90"><a href="#cb142-90" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb142-91"><a href="#cb142-91" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb142-92"><a href="#cb142-92" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb142-93"><a href="#cb142-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb142-94"><a href="#cb142-94" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb142-95"><a href="#cb142-95" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb142-96"><a href="#cb142-96" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb142-97"><a href="#cb142-97" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb142-98"><a href="#cb142-98" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb142-99"><a href="#cb142-99" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb142-100"><a href="#cb142-100" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb142-101"><a href="#cb142-101" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb142-102"><a href="#cb142-102" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb142-103"><a href="#cb142-103" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb142-104"><a href="#cb142-104" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb142-105"><a href="#cb142-105" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>src <span class="op">=</span> <span class="st">"this is a piece of code"</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 157</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>endline <span class="op">=</span> <span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===================="</span>)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(endline)</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"\n{src} =====&gt; {endline}")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                         ====================</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">'{0:</span><span class="sc">{fill}{align}</span><span class="st">155}'</span>.<span class="bu">format</span>(<span class="st">"a line of code"</span>, fill<span class="op">=</span><span class="st">'&lt;'</span>, align<span class="op">=</span><span class="st">'&lt;'</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a line of code&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code></pre>
</div>
</div>
</section>
<section id="adding-features-to-handle-a-block-of-code-execution" class="level3">
<h3 class="anchored" data-anchor-id="adding-features-to-handle-a-block-of-code-execution">adding features to handle a block of code execution</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k, v in` </span><span class="ch">\</span></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===inside a block==="</span>))</span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb147-17"><a href="#cb147-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"==================================================="</span>))</span>
<span id="cb147-18"><a href="#cb147-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb147-19"><a href="#cb147-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print out markers for a block of source and a line source code </span></span>
<span id="cb147-20"><a href="#cb147-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> src: </span>
<span id="cb147-21"><a href="#cb147-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(src)</span>
<span id="cb147-22"><a href="#cb147-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:^157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"================== a block of source codes ====================="</span>))</span>
<span id="cb147-23"><a href="#cb147-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb147-24"><a href="#cb147-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(src <span class="op">+</span> <span class="st">"&lt;===== source code ======="</span>) </span>
<span id="cb147-25"><a href="#cb147-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb147-26"><a href="#cb147-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb147-27"><a href="#cb147-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb147-28"><a href="#cb147-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb147-29"><a href="#cb147-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle a block of code</span></span>
<span id="cb147-30"><a href="#cb147-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> c: </span>
<span id="cb147-31"><a href="#cb147-31" aria-hidden="true" tabindex="-1"></a>            block <span class="op">=</span> ast.parse(c, mode<span class="op">=</span><span class="st">'exec'</span>)</span>
<span id="cb147-32"><a href="#cb147-32" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(<span class="bu">compile</span>(block, <span class="st">'&lt;string&gt;'</span>, mode<span class="op">=</span><span class="st">'exec'</span>), <span class="bu">globals</span>().update(env))</span>
<span id="cb147-33"><a href="#cb147-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb147-34"><a href="#cb147-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb147-35"><a href="#cb147-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb147-36"><a href="#cb147-36" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb147-37"><a href="#cb147-37" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb147-38"><a href="#cb147-38" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb147-39"><a href="#cb147-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb147-40"><a href="#cb147-40" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb147-41"><a href="#cb147-41" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb147-42"><a href="#cb147-42" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb147-43"><a href="#cb147-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb147-44"><a href="#cb147-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb147-45"><a href="#cb147-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb147-46"><a href="#cb147-46" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb147-47"><a href="#cb147-47" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb147-48"><a href="#cb147-48" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb147-49"><a href="#cb147-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb147-50"><a href="#cb147-50" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb147-51"><a href="#cb147-51" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb147-52"><a href="#cb147-52" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)      </span>
<span id="cb147-53"><a href="#cb147-53" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb147-54"><a href="#cb147-54" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb147-55"><a href="#cb147-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb147-56"><a href="#cb147-56" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb147-57"><a href="#cb147-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb147-58"><a href="#cb147-58" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb147-59"><a href="#cb147-59" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb147-60"><a href="#cb147-60" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb147-61"><a href="#cb147-61" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb147-62"><a href="#cb147-62" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb147-63"><a href="#cb147-63" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb147-64"><a href="#cb147-64" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb147-65"><a href="#cb147-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb147-66"><a href="#cb147-66" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb147-67"><a href="#cb147-67" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb147-68"><a href="#cb147-68" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb147-69"><a href="#cb147-69" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb147-70"><a href="#cb147-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c: </span>
<span id="cb147-71"><a href="#cb147-71" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb147-72"><a href="#cb147-72" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:'</span></span>
<span id="cb147-73"><a href="#cb147-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb147-74"><a href="#cb147-74" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb147-75"><a href="#cb147-75" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb147-76"><a href="#cb147-76" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb147-77"><a href="#cb147-77" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb147-78"><a href="#cb147-78" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb147-79"><a href="#cb147-79" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">', '</span>) <span class="kw">in</span> variables: </span>
<span id="cb147-80"><a href="#cb147-80" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb147-81"><a href="#cb147-81" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb147-82"><a href="#cb147-82" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">', '</span>)</span>
<span id="cb147-83"><a href="#cb147-83" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb147-84"><a href="#cb147-84" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb147-85"><a href="#cb147-85" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb147-86"><a href="#cb147-86" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb147-87"><a href="#cb147-87" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb147-88"><a href="#cb147-88" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb147-89"><a href="#cb147-89" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb147-90"><a href="#cb147-90" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb147-91"><a href="#cb147-91" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb147-92"><a href="#cb147-92" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb147-93"><a href="#cb147-93" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb147-94"><a href="#cb147-94" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb147-95"><a href="#cb147-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb147-96"><a href="#cb147-96" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb147-97"><a href="#cb147-97" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb147-98"><a href="#cb147-98" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb147-99"><a href="#cb147-99" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb147-100"><a href="#cb147-100" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb147-101"><a href="#cb147-101" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb147-102"><a href="#cb147-102" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb147-103"><a href="#cb147-103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb147-104"><a href="#cb147-104" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb147-105"><a href="#cb147-105" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb147-106"><a href="#cb147-106" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb147-107"><a href="#cb147-107" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb147-108"><a href="#cb147-108" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb147-109"><a href="#cb147-109" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb147-110"><a href="#cb147-110" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb147-111"><a href="#cb147-111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb147-112"><a href="#cb147-112" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb147-113"><a href="#cb147-113" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb147-114"><a href="#cb147-114" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb147-115"><a href="#cb147-115" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ast</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span><span class="st">"""</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="st">a = 1</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="st">b = 2</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="st">c = a + b</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>block <span class="op">=</span> ast.parse(c, mode<span class="op">=</span><span class="st">'exec'</span>)</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="bu">exec</span>(<span class="bu">compile</span>(block, <span class="st">'&lt;string&gt;'</span>, mode<span class="op">=</span><span class="st">'exec'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>2</code></pre>
</div>
</div>
</section>
<section id="add-feature-to-print-out-source-code-in-both-line-and-block-to-the-right-end-of-the-page" class="level3">
<h3 class="anchored" data-anchor-id="add-feature-to-print-out-source-code-in-both-line-and-block-to-the-right-end-of-the-page">add feature to print out source code in both line and block to the right end of the page</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k, v in` </span><span class="ch">\</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===inside a block==="</span>))</span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))</span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"==================================================="</span>))</span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))        </span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print out markers for a block of source and a line source code </span></span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> src: </span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(src)</span></span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('{:^157}'.format("================== a block of source codes ====================="))</span></span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('{:&gt;157}'.format(src))    </span></span>
<span id="cb151-27"><a href="#cb151-27" aria-hidden="true" tabindex="-1"></a>        lst <span class="op">=</span> src.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb151-28"><a href="#cb151-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> l <span class="kw">in</span> lst: </span>
<span id="cb151-29"><a href="#cb151-29" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb151-30"><a href="#cb151-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb151-31"><a href="#cb151-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb151-32"><a href="#cb151-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(src <span class="op">+</span> <span class="st">"&lt;===== source code ======="</span>) </span>
<span id="cb151-33"><a href="#cb151-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb151-34"><a href="#cb151-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb151-35"><a href="#cb151-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb151-36"><a href="#cb151-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-37"><a href="#cb151-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle a block of code</span></span>
<span id="cb151-38"><a href="#cb151-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> c: </span>
<span id="cb151-39"><a href="#cb151-39" aria-hidden="true" tabindex="-1"></a>            block <span class="op">=</span> ast.parse(c, mode<span class="op">=</span><span class="st">'exec'</span>)</span>
<span id="cb151-40"><a href="#cb151-40" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(<span class="bu">compile</span>(block, <span class="st">'&lt;string&gt;'</span>, mode<span class="op">=</span><span class="st">'exec'</span>), <span class="bu">globals</span>().update(env))</span>
<span id="cb151-41"><a href="#cb151-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-42"><a href="#cb151-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb151-43"><a href="#cb151-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb151-44"><a href="#cb151-44" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb151-45"><a href="#cb151-45" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb151-46"><a href="#cb151-46" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb151-47"><a href="#cb151-47" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb151-48"><a href="#cb151-48" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb151-49"><a href="#cb151-49" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb151-50"><a href="#cb151-50" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb151-51"><a href="#cb151-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb151-52"><a href="#cb151-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb151-53"><a href="#cb151-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb151-54"><a href="#cb151-54" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb151-55"><a href="#cb151-55" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb151-56"><a href="#cb151-56" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb151-57"><a href="#cb151-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb151-58"><a href="#cb151-58" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb151-59"><a href="#cb151-59" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb151-60"><a href="#cb151-60" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)      </span>
<span id="cb151-61"><a href="#cb151-61" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb151-62"><a href="#cb151-62" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb151-63"><a href="#cb151-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb151-64"><a href="#cb151-64" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb151-65"><a href="#cb151-65" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb151-66"><a href="#cb151-66" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb151-67"><a href="#cb151-67" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb151-68"><a href="#cb151-68" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb151-69"><a href="#cb151-69" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb151-70"><a href="#cb151-70" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb151-71"><a href="#cb151-71" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb151-72"><a href="#cb151-72" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb151-73"><a href="#cb151-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb151-74"><a href="#cb151-74" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb151-75"><a href="#cb151-75" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb151-76"><a href="#cb151-76" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb151-77"><a href="#cb151-77" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb151-78"><a href="#cb151-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c: </span>
<span id="cb151-79"><a href="#cb151-79" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb151-80"><a href="#cb151-80" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:'</span></span>
<span id="cb151-81"><a href="#cb151-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb151-82"><a href="#cb151-82" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb151-83"><a href="#cb151-83" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb151-84"><a href="#cb151-84" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb151-85"><a href="#cb151-85" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb151-86"><a href="#cb151-86" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb151-87"><a href="#cb151-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">', '</span>) <span class="kw">in</span> variables: </span>
<span id="cb151-88"><a href="#cb151-88" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb151-89"><a href="#cb151-89" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb151-90"><a href="#cb151-90" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">', '</span>)</span>
<span id="cb151-91"><a href="#cb151-91" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb151-92"><a href="#cb151-92" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb151-93"><a href="#cb151-93" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb151-94"><a href="#cb151-94" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb151-95"><a href="#cb151-95" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb151-96"><a href="#cb151-96" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb151-97"><a href="#cb151-97" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb151-98"><a href="#cb151-98" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb151-99"><a href="#cb151-99" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb151-100"><a href="#cb151-100" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb151-101"><a href="#cb151-101" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb151-102"><a href="#cb151-102" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb151-103"><a href="#cb151-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb151-104"><a href="#cb151-104" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb151-105"><a href="#cb151-105" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb151-106"><a href="#cb151-106" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb151-107"><a href="#cb151-107" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb151-108"><a href="#cb151-108" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb151-109"><a href="#cb151-109" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb151-110"><a href="#cb151-110" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb151-111"><a href="#cb151-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb151-112"><a href="#cb151-112" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb151-113"><a href="#cb151-113" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb151-114"><a href="#cb151-114" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb151-115"><a href="#cb151-115" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb151-116"><a href="#cb151-116" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-117"><a href="#cb151-117" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb151-118"><a href="#cb151-118" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb151-119"><a href="#cb151-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb151-120"><a href="#cb151-120" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb151-121"><a href="#cb151-121" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb151-122"><a href="#cb151-122" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb151-123"><a href="#cb151-123" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>blocks <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="st">if to is None: </span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="st">    to_f,from_f = f.__base__.__init__,f.__init__</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="st">else:          </span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="st">    to_f,from_f = to.__init__ if isinstance(to,type) else to,f</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>lst <span class="op">=</span> blocks.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> l <span class="kw">in</span> lst: </span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                                             
                                                                                                                                              if to is None: 
                                                                                                                 to_f,from_f = f.__base__.__init__,f.__init__
                                                                                                                                              else:          
                                                                                                   to_f,from_f = to.__init__ if isinstance(to,type) else to,f
                                                                                                                                                             </code></pre>
</div>
</div>
</section>
<section id="add-feature-if-abc-from-for-k-v-in-abc-is-empty-then-skip-the-current-iteration" class="level3">
<h3 class="anchored" data-anchor-id="add-feature-if-abc-from-for-k-v-in-abc-is-empty-then-skip-the-current-iteration">add feature: if <code>abc</code> from <code>for k, v in abc:</code> is empty, then skip the current iteration</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k, v in` </span><span class="ch">\</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===inside a block==="</span>))</span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))</span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(src <span class="op">+</span> <span class="st">"&lt;===== source code ======="</span>) </span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb154-20"><a href="#cb154-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"==================================================="</span>))</span>
<span id="cb154-21"><a href="#cb154-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-22"><a href="#cb154-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb154-23"><a href="#cb154-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print out markers for a block of source and a line source code </span></span>
<span id="cb154-24"><a href="#cb154-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> src: </span>
<span id="cb154-25"><a href="#cb154-25" aria-hidden="true" tabindex="-1"></a>            lst <span class="op">=</span> src.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb154-26"><a href="#cb154-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> l <span class="kw">in</span> lst: </span>
<span id="cb154-27"><a href="#cb154-27" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb154-28"><a href="#cb154-28" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(src <span class="op">+</span> <span class="st">"&lt;===== source code ======="</span>) </span>
<span id="cb154-29"><a href="#cb154-29" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:^157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"&lt;===== source code ======="</span>))</span>
<span id="cb154-30"><a href="#cb154-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-31"><a href="#cb154-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb154-32"><a href="#cb154-32" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))        </span>
<span id="cb154-33"><a href="#cb154-33" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(src <span class="op">+</span> <span class="st">"&lt;===== source code ======="</span>) </span>
<span id="cb154-34"><a href="#cb154-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb154-35"><a href="#cb154-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb154-36"><a href="#cb154-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb154-37"><a href="#cb154-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb154-38"><a href="#cb154-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle a block of code</span></span>
<span id="cb154-39"><a href="#cb154-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> c: </span>
<span id="cb154-40"><a href="#cb154-40" aria-hidden="true" tabindex="-1"></a>            block <span class="op">=</span> ast.parse(c, mode<span class="op">=</span><span class="st">'exec'</span>)</span>
<span id="cb154-41"><a href="#cb154-41" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(<span class="bu">compile</span>(block, <span class="st">'&lt;string&gt;'</span>, mode<span class="op">=</span><span class="st">'exec'</span>), <span class="bu">globals</span>().update(env))</span>
<span id="cb154-42"><a href="#cb154-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb154-43"><a href="#cb154-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb154-44"><a href="#cb154-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb154-45"><a href="#cb154-45" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb154-46"><a href="#cb154-46" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb154-47"><a href="#cb154-47" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb154-48"><a href="#cb154-48" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb154-49"><a href="#cb154-49" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb154-50"><a href="#cb154-50" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb154-51"><a href="#cb154-51" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb154-52"><a href="#cb154-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb154-53"><a href="#cb154-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb154-54"><a href="#cb154-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb154-55"><a href="#cb154-55" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb154-56"><a href="#cb154-56" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb154-57"><a href="#cb154-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb154-58"><a href="#cb154-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb154-59"><a href="#cb154-59" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb154-60"><a href="#cb154-60" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb154-61"><a href="#cb154-61" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)      </span>
<span id="cb154-62"><a href="#cb154-62" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb154-63"><a href="#cb154-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb154-64"><a href="#cb154-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb154-65"><a href="#cb154-65" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb154-66"><a href="#cb154-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb154-67"><a href="#cb154-67" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb154-68"><a href="#cb154-68" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb154-69"><a href="#cb154-69" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb154-70"><a href="#cb154-70" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb154-71"><a href="#cb154-71" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb154-72"><a href="#cb154-72" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb154-73"><a href="#cb154-73" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb154-74"><a href="#cb154-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb154-75"><a href="#cb154-75" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb154-76"><a href="#cb154-76" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb154-77"><a href="#cb154-77" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb154-78"><a href="#cb154-78" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb154-79"><a href="#cb154-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c:           </span>
<span id="cb154-80"><a href="#cb154-80" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb154-81"><a href="#cb154-81" aria-hidden="true" tabindex="-1"></a>            <span class="co"># in example like 'for k, v in abc:' or `for k, v in abc: print(...)`, if abc is empty</span></span>
<span id="cb154-82"><a href="#cb154-82" aria-hidden="true" tabindex="-1"></a>            <span class="co"># step 1: access abc</span></span>
<span id="cb154-83"><a href="#cb154-83" aria-hidden="true" tabindex="-1"></a>            <span class="co"># get the substring between 'in ' and ':', which is like 'abc'</span></span>
<span id="cb154-84"><a href="#cb154-84" aria-hidden="true" tabindex="-1"></a>            abc <span class="op">=</span> re.search(<span class="st">'in (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb154-85"><a href="#cb154-85" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if abc is empty dict or list: print and pass</span></span>
<span id="cb154-86"><a href="#cb154-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">bool</span>(abc): </span>
<span id="cb154-87"><a href="#cb154-87" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>abc<span class="sc">}</span><span class="ss"> is an emtpy </span><span class="sc">{</span><span class="bu">type</span>(<span class="bu">eval</span>(abc))<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb154-88"><a href="#cb154-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span> </span>
<span id="cb154-89"><a href="#cb154-89" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The break statement can be used if you need to break out of a for or while loop and move onto the next section of code.</span></span>
<span id="cb154-90"><a href="#cb154-90" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The continue statement can be used if you need to skip the current iteration of a for or while loop and move onto the next iteration.</span></span>
<span id="cb154-91"><a href="#cb154-91" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb154-92"><a href="#cb154-92" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:', there is no more code after `:`</span></span>
<span id="cb154-93"><a href="#cb154-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb154-94"><a href="#cb154-94" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb154-95"><a href="#cb154-95" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb154-96"><a href="#cb154-96" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb154-97"><a href="#cb154-97" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb154-98"><a href="#cb154-98" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb154-99"><a href="#cb154-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">', '</span>) <span class="kw">in</span> variables: </span>
<span id="cb154-100"><a href="#cb154-100" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb154-101"><a href="#cb154-101" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb154-102"><a href="#cb154-102" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">', '</span>)</span>
<span id="cb154-103"><a href="#cb154-103" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb154-104"><a href="#cb154-104" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb154-105"><a href="#cb154-105" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb154-106"><a href="#cb154-106" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb154-107"><a href="#cb154-107" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb154-108"><a href="#cb154-108" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb154-109"><a href="#cb154-109" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb154-110"><a href="#cb154-110" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb154-111"><a href="#cb154-111" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb154-112"><a href="#cb154-112" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb154-113"><a href="#cb154-113" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb154-114"><a href="#cb154-114" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb154-115"><a href="#cb154-115" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb154-116"><a href="#cb154-116" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb154-117"><a href="#cb154-117" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb154-118"><a href="#cb154-118" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb154-119"><a href="#cb154-119" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb154-120"><a href="#cb154-120" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb154-121"><a href="#cb154-121" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb154-122"><a href="#cb154-122" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb154-123"><a href="#cb154-123" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb154-124"><a href="#cb154-124" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb154-125"><a href="#cb154-125" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb154-126"><a href="#cb154-126" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb154-127"><a href="#cb154-127" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) <span class="co"># we can't use eval to run `for in` loop, but exec can.</span></span>
<span id="cb154-128"><a href="#cb154-128" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc print(abc)`</span></span>
<span id="cb154-129"><a href="#cb154-129" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc if k == def`</span></span>
<span id="cb154-130"><a href="#cb154-130" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb154-131"><a href="#cb154-131" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb154-132"><a href="#cb154-132" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb154-133"><a href="#cb154-133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb154-134"><a href="#cb154-134" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb154-135"><a href="#cb154-135" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb154-136"><a href="#cb154-136" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb154-137"><a href="#cb154-137" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>dict1 <span class="op">=</span> {<span class="st">'a'</span>:<span class="dv">1</span>}</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>lst1 <span class="op">=</span> [<span class="dv">1</span>]</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="bu">bool</span>(dict1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>dict1 <span class="op">=</span> {}</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>lst1 <span class="op">=</span> []</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="bu">bool</span>(dict1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>False</code></pre>
</div>
</div>
</section>
<section id="nicer-output-spacing" class="level3">
<h3 class="anchored" data-anchor-id="nicer-output-spacing">nicer output spacing</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k, v in` </span><span class="ch">\</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===inside a block==="</span>))</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))</span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(src <span class="op">+</span> <span class="st">"&lt;===== source code ======="</span>) </span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"==================================================="</span>))</span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print out markers for a block of source and a line source code </span></span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> src: </span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a>            lst <span class="op">=</span> src.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> l <span class="kw">in</span> lst: </span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-33"><a href="#cb159-33" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:^157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"&lt;===== source code ======="</span>))</span>
<span id="cb159-34"><a href="#cb159-34" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(src) </span>
<span id="cb159-35"><a href="#cb159-35" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb159-36"><a href="#cb159-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-37"><a href="#cb159-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb159-38"><a href="#cb159-38" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))        </span>
<span id="cb159-39"><a href="#cb159-39" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(src <span class="op">+</span> <span class="st">"&lt;===== source code ======="</span>) </span>
<span id="cb159-40"><a href="#cb159-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb159-41"><a href="#cb159-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb159-42"><a href="#cb159-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb159-43"><a href="#cb159-43" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb159-44"><a href="#cb159-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb159-45"><a href="#cb159-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle a block of code</span></span>
<span id="cb159-46"><a href="#cb159-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> c: </span>
<span id="cb159-47"><a href="#cb159-47" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; "</span>)</span>
<span id="cb159-48"><a href="#cb159-48" aria-hidden="true" tabindex="-1"></a>            block <span class="op">=</span> ast.parse(c, mode<span class="op">=</span><span class="st">'exec'</span>)</span>
<span id="cb159-49"><a href="#cb159-49" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(<span class="bu">compile</span>(block, <span class="st">'&lt;string&gt;'</span>, mode<span class="op">=</span><span class="st">'exec'</span>), <span class="bu">globals</span>().update(env))</span>
<span id="cb159-50"><a href="#cb159-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb159-51"><a href="#cb159-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb159-52"><a href="#cb159-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb159-53"><a href="#cb159-53" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb159-54"><a href="#cb159-54" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb159-55"><a href="#cb159-55" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb159-56"><a href="#cb159-56" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb159-57"><a href="#cb159-57" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb159-58"><a href="#cb159-58" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb159-59"><a href="#cb159-59" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb159-60"><a href="#cb159-60" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb159-61"><a href="#cb159-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb159-62"><a href="#cb159-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb159-63"><a href="#cb159-63" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb159-64"><a href="#cb159-64" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb159-65"><a href="#cb159-65" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb159-66"><a href="#cb159-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb159-67"><a href="#cb159-67" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb159-68"><a href="#cb159-68" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb159-69"><a href="#cb159-69" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)      </span>
<span id="cb159-70"><a href="#cb159-70" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb159-71"><a href="#cb159-71" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb159-72"><a href="#cb159-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb159-73"><a href="#cb159-73" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb159-74"><a href="#cb159-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb159-75"><a href="#cb159-75" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb159-76"><a href="#cb159-76" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb159-77"><a href="#cb159-77" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb159-78"><a href="#cb159-78" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb159-79"><a href="#cb159-79" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb159-80"><a href="#cb159-80" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb159-81"><a href="#cb159-81" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb159-82"><a href="#cb159-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb159-83"><a href="#cb159-83" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb159-84"><a href="#cb159-84" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb159-85"><a href="#cb159-85" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb159-86"><a href="#cb159-86" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb159-87"><a href="#cb159-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c:           </span>
<span id="cb159-88"><a href="#cb159-88" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb159-89"><a href="#cb159-89" aria-hidden="true" tabindex="-1"></a>            <span class="co"># in example like 'for k, v in abc:' or `for k, v in abc: print(...)`, if abc is empty</span></span>
<span id="cb159-90"><a href="#cb159-90" aria-hidden="true" tabindex="-1"></a>            <span class="co"># step 1: access abc</span></span>
<span id="cb159-91"><a href="#cb159-91" aria-hidden="true" tabindex="-1"></a>            <span class="co"># get the substring between 'in ' and ':', which is like 'abc'</span></span>
<span id="cb159-92"><a href="#cb159-92" aria-hidden="true" tabindex="-1"></a>            abc <span class="op">=</span> re.search(<span class="st">'in (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb159-93"><a href="#cb159-93" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if abc is empty dict or list: print and pass</span></span>
<span id="cb159-94"><a href="#cb159-94" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">bool</span>(abc): </span>
<span id="cb159-95"><a href="#cb159-95" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>abc<span class="sc">}</span><span class="ss"> is an emtpy </span><span class="sc">{</span><span class="bu">type</span>(<span class="bu">eval</span>(abc))<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb159-96"><a href="#cb159-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span> </span>
<span id="cb159-97"><a href="#cb159-97" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The break statement can be used if you need to break out of a for or while loop and move onto the next section of code.</span></span>
<span id="cb159-98"><a href="#cb159-98" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The continue statement can be used if you need to skip the current iteration of a for or while loop and move onto the next iteration.</span></span>
<span id="cb159-99"><a href="#cb159-99" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb159-100"><a href="#cb159-100" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:', there is no more code after `:`</span></span>
<span id="cb159-101"><a href="#cb159-101" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb159-102"><a href="#cb159-102" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb159-103"><a href="#cb159-103" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb159-104"><a href="#cb159-104" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb159-105"><a href="#cb159-105" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb159-106"><a href="#cb159-106" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb159-107"><a href="#cb159-107" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">', '</span>) <span class="kw">in</span> variables: </span>
<span id="cb159-108"><a href="#cb159-108" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb159-109"><a href="#cb159-109" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb159-110"><a href="#cb159-110" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">', '</span>)</span>
<span id="cb159-111"><a href="#cb159-111" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb159-112"><a href="#cb159-112" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb159-113"><a href="#cb159-113" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb159-114"><a href="#cb159-114" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb159-115"><a href="#cb159-115" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb159-116"><a href="#cb159-116" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb159-117"><a href="#cb159-117" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb159-118"><a href="#cb159-118" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb159-119"><a href="#cb159-119" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb159-120"><a href="#cb159-120" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb159-121"><a href="#cb159-121" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb159-122"><a href="#cb159-122" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb159-123"><a href="#cb159-123" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb159-124"><a href="#cb159-124" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb159-125"><a href="#cb159-125" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb159-126"><a href="#cb159-126" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb159-127"><a href="#cb159-127" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span>)          </span>
<span id="cb159-128"><a href="#cb159-128" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb159-129"><a href="#cb159-129" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb159-130"><a href="#cb159-130" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb159-131"><a href="#cb159-131" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb159-132"><a href="#cb159-132" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb159-133"><a href="#cb159-133" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb159-134"><a href="#cb159-134" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span>)</span>
<span id="cb159-135"><a href="#cb159-135" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) <span class="co"># we can't use eval to run `for in` loop, but exec can.</span></span>
<span id="cb159-136"><a href="#cb159-136" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc print(abc)`</span></span>
<span id="cb159-137"><a href="#cb159-137" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc if k == def`</span></span>
<span id="cb159-138"><a href="#cb159-138" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb159-139"><a href="#cb159-139" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb159-140"><a href="#cb159-140" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb159-141"><a href="#cb159-141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb159-142"><a href="#cb159-142" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span>) </span>
<span id="cb159-143"><a href="#cb159-143" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb159-144"><a href="#cb159-144" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb159-145"><a href="#cb159-145" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="print-output-left-and-right-reverted" class="level3">
<h3 class="anchored" data-anchor-id="print-output-left-and-right-reverted">print output left and right reverted</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k, v in` </span><span class="ch">\</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===source inside a block==="</span>))</span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))</span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(src + "&lt;===== source code =======") </span></span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-21"><a href="#cb160-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb160-22"><a href="#cb160-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb160-23"><a href="#cb160-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('{:&gt;157}'.format("======================== source code ==========================="))</span></span>
<span id="cb160-24"><a href="#cb160-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"============================= source code ================================"</span>))</span>
<span id="cb160-25"><a href="#cb160-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))        </span>
<span id="cb160-26"><a href="#cb160-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb160-27"><a href="#cb160-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print out markers for a block of source and a line source code </span></span>
<span id="cb160-28"><a href="#cb160-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if "\n" in src: </span></span>
<span id="cb160-29"><a href="#cb160-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     lst = src.split('\n')</span></span>
<span id="cb160-30"><a href="#cb160-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     for l in lst: </span></span>
<span id="cb160-31"><a href="#cb160-31" aria-hidden="true" tabindex="-1"></a>        <span class="co">#         print('{:&gt;157}'.format(l))</span></span>
<span id="cb160-32"><a href="#cb160-32" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     print('\n')</span></span>
<span id="cb160-33"><a href="#cb160-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-34"><a href="#cb160-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('{:^157}'.format("&lt;===== source code ======="))</span></span>
<span id="cb160-35"><a href="#cb160-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(src)  # print the block of src for the second time but on the left hand side</span></span>
<span id="cb160-36"><a href="#cb160-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('\n')</span></span>
<span id="cb160-37"><a href="#cb160-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-38"><a href="#cb160-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># else:</span></span>
<span id="cb160-39"><a href="#cb160-39" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     print('{:&gt;157}'.format(src))        </span></span>
<span id="cb160-40"><a href="#cb160-40" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(src + "&lt;===== source code =======") </span></span>
<span id="cb160-41"><a href="#cb160-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb160-42"><a href="#cb160-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb160-43"><a href="#cb160-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb160-44"><a href="#cb160-44" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb160-45"><a href="#cb160-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb160-46"><a href="#cb160-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle a block of code</span></span>
<span id="cb160-47"><a href="#cb160-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> c: </span>
<span id="cb160-48"><a href="#cb160-48" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"Running your code block =&gt; "</span></span>
<span id="cb160-49"><a href="#cb160-49" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(c))       </span>
<span id="cb160-50"><a href="#cb160-50" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))  </span>
<span id="cb160-51"><a href="#cb160-51" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'The code block printout =&gt; : '</span>)</span>
<span id="cb160-52"><a href="#cb160-52" aria-hidden="true" tabindex="-1"></a>            block <span class="op">=</span> ast.parse(c, mode<span class="op">=</span><span class="st">'exec'</span>)</span>
<span id="cb160-53"><a href="#cb160-53" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(<span class="bu">compile</span>(block, <span class="st">'&lt;string&gt;'</span>, mode<span class="op">=</span><span class="st">'exec'</span>), <span class="bu">globals</span>().update(env))</span>
<span id="cb160-54"><a href="#cb160-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb160-55"><a href="#cb160-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb160-56"><a href="#cb160-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb160-57"><a href="#cb160-57" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb160-58"><a href="#cb160-58" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb160-59"><a href="#cb160-59" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb160-60"><a href="#cb160-60" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb160-61"><a href="#cb160-61" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb160-62"><a href="#cb160-62" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c} =&gt; {variable}: {eval(variable)}")</span></span>
<span id="cb160-63"><a href="#cb160-63" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb160-64"><a href="#cb160-64" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))       </span>
<span id="cb160-65"><a href="#cb160-65" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb160-66"><a href="#cb160-66" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb160-67"><a href="#cb160-67" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb160-68"><a href="#cb160-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb160-69"><a href="#cb160-69" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb160-70"><a href="#cb160-70" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb160-71"><a href="#cb160-71" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb160-72"><a href="#cb160-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb160-73"><a href="#cb160-73" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb160-74"><a href="#cb160-74" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb160-75"><a href="#cb160-75" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")      </span></span>
<span id="cb160-76"><a href="#cb160-76" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb160-77"><a href="#cb160-77" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))</span>
<span id="cb160-78"><a href="#cb160-78" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb160-79"><a href="#cb160-79" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb160-80"><a href="#cb160-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb160-81"><a href="#cb160-81" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb160-82"><a href="#cb160-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb160-83"><a href="#cb160-83" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb160-84"><a href="#cb160-84" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb160-85"><a href="#cb160-85" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb160-86"><a href="#cb160-86" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printc} : ")</span></span>
<span id="cb160-87"><a href="#cb160-87" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb160-88"><a href="#cb160-88" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))      </span>
<span id="cb160-89"><a href="#cb160-89" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb160-90"><a href="#cb160-90" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb160-91"><a href="#cb160-91" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb160-92"><a href="#cb160-92" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb160-93"><a href="#cb160-93" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")</span></span>
<span id="cb160-94"><a href="#cb160-94" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb160-95"><a href="#cb160-95" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb160-96"><a href="#cb160-96" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb160-97"><a href="#cb160-97" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb160-98"><a href="#cb160-98" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb160-99"><a href="#cb160-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c:           </span>
<span id="cb160-100"><a href="#cb160-100" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb160-101"><a href="#cb160-101" aria-hidden="true" tabindex="-1"></a>            <span class="co"># in example like 'for k, v in abc:' or `for k, v in abc: print(...)`, if abc is empty</span></span>
<span id="cb160-102"><a href="#cb160-102" aria-hidden="true" tabindex="-1"></a>            <span class="co"># step 1: access abc</span></span>
<span id="cb160-103"><a href="#cb160-103" aria-hidden="true" tabindex="-1"></a>            <span class="co"># get the substring between 'in ' and ':', which is like 'abc'</span></span>
<span id="cb160-104"><a href="#cb160-104" aria-hidden="true" tabindex="-1"></a>            abc <span class="op">=</span> re.search(<span class="st">'in (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb160-105"><a href="#cb160-105" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if abc is empty dict or list: print and pass</span></span>
<span id="cb160-106"><a href="#cb160-106" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">bool</span>(abc): </span>
<span id="cb160-107"><a href="#cb160-107" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f'{c} =&gt; {abc} is an emtpy {type(eval(abc))}')</span></span>
<span id="cb160-108"><a href="#cb160-108" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>abc<span class="sc">}</span><span class="ss"> is an emtpy </span><span class="sc">{</span><span class="bu">type</span>(<span class="bu">eval</span>(abc))<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb160-109"><a href="#cb160-109" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb160-110"><a href="#cb160-110" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span> </span>
<span id="cb160-111"><a href="#cb160-111" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The break statement can be used if you need to break out of a for or while loop and move onto the next section of code.</span></span>
<span id="cb160-112"><a href="#cb160-112" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The continue statement can be used if you need to skip the current iteration of a for or while loop and move onto the next iteration.</span></span>
<span id="cb160-113"><a href="#cb160-113" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb160-114"><a href="#cb160-114" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:', there is no more code after `:`</span></span>
<span id="cb160-115"><a href="#cb160-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb160-116"><a href="#cb160-116" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb160-117"><a href="#cb160-117" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb160-118"><a href="#cb160-118" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb160-119"><a href="#cb160-119" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb160-120"><a href="#cb160-120" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb160-121"><a href="#cb160-121" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">', '</span>) <span class="kw">in</span> variables: </span>
<span id="cb160-122"><a href="#cb160-122" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb160-123"><a href="#cb160-123" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb160-124"><a href="#cb160-124" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">', '</span>)</span>
<span id="cb160-125"><a href="#cb160-125" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb160-126"><a href="#cb160-126" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb160-127"><a href="#cb160-127" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb160-128"><a href="#cb160-128" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb160-129"><a href="#cb160-129" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb160-130"><a href="#cb160-130" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb160-131"><a href="#cb160-131" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb160-132"><a href="#cb160-132" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb160-133"><a href="#cb160-133" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb160-134"><a href="#cb160-134" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")      </span></span>
<span id="cb160-135"><a href="#cb160-135" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb160-136"><a href="#cb160-136" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb160-137"><a href="#cb160-137" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb160-138"><a href="#cb160-138" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb160-139"><a href="#cb160-139" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb160-140"><a href="#cb160-140" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb160-141"><a href="#cb160-141" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb160-142"><a href="#cb160-142" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb160-143"><a href="#cb160-143" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")     </span></span>
<span id="cb160-144"><a href="#cb160-144" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb160-145"><a href="#cb160-145" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb160-146"><a href="#cb160-146" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb160-147"><a href="#cb160-147" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb160-148"><a href="#cb160-148" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb160-149"><a href="#cb160-149" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb160-150"><a href="#cb160-150" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb160-151"><a href="#cb160-151" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb160-152"><a href="#cb160-152" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f"{c} =&gt; {printc} : ")</span></span>
<span id="cb160-153"><a href="#cb160-153" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb160-154"><a href="#cb160-154" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb160-155"><a href="#cb160-155" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) <span class="co"># we can't use eval to run `for in` loop, but exec can.</span></span>
<span id="cb160-156"><a href="#cb160-156" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc print(abc)`</span></span>
<span id="cb160-157"><a href="#cb160-157" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc if k == def`</span></span>
<span id="cb160-158"><a href="#cb160-158" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb160-159"><a href="#cb160-159" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb160-160"><a href="#cb160-160" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb160-161"><a href="#cb160-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb160-162"><a href="#cb160-162" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c} =&gt; {c} : {eval(c, globals().update(env))}") </span></span>
<span id="cb160-163"><a href="#cb160-163" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb160-164"><a href="#cb160-164" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb160-165"><a href="#cb160-165" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb160-166"><a href="#cb160-166" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb160-167"><a href="#cb160-167" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-feature-print-out-the-entire-source-code-and-use-to-mark-the-source-code-line-at-debugging" class="level3">
<h3 class="anchored" data-anchor-id="add-feature-print-out-the-entire-source-code-and-use-to-mark-the-source-code-line-at-debugging">add feature: print out the entire source code and use ====== to mark the source code line at debugging</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> inspect</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fastcore.meta <span class="im">as</span> fm</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>defaults.src <span class="op">=</span> inspect.getsource(fm.delegates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>defaults.src</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'def delegates(to:FunctionType=None, # Delegatee\n              keep=False, # Keep `kwargs` in decorated function?\n              but:list=None): # Exclude these parameters from signature\n    "Decorator: replace `**kwargs` in signature with params from `to`"\n    if but is None: but = []\n    def _f(f):\n        if to is None: to_f,from_f = f.__base__.__init__,f.__init__\n        else:          to_f,from_f = to.__init__ if isinstance(to,type) else to,f\n        from_f = getattr(from_f,\'__func__\',from_f)\n        to_f = getattr(to_f,\'__func__\',to_f)\n        if hasattr(from_f,\'__delwrap__\'): return f\n        sig = inspect.signature(from_f)\n        sigd = dict(sig.parameters)\n        k = sigd.pop(\'kwargs\')\n        s2 = {k:v.replace(kind=inspect.Parameter.KEYWORD_ONLY) for k,v in inspect.signature(to_f).parameters.items()\n              if v.default != inspect.Parameter.empty and k not in sigd and k not in but}\n        anno = {k:v for k,v in to_f.__annotations__.items() if k not in sigd and k not in but}\n        sigd.update(s2)\n        if keep: sigd[\'kwargs\'] = k\n        else: from_f.__delwrap__ = to_f\n        from_f.__signature__ = sig.replace(parameters=sigd.values())\n        if hasattr(from_f, \'__annotations__\'): from_f.__annotations__.update(anno)\n        return f\n    return _f\n'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>lst <span class="op">=</span> defaults.src.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>l1 <span class="op">=</span> lst[<span class="dv">6</span>]</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>l1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'        if to is None: to_f,from_f = f.__base__.__init__,f.__init__'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>l1.strip()</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>l1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'        if to is None: to_f,from_f = f.__base__.__init__,f.__init__'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>block1 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="st">if to is None: to_f,from_f = f.__base__.__init__,f.__init__</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="st">else:          to_f,from_f = to.__init__ if isinstance(to,type) else to,f</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>block1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'\nif to is None: to_f,from_f = f.__base__.__init__,f.__init__\nelse:          to_f,from_f = to.__init__ if isinstance(to,type) else to,f\n        '</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>lst[<span class="dv">6</span>].strip() <span class="kw">in</span> block1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>lst[<span class="op">-</span><span class="dv">1</span>], lst[<span class="op">-</span><span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>('',
 "        if hasattr(from_f, '__annotations__'): from_f.__annotations__.update(anno)")</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="bu">bool</span>(lst[<span class="op">-</span><span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
</section>
<section id="defaults.block-is-no-longer-needed-i-think" class="level3">
<h3 class="anchored" data-anchor-id="defaults.block-is-no-longer-needed-i-think">defaults.block is no longer needed I think</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> dbcolors:</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> <span class="st">'</span><span class="ch">\033</span><span class="st">[92m'</span> <span class="co">#GREEN</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="st">'</span><span class="ch">\033</span><span class="st">[93m'</span> <span class="co">#YELLOW</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> <span class="st">'</span><span class="ch">\033</span><span class="st">[91m'</span> <span class="co">#RED</span></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>    reset <span class="op">=</span> <span class="st">'</span><span class="ch">\033</span><span class="st">[0m'</span> <span class="co">#RESET COLOR</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> colorize(): <span class="cf">pass</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k,v in` </span><span class="ch">\</span></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===source inside a block==="</span>))</span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))</span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(src + "&lt;===== source code =======") </span></span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('{:&gt;157}'.format("======================== source code ==========================="))</span></span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"============================= source code ================================"</span>))</span>
<span id="cb178-25"><a href="#cb178-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))        </span>
<span id="cb178-26"><a href="#cb178-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb178-27"><a href="#cb178-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print the source code of the function</span></span>
<span id="cb178-28"><a href="#cb178-28" aria-hidden="true" tabindex="-1"></a>        lst <span class="op">=</span> defaults.src.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb178-29"><a href="#cb178-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> l <span class="kw">in</span> lst: </span>
<span id="cb178-30"><a href="#cb178-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">bool</span>(l) <span class="kw">and</span> l.strip() <span class="kw">in</span> src: <span class="co"># how to make sure all these ls are close to each other???</span></span>
<span id="cb178-31"><a href="#cb178-31" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:=&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb178-32"><a href="#cb178-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb178-33"><a href="#cb178-33" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb178-34"><a href="#cb178-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb178-35"><a href="#cb178-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb178-36"><a href="#cb178-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb178-37"><a href="#cb178-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb178-38"><a href="#cb178-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb178-39"><a href="#cb178-39" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb178-40"><a href="#cb178-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb178-41"><a href="#cb178-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle a block of code</span></span>
<span id="cb178-42"><a href="#cb178-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> c: </span>
<span id="cb178-43"><a href="#cb178-43" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"Running your code block =&gt; "</span></span>
<span id="cb178-44"><a href="#cb178-44" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(c))       </span>
<span id="cb178-45"><a href="#cb178-45" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))  </span>
<span id="cb178-46"><a href="#cb178-46" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'The code block printout =&gt; : '</span>)</span>
<span id="cb178-47"><a href="#cb178-47" aria-hidden="true" tabindex="-1"></a>            block <span class="op">=</span> ast.parse(c, mode<span class="op">=</span><span class="st">'exec'</span>)</span>
<span id="cb178-48"><a href="#cb178-48" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(<span class="bu">compile</span>(block, <span class="st">'&lt;string&gt;'</span>, mode<span class="op">=</span><span class="st">'exec'</span>), <span class="bu">globals</span>().update(env))</span>
<span id="cb178-49"><a href="#cb178-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb178-50"><a href="#cb178-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb178-51"><a href="#cb178-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb178-52"><a href="#cb178-52" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb178-53"><a href="#cb178-53" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb178-54"><a href="#cb178-54" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb178-55"><a href="#cb178-55" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb178-56"><a href="#cb178-56" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb178-57"><a href="#cb178-57" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c} =&gt; {variable}: {eval(variable)}")</span></span>
<span id="cb178-58"><a href="#cb178-58" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb178-59"><a href="#cb178-59" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))       </span>
<span id="cb178-60"><a href="#cb178-60" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb178-61"><a href="#cb178-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb178-62"><a href="#cb178-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb178-63"><a href="#cb178-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb178-64"><a href="#cb178-64" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb178-65"><a href="#cb178-65" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb178-66"><a href="#cb178-66" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb178-67"><a href="#cb178-67" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb178-68"><a href="#cb178-68" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb178-69"><a href="#cb178-69" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb178-70"><a href="#cb178-70" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")      </span></span>
<span id="cb178-71"><a href="#cb178-71" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb178-72"><a href="#cb178-72" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))</span>
<span id="cb178-73"><a href="#cb178-73" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb178-74"><a href="#cb178-74" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb178-75"><a href="#cb178-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb178-76"><a href="#cb178-76" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb178-77"><a href="#cb178-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb178-78"><a href="#cb178-78" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb178-79"><a href="#cb178-79" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb178-80"><a href="#cb178-80" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb178-81"><a href="#cb178-81" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printc} : ")</span></span>
<span id="cb178-82"><a href="#cb178-82" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb178-83"><a href="#cb178-83" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))      </span>
<span id="cb178-84"><a href="#cb178-84" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb178-85"><a href="#cb178-85" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb178-86"><a href="#cb178-86" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb178-87"><a href="#cb178-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb178-88"><a href="#cb178-88" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")</span></span>
<span id="cb178-89"><a href="#cb178-89" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb178-90"><a href="#cb178-90" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb178-91"><a href="#cb178-91" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb178-92"><a href="#cb178-92" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb178-93"><a href="#cb178-93" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb178-94"><a href="#cb178-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c:           </span>
<span id="cb178-95"><a href="#cb178-95" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb178-96"><a href="#cb178-96" aria-hidden="true" tabindex="-1"></a>            <span class="co"># in example like 'for k, v in abc:' or `for k, v in abc: print(...)`, if abc is empty</span></span>
<span id="cb178-97"><a href="#cb178-97" aria-hidden="true" tabindex="-1"></a>            <span class="co"># step 1: access abc</span></span>
<span id="cb178-98"><a href="#cb178-98" aria-hidden="true" tabindex="-1"></a>            <span class="co"># get the substring between 'in ' and ':', which is like 'abc'</span></span>
<span id="cb178-99"><a href="#cb178-99" aria-hidden="true" tabindex="-1"></a>            abc <span class="op">=</span> re.search(<span class="st">'in (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb178-100"><a href="#cb178-100" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if abc is empty dict or list: print and pass</span></span>
<span id="cb178-101"><a href="#cb178-101" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">bool</span>(<span class="bu">eval</span>(abc)): </span>
<span id="cb178-102"><a href="#cb178-102" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f'{c} =&gt; {abc} is an emtpy {type(eval(abc))}')</span></span>
<span id="cb178-103"><a href="#cb178-103" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>abc<span class="sc">}</span><span class="ss"> is an emtpy </span><span class="sc">{</span><span class="bu">type</span>(<span class="bu">eval</span>(abc))<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb178-104"><a href="#cb178-104" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb178-105"><a href="#cb178-105" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span> </span>
<span id="cb178-106"><a href="#cb178-106" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The break statement can be used if you need to break out of a for or while loop and move onto the next section of code.</span></span>
<span id="cb178-107"><a href="#cb178-107" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The continue statement can be used if you need to skip the current iteration of a for or while loop and move onto the next iteration.</span></span>
<span id="cb178-108"><a href="#cb178-108" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb178-109"><a href="#cb178-109" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:', there is no more code after `:`</span></span>
<span id="cb178-110"><a href="#cb178-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb178-111"><a href="#cb178-111" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb178-112"><a href="#cb178-112" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb178-113"><a href="#cb178-113" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb178-114"><a href="#cb178-114" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb178-115"><a href="#cb178-115" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb178-116"><a href="#cb178-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">','</span>) <span class="kw">in</span> variables: </span>
<span id="cb178-117"><a href="#cb178-117" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb178-118"><a href="#cb178-118" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb178-119"><a href="#cb178-119" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">','</span>)</span>
<span id="cb178-120"><a href="#cb178-120" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb178-121"><a href="#cb178-121" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb178-122"><a href="#cb178-122" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb178-123"><a href="#cb178-123" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb178-124"><a href="#cb178-124" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb178-125"><a href="#cb178-125" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb178-126"><a href="#cb178-126" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb178-127"><a href="#cb178-127" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb178-128"><a href="#cb178-128" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb178-129"><a href="#cb178-129" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")      </span></span>
<span id="cb178-130"><a href="#cb178-130" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb178-131"><a href="#cb178-131" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb178-132"><a href="#cb178-132" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb178-133"><a href="#cb178-133" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb178-134"><a href="#cb178-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb178-135"><a href="#cb178-135" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb178-136"><a href="#cb178-136" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb178-137"><a href="#cb178-137" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb178-138"><a href="#cb178-138" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")     </span></span>
<span id="cb178-139"><a href="#cb178-139" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb178-140"><a href="#cb178-140" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb178-141"><a href="#cb178-141" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb178-142"><a href="#cb178-142" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb178-143"><a href="#cb178-143" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb178-144"><a href="#cb178-144" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb178-145"><a href="#cb178-145" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb178-146"><a href="#cb178-146" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb178-147"><a href="#cb178-147" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f"{c} =&gt; {printc} : ")</span></span>
<span id="cb178-148"><a href="#cb178-148" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb178-149"><a href="#cb178-149" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb178-150"><a href="#cb178-150" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) <span class="co"># we can't use eval to run `for in` loop, but exec can.</span></span>
<span id="cb178-151"><a href="#cb178-151" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc print(abc)`</span></span>
<span id="cb178-152"><a href="#cb178-152" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc if k == def`</span></span>
<span id="cb178-153"><a href="#cb178-153" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb178-154"><a href="#cb178-154" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb178-155"><a href="#cb178-155" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb178-156"><a href="#cb178-156" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb178-157"><a href="#cb178-157" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c} =&gt; {c} : {eval(c, globals().update(env))}") </span></span>
<span id="cb178-158"><a href="#cb178-158" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb178-159"><a href="#cb178-159" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb178-160"><a href="#cb178-160" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb178-161"><a href="#cb178-161" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb178-162"><a href="#cb178-162" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-features-to-colorize-question-feature-and-comment" class="level3">
<h3 class="anchored" data-anchor-id="add-features-to-colorize-question-feature-and-comment">add features to colorize question, feature and comment</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k,v in` </span><span class="ch">\</span></span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===source inside a block==="</span>))</span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))</span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb179-19"><a href="#cb179-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(src + "&lt;===== source code =======") </span></span>
<span id="cb179-20"><a href="#cb179-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-21"><a href="#cb179-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb179-22"><a href="#cb179-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb179-23"><a href="#cb179-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('{:&gt;157}'.format("======================== source code ==========================="))</span></span>
<span id="cb179-24"><a href="#cb179-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"============================= source code ================================"</span>))</span>
<span id="cb179-25"><a href="#cb179-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))        </span>
<span id="cb179-26"><a href="#cb179-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb179-27"><a href="#cb179-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print the source code of the function</span></span>
<span id="cb179-28"><a href="#cb179-28" aria-hidden="true" tabindex="-1"></a>        lst <span class="op">=</span> defaults.src.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb179-29"><a href="#cb179-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> l <span class="kw">in</span> lst: </span>
<span id="cb179-30"><a href="#cb179-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">bool</span>(l) <span class="kw">and</span> l.strip() <span class="kw">in</span> src: <span class="co"># how to make sure all these ls are close to each other???</span></span>
<span id="cb179-31"><a href="#cb179-31" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:=&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb179-32"><a href="#cb179-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb179-33"><a href="#cb179-33" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb179-34"><a href="#cb179-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print out the example</span></span>
<span id="cb179-35"><a href="#cb179-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(defaults.eg))</span>
<span id="cb179-36"><a href="#cb179-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb179-37"><a href="#cb179-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-38"><a href="#cb179-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb179-39"><a href="#cb179-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb179-40"><a href="#cb179-40" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb179-41"><a href="#cb179-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb179-42"><a href="#cb179-42" aria-hidden="true" tabindex="-1"></a>        c1 <span class="op">=</span> <span class="va">None</span> <span class="co"># use it as container for colored string</span></span>
<span id="cb179-43"><a href="#cb179-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle comment</span></span>
<span id="cb179-44"><a href="#cb179-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"#comment#"</span> <span class="kw">in</span> c:</span>
<span id="cb179-45"><a href="#cb179-45" aria-hidden="true" tabindex="-1"></a>            _,c1 <span class="op">=</span> colorize(c)</span>
<span id="cb179-46"><a href="#cb179-46" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('{:&gt;157}'.format(c1))   </span></span>
<span id="cb179-47"><a href="#cb179-47" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(c1)</span>
<span id="cb179-48"><a href="#cb179-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb179-49"><a href="#cb179-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb179-50"><a href="#cb179-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-51"><a href="#cb179-51" aria-hidden="true" tabindex="-1"></a>            <span class="co"># c is normal string, c1 is colored string, both are without #question# or #feature# or #comment#</span></span>
<span id="cb179-52"><a href="#cb179-52" aria-hidden="true" tabindex="-1"></a>            c,c1 <span class="op">=</span> colorize(c)</span>
<span id="cb179-53"><a href="#cb179-53" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb179-54"><a href="#cb179-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle a block of code</span></span>
<span id="cb179-55"><a href="#cb179-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> c: </span>
<span id="cb179-56"><a href="#cb179-56" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"Running your code block =&gt; "</span></span>
<span id="cb179-57"><a href="#cb179-57" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(c))       </span>
<span id="cb179-58"><a href="#cb179-58" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))  </span>
<span id="cb179-59"><a href="#cb179-59" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'The code block printout =&gt; : '</span>)</span>
<span id="cb179-60"><a href="#cb179-60" aria-hidden="true" tabindex="-1"></a>            block <span class="op">=</span> ast.parse(c, mode<span class="op">=</span><span class="st">'exec'</span>)</span>
<span id="cb179-61"><a href="#cb179-61" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(<span class="bu">compile</span>(block, <span class="st">'&lt;string&gt;'</span>, mode<span class="op">=</span><span class="st">'exec'</span>), <span class="bu">globals</span>().update(env))</span>
<span id="cb179-62"><a href="#cb179-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb179-63"><a href="#cb179-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb179-64"><a href="#cb179-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb179-65"><a href="#cb179-65" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb179-66"><a href="#cb179-66" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb179-67"><a href="#cb179-67" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c1<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb179-68"><a href="#cb179-68" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))       </span>
<span id="cb179-69"><a href="#cb179-69" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb179-70"><a href="#cb179-70" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb179-71"><a href="#cb179-71" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb179-72"><a href="#cb179-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb179-73"><a href="#cb179-73" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb179-74"><a href="#cb179-74" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb179-75"><a href="#cb179-75" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb179-76"><a href="#cb179-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb179-77"><a href="#cb179-77" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb179-78"><a href="#cb179-78" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb179-79"><a href="#cb179-79" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")      </span></span>
<span id="cb179-80"><a href="#cb179-80" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb179-81"><a href="#cb179-81" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))</span>
<span id="cb179-82"><a href="#cb179-82" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb179-83"><a href="#cb179-83" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb179-84"><a href="#cb179-84" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb179-85"><a href="#cb179-85" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb179-86"><a href="#cb179-86" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb179-87"><a href="#cb179-87" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb179-88"><a href="#cb179-88" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb179-89"><a href="#cb179-89" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb179-90"><a href="#cb179-90" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printc} : ")</span></span>
<span id="cb179-91"><a href="#cb179-91" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb179-92"><a href="#cb179-92" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))      </span>
<span id="cb179-93"><a href="#cb179-93" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb179-94"><a href="#cb179-94" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb179-95"><a href="#cb179-95" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb179-96"><a href="#cb179-96" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb179-97"><a href="#cb179-97" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")</span></span>
<span id="cb179-98"><a href="#cb179-98" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb179-99"><a href="#cb179-99" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb179-100"><a href="#cb179-100" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb179-101"><a href="#cb179-101" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb179-102"><a href="#cb179-102" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb179-103"><a href="#cb179-103" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c:           </span>
<span id="cb179-104"><a href="#cb179-104" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb179-105"><a href="#cb179-105" aria-hidden="true" tabindex="-1"></a>            <span class="co"># in example like 'for k, v in abc:' or `for k, v in abc: print(...)`, if abc is empty</span></span>
<span id="cb179-106"><a href="#cb179-106" aria-hidden="true" tabindex="-1"></a>            <span class="co"># step 1: access abc</span></span>
<span id="cb179-107"><a href="#cb179-107" aria-hidden="true" tabindex="-1"></a>            <span class="co"># get the substring between 'in ' and ':', which is like 'abc'</span></span>
<span id="cb179-108"><a href="#cb179-108" aria-hidden="true" tabindex="-1"></a>            abc <span class="op">=</span> re.search(<span class="st">'in (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb179-109"><a href="#cb179-109" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if abc is empty dict or list: print and pass</span></span>
<span id="cb179-110"><a href="#cb179-110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">bool</span>(<span class="bu">eval</span>(abc)): </span>
<span id="cb179-111"><a href="#cb179-111" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f'{c} =&gt; {abc} is an emtpy {type(eval(abc))}')</span></span>
<span id="cb179-112"><a href="#cb179-112" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>abc<span class="sc">}</span><span class="ss"> is an emtpy </span><span class="sc">{</span><span class="bu">type</span>(<span class="bu">eval</span>(abc))<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb179-113"><a href="#cb179-113" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb179-114"><a href="#cb179-114" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb179-115"><a href="#cb179-115" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The break statement can be used if you need to break out of a for or while loop and move onto the next section of code.</span></span>
<span id="cb179-116"><a href="#cb179-116" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The continue statement can be used if you need to skip the current iteration of a for or while loop and move onto the next iteration.</span></span>
<span id="cb179-117"><a href="#cb179-117" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb179-118"><a href="#cb179-118" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:', there is no more code after `:`</span></span>
<span id="cb179-119"><a href="#cb179-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb179-120"><a href="#cb179-120" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb179-121"><a href="#cb179-121" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb179-122"><a href="#cb179-122" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb179-123"><a href="#cb179-123" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb179-124"><a href="#cb179-124" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb179-125"><a href="#cb179-125" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">','</span>) <span class="kw">in</span> variables: </span>
<span id="cb179-126"><a href="#cb179-126" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb179-127"><a href="#cb179-127" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb179-128"><a href="#cb179-128" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">','</span>)</span>
<span id="cb179-129"><a href="#cb179-129" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb179-130"><a href="#cb179-130" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb179-131"><a href="#cb179-131" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb179-132"><a href="#cb179-132" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb179-133"><a href="#cb179-133" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb179-134"><a href="#cb179-134" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb179-135"><a href="#cb179-135" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb179-136"><a href="#cb179-136" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb179-137"><a href="#cb179-137" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb179-138"><a href="#cb179-138" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")      </span></span>
<span id="cb179-139"><a href="#cb179-139" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb179-140"><a href="#cb179-140" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb179-141"><a href="#cb179-141" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb179-142"><a href="#cb179-142" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb179-143"><a href="#cb179-143" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb179-144"><a href="#cb179-144" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb179-145"><a href="#cb179-145" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb179-146"><a href="#cb179-146" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb179-147"><a href="#cb179-147" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")     </span></span>
<span id="cb179-148"><a href="#cb179-148" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb179-149"><a href="#cb179-149" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb179-150"><a href="#cb179-150" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb179-151"><a href="#cb179-151" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb179-152"><a href="#cb179-152" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb179-153"><a href="#cb179-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb179-154"><a href="#cb179-154" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb179-155"><a href="#cb179-155" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb179-156"><a href="#cb179-156" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb179-157"><a href="#cb179-157" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb179-158"><a href="#cb179-158" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) <span class="co"># we can't use eval to run `for in` loop, but exec can.</span></span>
<span id="cb179-159"><a href="#cb179-159" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc print(abc)`</span></span>
<span id="cb179-160"><a href="#cb179-160" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc if k == def`</span></span>
<span id="cb179-161"><a href="#cb179-161" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb179-162"><a href="#cb179-162" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle comment</span></span>
<span id="cb179-163"><a href="#cb179-163" aria-hidden="true" tabindex="-1"></a>        <span class="co"># elif "#comment#" in c:</span></span>
<span id="cb179-164"><a href="#cb179-164" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     # c,c1 = colorize(c)</span></span>
<span id="cb179-165"><a href="#cb179-165" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     print('{:&gt;157}'.format(c1))   </span></span>
<span id="cb179-166"><a href="#cb179-166" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     print(c1)</span></span>
<span id="cb179-167"><a href="#cb179-167" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb179-168"><a href="#cb179-168" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb179-169"><a href="#cb179-169" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb179-170"><a href="#cb179-170" aria-hidden="true" tabindex="-1"></a>            <span class="co"># c1 is to color #feature# or #question#</span></span>
<span id="cb179-171"><a href="#cb179-171" aria-hidden="true" tabindex="-1"></a>            <span class="co"># c,c1 = colorize(c)</span></span>
<span id="cb179-172"><a href="#cb179-172" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>c1<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb179-173"><a href="#cb179-173" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb179-174"><a href="#cb179-174" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb179-175"><a href="#cb179-175" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb179-176"><a href="#cb179-176" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>blocks <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="st">if to is None: </span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="st">    to_f,from_f = f.__base__.__init__,f.__init__</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="st">else:          </span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="st">    to_f,from_f = to.__init__ if isinstance(to,type) else to,f</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>lst <span class="op">=</span> blocks.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> l <span class="kw">in</span> lst: </span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                                             
                                                                                                                                              if to is None: 
                                                                                                                 to_f,from_f = f.__base__.__init__,f.__init__
                                                                                                                                              else:          
                                                                                                   to_f,from_f = to.__init__ if isinstance(to,type) else to,f
                                                                                                                                                             </code></pre>
</div>
</div>
</section>
</section>
<section id="alignright-a-block-of-codes" class="level2">
<h2 class="anchored" data-anchor-id="alignright-a-block-of-codes">Alignright a block of codes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>blocks <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="st">if to is None:</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="st">    to_f,from_f = f.__base__.__init__,f.__init__</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="st">else:</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="st">    to_f,from_f = to.__init__ if isinstance(to,type) else to,f</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="st">        """</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="alignright" class="level3">
<h3 class="anchored" data-anchor-id="alignright">alignright</h3>
<blockquote class="blockquote">
<pre><code> alignright (blocks)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>alignright(<span class="st">"this is me"</span>)</span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>alignright(<span class="st">'</span><span class="ch">\x1b</span><span class="st">[91mthis is me</span><span class="ch">\x1b</span><span class="st">[0m'</span>) <span class="co"># can we align this colored line all the way to the right?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                                   this is me
                                                                                                                                          this is me</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>            cmt:<span class="bu">str</span><span class="op">=</span><span class="va">None</span>, <span class="co"># add colorful comment</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k,v in` </span><span class="ch">\</span></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===source inside a block==="</span>))</span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))</span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(src + "&lt;===== source code =======") </span></span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb186-23"><a href="#cb186-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb186-24"><a href="#cb186-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('{:&gt;157}'.format("======================== source code ==========================="))</span></span>
<span id="cb186-25"><a href="#cb186-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"============================= source code ================================"</span>))</span>
<span id="cb186-26"><a href="#cb186-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))        </span>
<span id="cb186-27"><a href="#cb186-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-28"><a href="#cb186-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print the source code of the function</span></span>
<span id="cb186-29"><a href="#cb186-29" aria-hidden="true" tabindex="-1"></a>        lst <span class="op">=</span> defaults.src.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb186-30"><a href="#cb186-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> l <span class="kw">in</span> lst: </span>
<span id="cb186-31"><a href="#cb186-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">bool</span>(l) <span class="kw">and</span> l.strip() <span class="kw">in</span> src: <span class="co"># how to make sure all these ls are close to each other???</span></span>
<span id="cb186-32"><a href="#cb186-32" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:=&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb186-33"><a href="#cb186-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb186-34"><a href="#cb186-34" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb186-35"><a href="#cb186-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print out the example</span></span>
<span id="cb186-36"><a href="#cb186-36" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(defaults.eg))</span>
<span id="cb186-37"><a href="#cb186-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-38"><a href="#cb186-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb186-39"><a href="#cb186-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb186-40"><a href="#cb186-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb186-41"><a href="#cb186-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb186-42"><a href="#cb186-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-43"><a href="#cb186-43" aria-hidden="true" tabindex="-1"></a><span class="co">#         c1 = None # use it as container for colored string</span></span>
<span id="cb186-44"><a href="#cb186-44" aria-hidden="true" tabindex="-1"></a><span class="co">#         # handle comment</span></span>
<span id="cb186-45"><a href="#cb186-45" aria-hidden="true" tabindex="-1"></a><span class="co">#         if "#comment#" in c:</span></span>
<span id="cb186-46"><a href="#cb186-46" aria-hidden="true" tabindex="-1"></a><span class="co">#             _,c1 = colorize(c)</span></span>
<span id="cb186-47"><a href="#cb186-47" aria-hidden="true" tabindex="-1"></a><span class="co">#             # print('{:&gt;157}'.format(c1))   </span></span>
<span id="cb186-48"><a href="#cb186-48" aria-hidden="true" tabindex="-1"></a><span class="co">#             print(c1)</span></span>
<span id="cb186-49"><a href="#cb186-49" aria-hidden="true" tabindex="-1"></a><span class="co">#             continue</span></span>
<span id="cb186-50"><a href="#cb186-50" aria-hidden="true" tabindex="-1"></a><span class="co">#         else:</span></span>
<span id="cb186-51"><a href="#cb186-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-52"><a href="#cb186-52" aria-hidden="true" tabindex="-1"></a><span class="co">#             # c is normal string, c1 is colored string, both are without #question# or #feature# or #comment#</span></span>
<span id="cb186-53"><a href="#cb186-53" aria-hidden="true" tabindex="-1"></a><span class="co">#             c,c1 = colorize(c)</span></span>
<span id="cb186-54"><a href="#cb186-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-55"><a href="#cb186-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle a block of code</span></span>
<span id="cb186-56"><a href="#cb186-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> c: </span>
<span id="cb186-57"><a href="#cb186-57" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"Running your code block =&gt; "</span></span>
<span id="cb186-58"><a href="#cb186-58" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(c))       </span>
<span id="cb186-59"><a href="#cb186-59" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))  </span>
<span id="cb186-60"><a href="#cb186-60" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'The code block printout =&gt; : '</span>)</span>
<span id="cb186-61"><a href="#cb186-61" aria-hidden="true" tabindex="-1"></a>            block <span class="op">=</span> ast.parse(c, mode<span class="op">=</span><span class="st">'exec'</span>)</span>
<span id="cb186-62"><a href="#cb186-62" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(<span class="bu">compile</span>(block, <span class="st">'&lt;string&gt;'</span>, mode<span class="op">=</span><span class="st">'exec'</span>), <span class="bu">globals</span>().update(env))</span>
<span id="cb186-63"><a href="#cb186-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-64"><a href="#cb186-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb186-65"><a href="#cb186-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb186-66"><a href="#cb186-66" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb186-67"><a href="#cb186-67" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb186-68"><a href="#cb186-68" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c1<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb186-69"><a href="#cb186-69" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))       </span>
<span id="cb186-70"><a href="#cb186-70" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb186-71"><a href="#cb186-71" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb186-72"><a href="#cb186-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb186-73"><a href="#cb186-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb186-74"><a href="#cb186-74" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb186-75"><a href="#cb186-75" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb186-76"><a href="#cb186-76" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb186-77"><a href="#cb186-77" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb186-78"><a href="#cb186-78" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb186-79"><a href="#cb186-79" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb186-80"><a href="#cb186-80" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")      </span></span>
<span id="cb186-81"><a href="#cb186-81" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb186-82"><a href="#cb186-82" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))</span>
<span id="cb186-83"><a href="#cb186-83" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb186-84"><a href="#cb186-84" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb186-85"><a href="#cb186-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb186-86"><a href="#cb186-86" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb186-87"><a href="#cb186-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb186-88"><a href="#cb186-88" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb186-89"><a href="#cb186-89" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb186-90"><a href="#cb186-90" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb186-91"><a href="#cb186-91" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printc} : ")</span></span>
<span id="cb186-92"><a href="#cb186-92" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb186-93"><a href="#cb186-93" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))      </span>
<span id="cb186-94"><a href="#cb186-94" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb186-95"><a href="#cb186-95" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb186-96"><a href="#cb186-96" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb186-97"><a href="#cb186-97" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb186-98"><a href="#cb186-98" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")</span></span>
<span id="cb186-99"><a href="#cb186-99" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb186-100"><a href="#cb186-100" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb186-101"><a href="#cb186-101" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb186-102"><a href="#cb186-102" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb186-103"><a href="#cb186-103" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb186-104"><a href="#cb186-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c:           </span>
<span id="cb186-105"><a href="#cb186-105" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb186-106"><a href="#cb186-106" aria-hidden="true" tabindex="-1"></a>            <span class="co"># in example like 'for k, v in abc:' or `for k, v in abc: print(...)`, if abc is empty</span></span>
<span id="cb186-107"><a href="#cb186-107" aria-hidden="true" tabindex="-1"></a>            <span class="co"># step 1: access abc</span></span>
<span id="cb186-108"><a href="#cb186-108" aria-hidden="true" tabindex="-1"></a>            <span class="co"># get the substring between 'in ' and ':', which is like 'abc'</span></span>
<span id="cb186-109"><a href="#cb186-109" aria-hidden="true" tabindex="-1"></a>            abc <span class="op">=</span> re.search(<span class="st">'in (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb186-110"><a href="#cb186-110" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if abc is empty dict or list: print and pass</span></span>
<span id="cb186-111"><a href="#cb186-111" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">bool</span>(<span class="bu">eval</span>(abc)): </span>
<span id="cb186-112"><a href="#cb186-112" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f'{c} =&gt; {abc} is an emtpy {type(eval(abc))}')</span></span>
<span id="cb186-113"><a href="#cb186-113" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>abc<span class="sc">}</span><span class="ss"> is an emtpy </span><span class="sc">{</span><span class="bu">type</span>(<span class="bu">eval</span>(abc))<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb186-114"><a href="#cb186-114" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb186-115"><a href="#cb186-115" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb186-116"><a href="#cb186-116" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The break statement can be used if you need to break out of a for or while loop and move onto the next section of code.</span></span>
<span id="cb186-117"><a href="#cb186-117" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The continue statement can be used if you need to skip the current iteration of a for or while loop and move onto the next iteration.</span></span>
<span id="cb186-118"><a href="#cb186-118" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb186-119"><a href="#cb186-119" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:', there is no more code after `:`</span></span>
<span id="cb186-120"><a href="#cb186-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb186-121"><a href="#cb186-121" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb186-122"><a href="#cb186-122" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb186-123"><a href="#cb186-123" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb186-124"><a href="#cb186-124" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb186-125"><a href="#cb186-125" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb186-126"><a href="#cb186-126" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">','</span>) <span class="kw">in</span> variables: </span>
<span id="cb186-127"><a href="#cb186-127" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb186-128"><a href="#cb186-128" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb186-129"><a href="#cb186-129" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">','</span>)</span>
<span id="cb186-130"><a href="#cb186-130" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb186-131"><a href="#cb186-131" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb186-132"><a href="#cb186-132" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb186-133"><a href="#cb186-133" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb186-134"><a href="#cb186-134" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb186-135"><a href="#cb186-135" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb186-136"><a href="#cb186-136" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb186-137"><a href="#cb186-137" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb186-138"><a href="#cb186-138" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb186-139"><a href="#cb186-139" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")      </span></span>
<span id="cb186-140"><a href="#cb186-140" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb186-141"><a href="#cb186-141" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb186-142"><a href="#cb186-142" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb186-143"><a href="#cb186-143" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb186-144"><a href="#cb186-144" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb186-145"><a href="#cb186-145" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb186-146"><a href="#cb186-146" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb186-147"><a href="#cb186-147" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb186-148"><a href="#cb186-148" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")     </span></span>
<span id="cb186-149"><a href="#cb186-149" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb186-150"><a href="#cb186-150" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb186-151"><a href="#cb186-151" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb186-152"><a href="#cb186-152" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb186-153"><a href="#cb186-153" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb186-154"><a href="#cb186-154" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb186-155"><a href="#cb186-155" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb186-156"><a href="#cb186-156" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb186-157"><a href="#cb186-157" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb186-158"><a href="#cb186-158" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb186-159"><a href="#cb186-159" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) <span class="co"># we can't use eval to run `for in` loop, but exec can.</span></span>
<span id="cb186-160"><a href="#cb186-160" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc print(abc)`</span></span>
<span id="cb186-161"><a href="#cb186-161" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc if k == def`</span></span>
<span id="cb186-162"><a href="#cb186-162" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-163"><a href="#cb186-163" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle comment</span></span>
<span id="cb186-164"><a href="#cb186-164" aria-hidden="true" tabindex="-1"></a>        <span class="co"># elif "#comment#" in c:</span></span>
<span id="cb186-165"><a href="#cb186-165" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     # c,c1 = colorize(c)</span></span>
<span id="cb186-166"><a href="#cb186-166" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     print('{:&gt;157}'.format(c1))   </span></span>
<span id="cb186-167"><a href="#cb186-167" aria-hidden="true" tabindex="-1"></a>        <span class="co">#     print(c1)</span></span>
<span id="cb186-168"><a href="#cb186-168" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb186-169"><a href="#cb186-169" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb186-170"><a href="#cb186-170" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb186-171"><a href="#cb186-171" aria-hidden="true" tabindex="-1"></a>            <span class="co"># c1 is to color #feature# or #question#</span></span>
<span id="cb186-172"><a href="#cb186-172" aria-hidden="true" tabindex="-1"></a>            <span class="co"># c,c1 = colorize(c)</span></span>
<span id="cb186-173"><a href="#cb186-173" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>c1<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb186-174"><a href="#cb186-174" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb186-175"><a href="#cb186-175" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb186-176"><a href="#cb186-176" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb186-177"><a href="#cb186-177" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>clst <span class="op">=</span> <span class="st">"this is me"</span>.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>) </span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(clst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1</code></pre>
</div>
</div>
<hr>
</section>
<section id="dbcolors" class="level3">
<h3 class="anchored" data-anchor-id="dbcolors">dbcolors</h3>
<blockquote class="blockquote">
<pre><code> dbcolors ()</code></pre>
</blockquote>
<p>Initialize self. See help(type(self)) for accurate signature.</p>
<hr>
</section>
<section id="colorize" class="level3">
<h3 class="anchored" data-anchor-id="colorize">colorize</h3>
<blockquote class="blockquote">
<pre><code> colorize (cmt, color:str=None)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(colorize(<span class="st">"this is me"</span>, <span class="st">"r"</span>) <span class="op">+</span> colorize(<span class="st">"this is me"</span>, <span class="st">"y"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>this is methis is me</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>            cmt:<span class="bu">str</span>,</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k,v in` </span><span class="ch">\</span></span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># whether dbprint is working inside a for in loop or any kind of a loop</span></span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===source inside a block==="</span>))</span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))</span>
<span id="cb193-19"><a href="#cb193-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb193-20"><a href="#cb193-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(src + "&lt;===== source code =======") </span></span>
<span id="cb193-21"><a href="#cb193-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-22"><a href="#cb193-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb193-23"><a href="#cb193-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb193-24"><a href="#cb193-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('{:&gt;157}'.format("======================== source code ==========================="))</span></span>
<span id="cb193-25"><a href="#cb193-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"============================= source code ================================"</span>))</span>
<span id="cb193-26"><a href="#cb193-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))        </span>
<span id="cb193-27"><a href="#cb193-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb193-28"><a href="#cb193-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print the source code of the function</span></span>
<span id="cb193-29"><a href="#cb193-29" aria-hidden="true" tabindex="-1"></a>        lst <span class="op">=</span> defaults.src.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb193-30"><a href="#cb193-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-31"><a href="#cb193-31" aria-hidden="true" tabindex="-1"></a>        ccount <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb193-32"><a href="#cb193-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> l <span class="kw">in</span> lst: </span>
<span id="cb193-33"><a href="#cb193-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">bool</span>(l) <span class="kw">and</span> l.strip() <span class="kw">in</span> src: <span class="co"># how to make sure all these ls are close to each other???</span></span>
<span id="cb193-34"><a href="#cb193-34" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:=&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb193-35"><a href="#cb193-35" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb193-36"><a href="#cb193-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">bool</span>(cmt):</span>
<span id="cb193-37"><a href="#cb193-37" aria-hidden="true" tabindex="-1"></a>                    clst <span class="op">=</span> cmt.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>) </span>
<span id="cb193-38"><a href="#cb193-38" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> ccount <span class="op">&lt;=</span> <span class="bu">len</span>(clst)<span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb193-39"><a href="#cb193-39" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(colorize(clst[ccount])))</span>
<span id="cb193-40"><a href="#cb193-40" aria-hidden="true" tabindex="-1"></a>                        ccount <span class="op">=</span> ccount <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb193-41"><a href="#cb193-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-42"><a href="#cb193-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb193-43"><a href="#cb193-43" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb193-44"><a href="#cb193-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-45"><a href="#cb193-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print out the example</span></span>
<span id="cb193-46"><a href="#cb193-46" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(defaults.eg))</span>
<span id="cb193-47"><a href="#cb193-47" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb193-48"><a href="#cb193-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb193-49"><a href="#cb193-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb193-50"><a href="#cb193-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb193-51"><a href="#cb193-51" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb193-52"><a href="#cb193-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb193-53"><a href="#cb193-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle a block of code</span></span>
<span id="cb193-54"><a href="#cb193-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> c: </span>
<span id="cb193-55"><a href="#cb193-55" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"Running your code block =&gt; "</span></span>
<span id="cb193-56"><a href="#cb193-56" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(c))       </span>
<span id="cb193-57"><a href="#cb193-57" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))  </span>
<span id="cb193-58"><a href="#cb193-58" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'The code block printout =&gt; : '</span>)</span>
<span id="cb193-59"><a href="#cb193-59" aria-hidden="true" tabindex="-1"></a>            block <span class="op">=</span> ast.parse(c, mode<span class="op">=</span><span class="st">'exec'</span>)</span>
<span id="cb193-60"><a href="#cb193-60" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(<span class="bu">compile</span>(block, <span class="st">'&lt;string&gt;'</span>, mode<span class="op">=</span><span class="st">'exec'</span>), <span class="bu">globals</span>().update(env))</span>
<span id="cb193-61"><a href="#cb193-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb193-62"><a href="#cb193-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment</span></span>
<span id="cb193-63"><a href="#cb193-63" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">" = "</span> <span class="kw">in</span> c: <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb193-64"><a href="#cb193-64" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb193-65"><a href="#cb193-65" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb193-66"><a href="#cb193-66" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb193-67"><a href="#cb193-67" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb193-68"><a href="#cb193-68" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb193-69"><a href="#cb193-69" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c} =&gt; {variable}: {eval(variable)}")</span></span>
<span id="cb193-70"><a href="#cb193-70" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb193-71"><a href="#cb193-71" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))       </span>
<span id="cb193-72"><a href="#cb193-72" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb193-73"><a href="#cb193-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb193-74"><a href="#cb193-74" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb193-75"><a href="#cb193-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb193-76"><a href="#cb193-76" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb193-77"><a href="#cb193-77" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb193-78"><a href="#cb193-78" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb193-79"><a href="#cb193-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb193-80"><a href="#cb193-80" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb193-81"><a href="#cb193-81" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb193-82"><a href="#cb193-82" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")      </span></span>
<span id="cb193-83"><a href="#cb193-83" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb193-84"><a href="#cb193-84" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))</span>
<span id="cb193-85"><a href="#cb193-85" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb193-86"><a href="#cb193-86" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb193-87"><a href="#cb193-87" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb193-88"><a href="#cb193-88" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb193-89"><a href="#cb193-89" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb193-90"><a href="#cb193-90" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb193-91"><a href="#cb193-91" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb193-92"><a href="#cb193-92" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb193-93"><a href="#cb193-93" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printc} : ")</span></span>
<span id="cb193-94"><a href="#cb193-94" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb193-95"><a href="#cb193-95" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))      </span>
<span id="cb193-96"><a href="#cb193-96" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb193-97"><a href="#cb193-97" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb193-98"><a href="#cb193-98" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb193-99"><a href="#cb193-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb193-100"><a href="#cb193-100" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")</span></span>
<span id="cb193-101"><a href="#cb193-101" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb193-102"><a href="#cb193-102" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb193-103"><a href="#cb193-103" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb193-104"><a href="#cb193-104" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb193-105"><a href="#cb193-105" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb193-106"><a href="#cb193-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c:           </span>
<span id="cb193-107"><a href="#cb193-107" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb193-108"><a href="#cb193-108" aria-hidden="true" tabindex="-1"></a>            <span class="co"># in example like 'for k, v in abc:' or `for k, v in abc: print(...)`, if abc is empty</span></span>
<span id="cb193-109"><a href="#cb193-109" aria-hidden="true" tabindex="-1"></a>            <span class="co"># step 1: access abc</span></span>
<span id="cb193-110"><a href="#cb193-110" aria-hidden="true" tabindex="-1"></a>            <span class="co"># get the substring between 'in ' and ':', which is like 'abc'</span></span>
<span id="cb193-111"><a href="#cb193-111" aria-hidden="true" tabindex="-1"></a>            abc <span class="op">=</span> re.search(<span class="st">'in (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb193-112"><a href="#cb193-112" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if abc is empty dict or list: print and pass</span></span>
<span id="cb193-113"><a href="#cb193-113" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">bool</span>(<span class="bu">eval</span>(abc)): </span>
<span id="cb193-114"><a href="#cb193-114" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f'{c} =&gt; {abc} is an emtpy {type(eval(abc))}')</span></span>
<span id="cb193-115"><a href="#cb193-115" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>abc<span class="sc">}</span><span class="ss"> is an emtpy </span><span class="sc">{</span><span class="bu">type</span>(<span class="bu">eval</span>(abc))<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb193-116"><a href="#cb193-116" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb193-117"><a href="#cb193-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span> </span>
<span id="cb193-118"><a href="#cb193-118" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The break statement can be used if you need to break out of a for or while loop and move onto the next section of code.</span></span>
<span id="cb193-119"><a href="#cb193-119" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The continue statement can be used if you need to skip the current iteration of a for or while loop and move onto the next iteration.</span></span>
<span id="cb193-120"><a href="#cb193-120" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb193-121"><a href="#cb193-121" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:', there is no more code after `:`</span></span>
<span id="cb193-122"><a href="#cb193-122" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb193-123"><a href="#cb193-123" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb193-124"><a href="#cb193-124" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb193-125"><a href="#cb193-125" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb193-126"><a href="#cb193-126" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb193-127"><a href="#cb193-127" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb193-128"><a href="#cb193-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">','</span>) <span class="kw">in</span> variables: </span>
<span id="cb193-129"><a href="#cb193-129" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb193-130"><a href="#cb193-130" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb193-131"><a href="#cb193-131" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">','</span>)</span>
<span id="cb193-132"><a href="#cb193-132" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb193-133"><a href="#cb193-133" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb193-134"><a href="#cb193-134" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb193-135"><a href="#cb193-135" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb193-136"><a href="#cb193-136" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb193-137"><a href="#cb193-137" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb193-138"><a href="#cb193-138" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb193-139"><a href="#cb193-139" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb193-140"><a href="#cb193-140" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb193-141"><a href="#cb193-141" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")      </span></span>
<span id="cb193-142"><a href="#cb193-142" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb193-143"><a href="#cb193-143" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb193-144"><a href="#cb193-144" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb193-145"><a href="#cb193-145" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb193-146"><a href="#cb193-146" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb193-147"><a href="#cb193-147" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb193-148"><a href="#cb193-148" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb193-149"><a href="#cb193-149" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb193-150"><a href="#cb193-150" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")     </span></span>
<span id="cb193-151"><a href="#cb193-151" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb193-152"><a href="#cb193-152" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb193-153"><a href="#cb193-153" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb193-154"><a href="#cb193-154" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb193-155"><a href="#cb193-155" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb193-156"><a href="#cb193-156" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb193-157"><a href="#cb193-157" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb193-158"><a href="#cb193-158" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb193-159"><a href="#cb193-159" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f"{c} =&gt; {printc} : ")</span></span>
<span id="cb193-160"><a href="#cb193-160" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb193-161"><a href="#cb193-161" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb193-162"><a href="#cb193-162" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) <span class="co"># we can't use eval to run `for in` loop, but exec can.</span></span>
<span id="cb193-163"><a href="#cb193-163" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc print(abc)`</span></span>
<span id="cb193-164"><a href="#cb193-164" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc if k == def`</span></span>
<span id="cb193-165"><a href="#cb193-165" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb193-166"><a href="#cb193-166" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb193-167"><a href="#cb193-167" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb193-168"><a href="#cb193-168" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb193-169"><a href="#cb193-169" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c} =&gt; {c} : {eval(c, globals().update(env))}") </span></span>
<span id="cb193-170"><a href="#cb193-170" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb193-171"><a href="#cb193-171" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb193-172"><a href="#cb193-172" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb193-173"><a href="#cb193-173" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb193-174"><a href="#cb193-174" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-feature-when-handling-assignment-2.-when-occur-before-if-1.-when-no-if-only" class="level3">
<h3 class="anchored" data-anchor-id="add-feature-when-handling-assignment-2.-when-occur-before-if-1.-when-no-if-only">add feature when handling assignment: 2. when = occur before if; 1. when no if only =</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbprint(src:<span class="bu">str</span>, <span class="co"># the source to debug in str</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>            cmt:<span class="bu">str</span>,</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>code,   <span class="co"># a number of codes to run, each code is in str, e.g., "a + b", "c = a - b"</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>            <span class="op">**</span>env</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>           ):  <span class="co"># a number of stuff needed to run the code, e.g. var1 = var1, func1 = func1</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Insert and run your codes and give readable output during debugging. Caution 1: </span><span class="ch">\</span></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a><span class="co">    avoid using the same variable name used in both global and local scopes, e.g., </span><span class="ch">\</span></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a><span class="co">    use `k` in the func and use `k` again inside a for loop inside the func.</span><span class="ch">\</span></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Caution 2: make sure to include all the necessary env variables to avoid </span><span class="ch">\</span></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a><span class="co">    the same variable with different values from different scopes. Caution 3: when an env variable is updated, </span><span class="ch">\</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a><span class="co">    then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., `for k,v in` </span><span class="ch">\</span></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a><span class="co">    and `a = createsth(...)`"</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Inside the source code, ff you ever add a block of multiline codes like `for in` or `if`, and run dbprint for each line of the block, then set </span></span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># defaults.block to True</span></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.block <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">"===source inside a block==="</span>))</span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(src))</span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(src + "&lt;===== source code =======") </span></span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('{:&gt;157}'.format("======================== source code ==========================="))</span></span>
<span id="cb194-26"><a href="#cb194-26" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:#^157}</span><span class="st">'</span>.<span class="bu">format</span>(<span class="st">" source code with lines under investigation "</span>))</span>
<span id="cb194-27"><a href="#cb194-27" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb194-28"><a href="#cb194-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print('{:&lt;157}'.format(src))        </span></span>
<span id="cb194-29"><a href="#cb194-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb194-30"><a href="#cb194-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print the source code of the function</span></span>
<span id="cb194-31"><a href="#cb194-31" aria-hidden="true" tabindex="-1"></a>        lst <span class="op">=</span> defaults.src.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb194-32"><a href="#cb194-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-33"><a href="#cb194-33" aria-hidden="true" tabindex="-1"></a>        ccount <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb194-34"><a href="#cb194-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> l <span class="kw">in</span> lst: </span>
<span id="cb194-35"><a href="#cb194-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">bool</span>(l) <span class="kw">and</span> l.strip() <span class="kw">in</span> src: <span class="co"># how to make sure all these ls are close to each other???</span></span>
<span id="cb194-36"><a href="#cb194-36" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:=&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb194-37"><a href="#cb194-37" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb194-38"><a href="#cb194-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">bool</span>(cmt):</span>
<span id="cb194-39"><a href="#cb194-39" aria-hidden="true" tabindex="-1"></a>                    clst <span class="op">=</span> cmt.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>) </span>
<span id="cb194-40"><a href="#cb194-40" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> ccount <span class="op">&lt;=</span> <span class="bu">len</span>(clst)<span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb194-41"><a href="#cb194-41" aria-hidden="true" tabindex="-1"></a>                        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(colorize(clst[ccount], <span class="st">"r"</span>)))</span>
<span id="cb194-42"><a href="#cb194-42" aria-hidden="true" tabindex="-1"></a>                        ccount <span class="op">=</span> ccount <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb194-43"><a href="#cb194-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-44"><a href="#cb194-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb194-45"><a href="#cb194-45" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb194-46"><a href="#cb194-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-47"><a href="#cb194-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print out the example</span></span>
<span id="cb194-48"><a href="#cb194-48" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(defaults.eg))</span>
<span id="cb194-49"><a href="#cb194-49" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb194-50"><a href="#cb194-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb194-51"><a href="#cb194-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># trial and error version for real code, still not quite why globals vs locals work in exec and eval</span></span>
<span id="cb194-52"><a href="#cb194-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> c <span class="kw">in</span> code:</span>
<span id="cb194-53"><a href="#cb194-53" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb194-54"><a href="#cb194-54" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb194-55"><a href="#cb194-55" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle a block of code</span></span>
<span id="cb194-56"><a href="#cb194-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="kw">in</span> c: </span>
<span id="cb194-57"><a href="#cb194-57" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"Running your code block =&gt; "</span></span>
<span id="cb194-58"><a href="#cb194-58" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(c))       </span>
<span id="cb194-59"><a href="#cb194-59" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))  </span>
<span id="cb194-60"><a href="#cb194-60" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'The code block printout =&gt; : '</span>)</span>
<span id="cb194-61"><a href="#cb194-61" aria-hidden="true" tabindex="-1"></a>            block <span class="op">=</span> ast.parse(c, mode<span class="op">=</span><span class="st">'exec'</span>)</span>
<span id="cb194-62"><a href="#cb194-62" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(<span class="bu">compile</span>(block, <span class="st">'&lt;string&gt;'</span>, mode<span class="op">=</span><span class="st">'exec'</span>), <span class="bu">globals</span>().update(env))</span>
<span id="cb194-63"><a href="#cb194-63" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb194-64"><a href="#cb194-64" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle assignment: 2. when = occur before if; 1. when no if only =</span></span>
<span id="cb194-65"><a href="#cb194-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> (<span class="st">"="</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">"if"</span> <span class="kw">not</span> <span class="kw">in</span> c) <span class="kw">or</span> (<span class="st">"="</span> <span class="kw">in</span> c <span class="kw">and</span> c.find(<span class="st">"="</span>) <span class="op">&lt;</span> c.find(<span class="st">"if"</span>)): <span class="co"># make sure assignment and !== and == are differentiated</span></span>
<span id="cb194-66"><a href="#cb194-66" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb194-67"><a href="#cb194-67" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb194-68"><a href="#cb194-68" aria-hidden="true" tabindex="-1"></a>            <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) </span>
<span id="cb194-69"><a href="#cb194-69" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print('k' in locals())</span></span>
<span id="cb194-70"><a href="#cb194-70" aria-hidden="true" tabindex="-1"></a>            variable <span class="op">=</span> c.partition(<span class="st">" = "</span>)[<span class="dv">0</span>]</span>
<span id="cb194-71"><a href="#cb194-71" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c} =&gt; {variable}: {eval(variable)}")</span></span>
<span id="cb194-72"><a href="#cb194-72" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(variable)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb194-73"><a href="#cb194-73" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))       </span>
<span id="cb194-74"><a href="#cb194-74" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb194-75"><a href="#cb194-75" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle if statement</span></span>
<span id="cb194-76"><a href="#cb194-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: do insert code like this : `if abc == def: print(abc)`, print is a must</span></span>
<span id="cb194-77"><a href="#cb194-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"if"</span> <span class="kw">in</span> c: </span>
<span id="cb194-78"><a href="#cb194-78" aria-hidden="true" tabindex="-1"></a>            cond <span class="op">=</span> re.search(<span class="st">'if (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb194-79"><a href="#cb194-79" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb194-80"><a href="#cb194-80" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def:'</span></span>
<span id="cb194-81"><a href="#cb194-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb194-82"><a href="#cb194-82" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb194-83"><a href="#cb194-83" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print ... </span></span>
<span id="cb194-84"><a href="#cb194-84" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")      </span></span>
<span id="cb194-85"><a href="#cb194-85" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb194-86"><a href="#cb194-86" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))</span>
<span id="cb194-87"><a href="#cb194-87" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb194-88"><a href="#cb194-88" aria-hidden="true" tabindex="-1"></a>            <span class="co"># when code in string is like 'if abc == def: print(...)'</span></span>
<span id="cb194-89"><a href="#cb194-89" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb194-90"><a href="#cb194-90" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if the cond is true, then print ...</span></span>
<span id="cb194-91"><a href="#cb194-91" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">eval</span>(cond):</span>
<span id="cb194-92"><a href="#cb194-92" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb194-93"><a href="#cb194-93" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># "if abc == def: print(abc)".split(': ', 2)[1] to get 'print(abc)'</span></span>
<span id="cb194-94"><a href="#cb194-94" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb194-95"><a href="#cb194-95" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printc} : ")</span></span>
<span id="cb194-96"><a href="#cb194-96" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb194-97"><a href="#cb194-97" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))      </span>
<span id="cb194-98"><a href="#cb194-98" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env))</span>
<span id="cb194-99"><a href="#cb194-99" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb194-100"><a href="#cb194-100" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if cond is false, then print ...</span></span>
<span id="cb194-101"><a href="#cb194-101" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>: </span>
<span id="cb194-102"><a href="#cb194-102" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {cond}: {eval(cond)}")</span></span>
<span id="cb194-103"><a href="#cb194-103" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>cond<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span><span class="bu">eval</span>(cond)<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb194-104"><a href="#cb194-104" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb194-105"><a href="#cb194-105" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb194-106"><a href="#cb194-106" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb194-107"><a href="#cb194-107" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle for in statement</span></span>
<span id="cb194-108"><a href="#cb194-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="st">"for "</span> <span class="kw">in</span> c <span class="kw">and</span> <span class="st">" in "</span> <span class="kw">in</span> c:           </span>
<span id="cb194-109"><a href="#cb194-109" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb194-110"><a href="#cb194-110" aria-hidden="true" tabindex="-1"></a>            <span class="co"># in example like 'for k, v in abc:' or `for k, v in abc: print(...)`, if abc is empty</span></span>
<span id="cb194-111"><a href="#cb194-111" aria-hidden="true" tabindex="-1"></a>            <span class="co"># step 1: access abc</span></span>
<span id="cb194-112"><a href="#cb194-112" aria-hidden="true" tabindex="-1"></a>            <span class="co"># get the substring between 'in ' and ':', which is like 'abc'</span></span>
<span id="cb194-113"><a href="#cb194-113" aria-hidden="true" tabindex="-1"></a>            abc <span class="op">=</span> re.search(<span class="st">'in (.*?):'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb194-114"><a href="#cb194-114" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if abc is empty dict or list: print and pass</span></span>
<span id="cb194-115"><a href="#cb194-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> <span class="bu">bool</span>(<span class="bu">eval</span>(abc)): </span>
<span id="cb194-116"><a href="#cb194-116" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f'{c} =&gt; {abc} is an emtpy {type(eval(abc))}')</span></span>
<span id="cb194-117"><a href="#cb194-117" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>abc<span class="sc">}</span><span class="ss"> is an emtpy </span><span class="sc">{</span><span class="bu">type</span>(<span class="bu">eval</span>(abc))<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb194-118"><a href="#cb194-118" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb194-119"><a href="#cb194-119" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span> </span>
<span id="cb194-120"><a href="#cb194-120" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The break statement can be used if you need to break out of a for or while loop and move onto the next section of code.</span></span>
<span id="cb194-121"><a href="#cb194-121" aria-hidden="true" tabindex="-1"></a>                <span class="co"># The continue statement can be used if you need to skip the current iteration of a for or while loop and move onto the next iteration.</span></span>
<span id="cb194-122"><a href="#cb194-122" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb194-123"><a href="#cb194-123" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc:', there is no more code after `:`</span></span>
<span id="cb194-124"><a href="#cb194-124" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> c.endswith(<span class="st">':'</span>):</span>
<span id="cb194-125"><a href="#cb194-125" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb194-126"><a href="#cb194-126" aria-hidden="true" tabindex="-1"></a>                <span class="co"># get the substring between 'for ' and ' in', which is like 'k, v'</span></span>
<span id="cb194-127"><a href="#cb194-127" aria-hidden="true" tabindex="-1"></a>                variables <span class="op">=</span> re.search(<span class="st">'for (.*?) in'</span>, c).group(<span class="dv">1</span>)</span>
<span id="cb194-128"><a href="#cb194-128" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb194-129"><a href="#cb194-129" aria-hidden="true" tabindex="-1"></a>                <span class="co"># if variables has a substring like ', ' inside</span></span>
<span id="cb194-130"><a href="#cb194-130" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">','</span>) <span class="kw">in</span> variables: </span>
<span id="cb194-131"><a href="#cb194-131" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb194-132"><a href="#cb194-132" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># split it by ', ' into a list of substrings</span></span>
<span id="cb194-133"><a href="#cb194-133" aria-hidden="true" tabindex="-1"></a>                    vl <span class="op">=</span> variables.split(<span class="st">','</span>)</span>
<span id="cb194-134"><a href="#cb194-134" aria-hidden="true" tabindex="-1"></a>                    key <span class="op">=</span> vl[<span class="dv">0</span>]</span>
<span id="cb194-135"><a href="#cb194-135" aria-hidden="true" tabindex="-1"></a>                    value <span class="op">=</span> vl[<span class="dv">1</span>]</span>
<span id="cb194-136"><a href="#cb194-136" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb194-137"><a href="#cb194-137" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># make sure key and value will get evaluated first before exec run</span></span>
<span id="cb194-138"><a href="#cb194-138" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printc is for exec to run</span></span>
<span id="cb194-139"><a href="#cb194-139" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{key}</span><span class="st">:{eval(key)}, {type(eval(key))} ; </span><span class="sc">{value}</span><span class="st">:{eval(value)}, {type(eval(value))}')"</span> </span>
<span id="cb194-140"><a href="#cb194-140" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># printmsg is for reader to understand with ease</span></span>
<span id="cb194-141"><a href="#cb194-141" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'key: </span><span class="sc">{key}</span><span class="st">, {type(key)} ; value: </span><span class="sc">{value}</span><span class="st">, {type(value)}')"</span></span>
<span id="cb194-142"><a href="#cb194-142" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb194-143"><a href="#cb194-143" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")      </span></span>
<span id="cb194-144"><a href="#cb194-144" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb194-145"><a href="#cb194-145" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb194-146"><a href="#cb194-146" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb194-147"><a href="#cb194-147" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb194-148"><a href="#cb194-148" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb194-149"><a href="#cb194-149" aria-hidden="true" tabindex="-1"></a>                    printc <span class="op">=</span> <span class="st">"print(f'</span><span class="sc">{variables}</span><span class="st"> : {eval(variables)}')"</span></span>
<span id="cb194-150"><a href="#cb194-150" aria-hidden="true" tabindex="-1"></a>                    printmsg <span class="op">=</span> <span class="st">"print(f'i : </span><span class="sc">{variables}</span><span class="st">')"</span></span>
<span id="cb194-151"><a href="#cb194-151" aria-hidden="true" tabindex="-1"></a>                    c1 <span class="op">=</span> c <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> printc</span>
<span id="cb194-152"><a href="#cb194-152" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># print(f"{c} =&gt; {printmsg} : ")     </span></span>
<span id="cb194-153"><a href="#cb194-153" aria-hidden="true" tabindex="-1"></a>                    output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printmsg<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb194-154"><a href="#cb194-154" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb194-155"><a href="#cb194-155" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">exec</span>(c1, <span class="bu">globals</span>().update(env))</span>
<span id="cb194-156"><a href="#cb194-156" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb194-157"><a href="#cb194-157" aria-hidden="true" tabindex="-1"></a>            <span class="co"># if the code in string is like 'for k, v in abc: print(abc)'</span></span>
<span id="cb194-158"><a href="#cb194-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:                 </span>
<span id="cb194-159"><a href="#cb194-159" aria-hidden="true" tabindex="-1"></a>                <span class="co"># "for k, v in abc: print(k)".split(': ', 1)[1] to get 'print(k)'</span></span>
<span id="cb194-160"><a href="#cb194-160" aria-hidden="true" tabindex="-1"></a>                printc <span class="op">=</span> c.split(<span class="st">': '</span>, <span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb194-161"><a href="#cb194-161" aria-hidden="true" tabindex="-1"></a>                <span class="co"># print(f"{c} =&gt; {printc} : ")</span></span>
<span id="cb194-162"><a href="#cb194-162" aria-hidden="true" tabindex="-1"></a>                output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>printc<span class="sc">}</span><span class="ss"> : "</span></span>
<span id="cb194-163"><a href="#cb194-163" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb194-164"><a href="#cb194-164" aria-hidden="true" tabindex="-1"></a>                <span class="bu">exec</span>(c, <span class="bu">globals</span>().update(env)) <span class="co"># we can't use eval to run `for in` loop, but exec can.</span></span>
<span id="cb194-165"><a href="#cb194-165" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc print(abc)`</span></span>
<span id="cb194-166"><a href="#cb194-166" aria-hidden="true" tabindex="-1"></a>            <span class="co">### Note: we shall not use the expression like `for k, v in abc if k == def`</span></span>
<span id="cb194-167"><a href="#cb194-167" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb194-168"><a href="#cb194-168" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb194-169"><a href="#cb194-169" aria-hidden="true" tabindex="-1"></a>        <span class="co"># handle evaluation</span></span>
<span id="cb194-170"><a href="#cb194-170" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb194-171"><a href="#cb194-171" aria-hidden="true" tabindex="-1"></a>            <span class="co"># print(f"{c} =&gt; {c} : {eval(c, globals().update(env))}") </span></span>
<span id="cb194-172"><a href="#cb194-172" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> =&gt; </span><span class="sc">{</span>c<span class="sc">}</span><span class="ss"> : </span><span class="sc">{</span><span class="bu">eval</span>(c, <span class="bu">globals</span>().update(env))<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb194-173"><a href="#cb194-173" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&gt;157}</span><span class="st">'</span>.<span class="bu">format</span>(output))   </span>
<span id="cb194-174"><a href="#cb194-174" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb194-175"><a href="#cb194-175" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the benefit of using global().update(env) is </span></span>
<span id="cb194-176"><a href="#cb194-176" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to ensure we don't need to include the same env for the second time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="alignright-the-colored-comment" class="level3">
<h3 class="anchored" data-anchor-id="alignright-the-colored-comment">alignright the colored comment</h3>
<hr>
</section>
<section id="dbprint" class="level3">
<h3 class="anchored" data-anchor-id="dbprint">dbprint</h3>
<blockquote class="blockquote">
<pre><code> dbprint (src:str, cmt:str, *code, **env)</code></pre>
</blockquote>
<p>Insert and run your codes and give readable output during debugging. Caution 1: avoid using the same variable name used in both global and local scopes, e.g., use <code>k</code> in the func and use <code>k</code> again inside a for loop inside the func. Caution 2: make sure to include all the necessary env variables to avoid the same variable with different values from different scopes. Caution 3: when an env variable is updated, then you need to includ it again in the next dbprint. Caution 4: be strict on the spaces, e.g., <code>for k,v in</code> and <code>a = createsth(...)</code></p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>src</td>
<td>str</td>
<td>the source to debug in str</td>
</tr>
<tr class="even">
<td>cmt</td>
<td>str</td>
<td></td>
</tr>
<tr class="odd">
<td>code</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>env</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="insert-dbprint-and-make-a-new-source-function-for-debugging-line-by-line" class="level2">
<h2 class="anchored" data-anchor-id="insert-dbprint-and-make-a-new-source-function-for-debugging-line-by-line">insert dbprint and make a new source function for debugging line by line</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert2debug(name:<span class="bu">str</span>, <span class="co"># name of a function to debug, e.g., delegates</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>                 srcline:<span class="bu">str</span>, <span class="co"># e.g., "        if hasattr(from_f,'__delwrap__'): return f"</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>                 dbcode:<span class="bu">str</span>,  <span class="co"># str, e.g., "dbprint(...)"</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>                 <span class="op">**</span>env):</span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"select a line or a block of source code and insert a dbprint above it and only output this dbprint result."</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>    srcode <span class="op">=</span> inspect.getsource(<span class="bu">eval</span>(name, <span class="bu">globals</span>().update(env)))</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>    lstxt <span class="op">=</span> srcode.split(srcline)</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>    retn <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">        return None</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>    insert <span class="op">=</span> colorize(dbcode, <span class="st">"g"</span>) <span class="op">+</span> colorize(srcline, <span class="st">"r"</span>) <span class="op">+</span> colorize(retn, <span class="st">"y"</span>)</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>    src2print <span class="op">=</span> lstxt[<span class="dv">0</span>] <span class="op">+</span> insert <span class="op">+</span> lstxt[<span class="dv">1</span>]</span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> src2print.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>):  <span class="co"># print out the debuggable version of delegates</span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(l)</span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a>    src2db <span class="op">=</span> lstxt[<span class="dv">0</span>] <span class="op">+</span> dbcode <span class="op">+</span> srcline <span class="op">+</span> retn <span class="op">+</span> lstxt[<span class="dv">1</span>]</span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">exec</span>(src2db, <span class="bu">globals</span>().update({<span class="st">'srcline'</span>: srcline})) <span class="co"># now a debuggable version of delegates is available to use</span></span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">globals</span>().update({name:<span class="bu">eval</span>(name)})</span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">eval</span>(name) <span class="co"># give this debuggable version of delegates to the notebook context</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>insert2debug??</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span> insert2debug<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">:</span> str<span class="ansi-blue-fg">,</span> srcline<span class="ansi-blue-fg">:</span> str<span class="ansi-blue-fg">,</span> dbcode<span class="ansi-blue-fg">:</span> str<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>env<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
<span class="ansi-green-fg">def</span> insert2debug<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">:</span>str<span class="ansi-blue-fg">,</span> <span class="ansi-red-fg"># name of a function to debug, e.g., delegates</span>
                 srcline<span class="ansi-blue-fg">:</span>str<span class="ansi-blue-fg">,</span> <span class="ansi-red-fg"># e.g., "        if hasattr(from_f,'__delwrap__'): return f"</span>
                 dbcode<span class="ansi-blue-fg">:</span>str<span class="ansi-blue-fg">,</span>  <span class="ansi-red-fg"># str, e.g., "dbprint(...)"</span>
                 <span class="ansi-blue-fg">**</span>env<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
    <span class="ansi-blue-fg">"select a line or a block of source code and insert a dbprint above it and only output this dbprint result."</span>
    srcode <span class="ansi-blue-fg">=</span> inspect<span class="ansi-blue-fg">.</span>getsource<span class="ansi-blue-fg">(</span>eval<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">,</span> globals<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span>env<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
    lstxt <span class="ansi-blue-fg">=</span> srcode<span class="ansi-blue-fg">.</span>split<span class="ansi-blue-fg">(</span>srcline<span class="ansi-blue-fg">)</span>
    retn <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">"\n        return None\n"</span>
    insert <span class="ansi-blue-fg">=</span> colorize<span class="ansi-blue-fg">(</span>dbcode<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">"g"</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> colorize<span class="ansi-blue-fg">(</span>srcline<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">"r"</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> colorize<span class="ansi-blue-fg">(</span>retn<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">"y"</span><span class="ansi-blue-fg">)</span>
    src2print <span class="ansi-blue-fg">=</span> lstxt<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">+</span> insert <span class="ansi-blue-fg">+</span> lstxt<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span>
    <span class="ansi-green-fg">for</span> l <span class="ansi-green-fg">in</span> src2print<span class="ansi-blue-fg">.</span>split<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">"\n"</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>  <span class="ansi-red-fg"># print out the debuggable version of delegates</span>
        print<span class="ansi-blue-fg">(</span>l<span class="ansi-blue-fg">)</span>
    src2db <span class="ansi-blue-fg">=</span> lstxt<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">+</span> dbcode <span class="ansi-blue-fg">+</span> srcline <span class="ansi-blue-fg">+</span> retn <span class="ansi-blue-fg">+</span> lstxt<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span>
    exec<span class="ansi-blue-fg">(</span>src2db<span class="ansi-blue-fg">,</span> globals<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">'srcline'</span><span class="ansi-blue-fg">:</span> srcline<span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-red-fg"># now a debuggable version of delegates is available to use</span>
    globals<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">{</span>name<span class="ansi-blue-fg">:</span>eval<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">return</span> eval<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">)</span> <span class="ansi-red-fg"># give this debuggable version of delegates to the notebook context</span>
<span class="ansi-red-fg">File:</span>      /var/folders/gz/ch3n2mp51m9386sytqf97s6w0000gn/T/ipykernel_18154/435102324.py
<span class="ansi-red-fg">Type:</span>      function
</pre>
</div>
</div>
</div>
<section id="remove-return-none-so-that-we-can-run-multiple-delegates-in-one-cell-without-error" class="level3">
<h3 class="anchored" data-anchor-id="remove-return-none-so-that-we-can-run-multiple-delegates-in-one-cell-without-error">remove <code>return None</code>, so that we can run multiple <code>delegates</code> in one cell without error</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert2debug(name:<span class="bu">str</span>, <span class="co"># name of a function to debug, e.g., delegates</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>                 srcline:<span class="bu">str</span>, <span class="co"># e.g., "        if hasattr(from_f,'__delwrap__'): return f"</span></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                 dbcode:<span class="bu">str</span>,  <span class="co"># str, e.g., "dbprint(...)"</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>                 <span class="op">**</span>env):</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"select a line or a block of source code and insert a dbprint above it and only output this dbprint result."</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>    srcode <span class="op">=</span> inspect.getsource(<span class="bu">eval</span>(name, <span class="bu">globals</span>().update(env)))</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>    lstxt <span class="op">=</span> srcode.split(srcline)</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># retn = "\n        return None\n"</span></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>    retn <span class="op">=</span> <span class="st">""</span></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>    insert <span class="op">=</span> colorize(dbcode, <span class="st">"g"</span>) <span class="op">+</span> colorize(srcline, <span class="st">"r"</span>) <span class="op">+</span> colorize(retn, <span class="st">"y"</span>)</span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>    src2print <span class="op">=</span> lstxt[<span class="dv">0</span>] <span class="op">+</span> insert <span class="op">+</span> lstxt[<span class="dv">1</span>]</span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> src2print.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>):  <span class="co"># print out the debuggable version of delegates</span></span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(l)</span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>    src2db <span class="op">=</span> lstxt[<span class="dv">0</span>] <span class="op">+</span> dbcode <span class="op">+</span> srcline <span class="op">+</span> retn <span class="op">+</span> lstxt[<span class="dv">1</span>]</span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">exec</span>(src2db, <span class="bu">globals</span>().update({<span class="st">'srcline'</span>: srcline})) <span class="co"># now a debuggable version of delegates is available to use</span></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># globals().update({name:eval(name)})</span></span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">eval</span>(name) <span class="co"># give this debuggable version of delegates to the notebook context</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert2debug(name:<span class="bu">str</span>, <span class="co"># name of a function to debug, e.g., delegates</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>                 srcline:<span class="bu">str</span>, <span class="co"># e.g., "        if hasattr(from_f,'__delwrap__'): return f"</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>                 dbcode:<span class="bu">str</span>,  <span class="co"># str, e.g., "dbprint(...)"</span></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>                 <span class="op">**</span>env):</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"select a line or a block of source code and insert a dbprint above it and only output this dbprint result."</span></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># defaults.multi default to False, unless set True, defaults.deb is default to None before debugging srcode</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.multi <span class="kw">and</span> <span class="bu">bool</span>(defaults.deb): </span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>        srcode <span class="op">=</span> defaults.deb</span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># srcode = inspect.getsource(eval(name, globals().update(env)))</span></span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>        srcode <span class="op">=</span> defaults.src</span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>    lstxt <span class="op">=</span> srcode.split(srcline)</span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a>    retn <span class="op">=</span> <span class="st">""</span> <span class="co"># retn = "\n        return None\n" to exit the function, "" to continue on</span></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a>    insert <span class="op">=</span> colorize(dbcode, <span class="st">"g"</span>) <span class="op">+</span> colorize(srcline, <span class="st">"r"</span>) <span class="op">+</span> colorize(retn, <span class="st">"y"</span>)</span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a>    src2print <span class="op">=</span> lstxt[<span class="dv">0</span>] <span class="op">+</span> insert <span class="op">+</span> lstxt[<span class="dv">1</span>]</span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> src2print.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>):  <span class="co"># print out the debuggable version of delegates</span></span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(l)</span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a>    src2db <span class="op">=</span> lstxt[<span class="dv">0</span>] <span class="op">+</span> dbcode <span class="op">+</span> srcline <span class="op">+</span> retn <span class="op">+</span> lstxt[<span class="dv">1</span>]</span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.multi: defaults.deb <span class="op">=</span> src2db</span>
<span id="cb199-21"><a href="#cb199-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">exec</span>(src2db, <span class="bu">globals</span>().update({<span class="st">'srcline'</span>: srcline})) <span class="co"># now a debuggable version of delegates is available to use</span></span>
<span id="cb199-22"><a href="#cb199-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># globals().update({name:eval(name)})</span></span>
<span id="cb199-23"><a href="#cb199-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">eval</span>(name) <span class="co"># give this debuggable version of delegates to the notebook context</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="major-problems-solved" class="level3">
<h3 class="anchored" data-anchor-id="major-problems-solved">major problems solved</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert2debug(name:<span class="bu">str</span>, <span class="co"># name of a function to debug, e.g., delegates</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>                 srcline:<span class="bu">str</span>, <span class="co"># e.g., "        if hasattr(from_f,'__delwrap__'): return f"</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>                 dbcode:<span class="bu">str</span>,  <span class="co"># str, e.g., "dbprint(...)"</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>                 run:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, <span class="co"># run exec or not</span></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>                 <span class="op">**</span>env):</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"select a line or a block of source code and insert a dbprint above it and only output this dbprint result."</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># defaults.multi default to False, unless set True, defaults.deb is default to None before debugging srcode</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> defaults.multi <span class="kw">and</span> <span class="bu">bool</span>(defaults.deb): </span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>        srcode <span class="op">=</span> defaults.deb</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># srcode = inspect.getsource(eval(name, globals().update(env)))</span></span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a>        srcode <span class="op">=</span> defaults.src</span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a>    lstxt <span class="op">=</span> srcode.split(srcline)</span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a>    retn <span class="op">=</span> <span class="st">""</span> <span class="co"># retn = "\n        return None\n" to exit the function, "" to continue on</span></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a>    insert <span class="op">=</span> colorize(dbcode, <span class="st">"g"</span>) <span class="op">+</span> colorize(srcline, <span class="st">"r"</span>) <span class="op">+</span> colorize(retn, <span class="st">"y"</span>)</span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a>    src2print <span class="op">=</span> lstxt[<span class="dv">0</span>] <span class="op">+</span> insert <span class="op">+</span> lstxt[<span class="dv">1</span>]</span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a>    src2db <span class="op">=</span> lstxt[<span class="dv">0</span>] <span class="op">+</span> dbcode <span class="op">+</span> srcline <span class="op">+</span> retn <span class="op">+</span> lstxt[<span class="dv">1</span>]</span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if defaults.multi: defaults.deb = src2db</span></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a>    defaults.deb <span class="op">=</span> src2db</span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># to exec </span></span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> run: </span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a>        <span class="bu">exec</span>(src2db, <span class="bu">globals</span>().update({<span class="st">'srcline'</span>: srcline})) <span class="co"># now a debuggable version of delegates is available to use</span></span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># globals().update({name:eval(name)})</span></span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">eval</span>(name) <span class="co"># give this debuggable version of delegates to the notebook context</span></span>
<span id="cb200-28"><a href="#cb200-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># to not exec but only get the full debuggable source </span></span>
<span id="cb200-29"><a href="#cb200-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb200-30"><a href="#cb200-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="debugging-error" class="level3">
<h3 class="anchored" data-anchor-id="debugging-error">debugging error</h3>
<hr>
</section>
<section id="insert2debug" class="level3">
<h3 class="anchored" data-anchor-id="insert2debug">insert2debug</h3>
<blockquote class="blockquote">
<pre><code> insert2debug (name:str, srcline:str, dbcode:str, run:bool=True,
               dberror:bool=False, **env)</code></pre>
</blockquote>
<p>select a line or a block of source code and insert a dbprint above it and only output this dbprint result.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>name</td>
<td>str</td>
<td></td>
<td>name of a function to debug, e.g., delegates</td>
</tr>
<tr class="even">
<td>srcline</td>
<td>str</td>
<td></td>
<td>e.g., ” if hasattr(from_f,‘<strong>delwrap</strong>’): return f”</td>
</tr>
<tr class="odd">
<td>dbcode</td>
<td>str</td>
<td></td>
<td>str, e.g., “dbprint(…)”</td>
</tr>
<tr class="even">
<td>run</td>
<td>bool</td>
<td>True</td>
<td>run exec or not</td>
</tr>
<tr class="odd">
<td>dberror</td>
<td>bool</td>
<td>False</td>
<td>choose to debug error in source code by setting return None or not</td>
</tr>
<tr class="even">
<td>env</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>insert2debug??</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>
insert2debug<span class="ansi-blue-fg">(</span>
    name<span class="ansi-blue-fg">:</span> str<span class="ansi-blue-fg">,</span>
    srcline<span class="ansi-blue-fg">:</span> str<span class="ansi-blue-fg">,</span>
    dbcode<span class="ansi-blue-fg">:</span> str<span class="ansi-blue-fg">,</span>
    run<span class="ansi-blue-fg">:</span> bool <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    dberror<span class="ansi-blue-fg">:</span> bool <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    <span class="ansi-blue-fg">**</span>env<span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
<span class="ansi-green-fg">def</span> insert2debug<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">:</span>str<span class="ansi-blue-fg">,</span> <span class="ansi-red-fg"># name of a function to debug, e.g., delegates</span>
                 srcline<span class="ansi-blue-fg">:</span>str<span class="ansi-blue-fg">,</span> <span class="ansi-red-fg"># e.g., "        if hasattr(from_f,'__delwrap__'): return f"</span>
                 dbcode<span class="ansi-blue-fg">:</span>str<span class="ansi-blue-fg">,</span>  <span class="ansi-red-fg"># str, e.g., "dbprint(...)"</span>
                 run<span class="ansi-blue-fg">:</span>bool<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> <span class="ansi-red-fg"># run exec or not</span>
                 dberror<span class="ansi-blue-fg">:</span>bool<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-red-fg"># choose to debug error in source code by setting return None or not</span>
                 <span class="ansi-blue-fg">**</span>env<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
    <span class="ansi-blue-fg">"select a line or a block of source code and insert a dbprint above it and only output this dbprint result."</span>
    
    <span class="ansi-red-fg"># defaults.multi default to False, unless set True, defaults.deb is default to None before debugging srcode</span>
    <span class="ansi-green-fg">if</span> defaults<span class="ansi-blue-fg">.</span>multi <span class="ansi-green-fg">and</span> bool<span class="ansi-blue-fg">(</span>defaults<span class="ansi-blue-fg">.</span>deb<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> 
        srcode <span class="ansi-blue-fg">=</span> defaults<span class="ansi-blue-fg">.</span>deb
    <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span> 
        <span class="ansi-red-fg"># srcode = inspect.getsource(eval(name, globals().update(env)))</span>
        srcode <span class="ansi-blue-fg">=</span> defaults<span class="ansi-blue-fg">.</span>src
    lstxt <span class="ansi-blue-fg">=</span> srcode<span class="ansi-blue-fg">.</span>split<span class="ansi-blue-fg">(</span>srcline<span class="ansi-blue-fg">)</span>
    retn <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">""</span> 
    <span class="ansi-green-fg">if</span> dberror<span class="ansi-blue-fg">:</span> 
        retn <span class="ansi-blue-fg">=</span> retn <span class="ansi-blue-fg">+</span> <span class="ansi-blue-fg">"\n        return None\n"</span> <span class="ansi-red-fg">#  to exit the function, "" to continue on</span>
    insert <span class="ansi-blue-fg">=</span> colorize<span class="ansi-blue-fg">(</span>dbcode<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">"g"</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> colorize<span class="ansi-blue-fg">(</span>srcline<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">"r"</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> colorize<span class="ansi-blue-fg">(</span>retn<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">"y"</span><span class="ansi-blue-fg">)</span>
    src2print <span class="ansi-blue-fg">=</span> lstxt<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">+</span> insert <span class="ansi-blue-fg">+</span> lstxt<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span>
            
    src2db <span class="ansi-blue-fg">=</span> lstxt<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">+</span> dbcode <span class="ansi-blue-fg">+</span> retn <span class="ansi-blue-fg">+</span> srcline <span class="ansi-blue-fg">+</span> lstxt<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span> <span class="ansi-red-fg"># make sure return is before srcline and after dbcode</span>
    <span class="ansi-red-fg"># if defaults.multi: defaults.deb = src2db</span>
    defaults<span class="ansi-blue-fg">.</span>deb <span class="ansi-blue-fg">=</span> src2db
    
    <span class="ansi-red-fg"># to exec </span>
    <span class="ansi-green-fg">if</span> run<span class="ansi-blue-fg">:</span> 
        exec<span class="ansi-blue-fg">(</span>src2db<span class="ansi-blue-fg">,</span> globals<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">'srcline'</span><span class="ansi-blue-fg">:</span> srcline<span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-red-fg"># now a debuggable version of delegates is available to use</span>
        <span class="ansi-red-fg"># globals().update({name:eval(name)})</span>
        <span class="ansi-green-fg">return</span> eval<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">)</span> <span class="ansi-red-fg"># give this debuggable version of delegates to the notebook context</span>
    <span class="ansi-red-fg"># to not exec but only get the full debuggable source </span>
    <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span> 
        <span class="ansi-green-fg">return</span> <span class="ansi-green-fg">None</span>
<span class="ansi-red-fg">File:</span>      /var/folders/gz/ch3n2mp51m9386sytqf97s6w0000gn/T/ipykernel_18154/2335954138.py
<span class="ansi-red-fg">Type:</span>      function
</pre>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbsrclines(srcname:<span class="bu">str</span>, <span class="co"># name of the source code, e.g., delegates</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>               lines:<span class="bu">list</span> <span class="op">=</span> <span class="va">None</span> <span class="co"># if None then print all e.g., defaults.src2dbp.delegates</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>              ): </span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Doing one line or multilines of insert2debug on source code with dbprints."</span></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"defaults.src2dbp."</span> <span class="op">+</span> srcname)</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> L(srcdblist)</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">bool</span>(lines):</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> srcdblist:</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>            pprint(i[<span class="dv">0</span>][<span class="dv">0</span>], width<span class="op">=</span><span class="dv">157</span>)</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>            pprint(i[<span class="dv">0</span>][<span class="dv">1</span>], width<span class="op">=</span><span class="dv">157</span>)</span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(lines) <span class="op">&gt;</span> <span class="dv">1</span>: </span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a>        defaults.multi <span class="op">=</span> <span class="va">True</span></span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">eval</span>(<span class="st">"srcdblist"</span> <span class="op">+</span> <span class="bu">str</span>(lines)):</span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a>            delegates <span class="op">=</span> insert2debug(srcname, i[<span class="dv">0</span>][<span class="dv">0</span>], i[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb203-20"><a href="#cb203-20" aria-hidden="true" tabindex="-1"></a>        item <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"srcdblist"</span> <span class="op">+</span> <span class="bu">str</span>(lines))</span>
<span id="cb203-21"><a href="#cb203-21" aria-hidden="true" tabindex="-1"></a>        delegates <span class="op">=</span> insert2debug(srcname, item[<span class="dv">0</span>][<span class="dv">0</span>], item[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb203-22"><a href="#cb203-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb203-23"><a href="#cb203-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-24"><a href="#cb203-24" aria-hidden="true" tabindex="-1"></a>    defaults.multi <span class="op">=</span> <span class="va">False</span></span>
<span id="cb203-25"><a href="#cb203-25" aria-hidden="true" tabindex="-1"></a>    defaults.deb <span class="op">=</span> <span class="va">None</span></span>
<span id="cb203-26"><a href="#cb203-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> delegates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> L([[(<span class="dv">1</span>,<span class="dv">2</span>)],[(<span class="dv">2</span>,<span class="dv">2</span>)]]): </span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[(1, 2)]
[(2, 2)]</code></pre>
</div>
</div>
</section>
</section>
<section id="exporting-the-debuggable-source-and-major-problems-solved" class="level2">
<h2 class="anchored" data-anchor-id="exporting-the-debuggable-source-and-major-problems-solved">Exporting the debuggable source and major problems solved</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbsrclines(srcname:<span class="bu">str</span>, <span class="co"># name of the source code, e.g., delegates</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>               lines:<span class="bu">list</span> <span class="op">=</span> <span class="va">None</span>, <span class="co"># if None then print all e.g., defaults.src2dbp.delegates</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>               dbsrc:<span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span> <span class="co"># get the full debuggable source code</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>              ): </span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Doing one line or multilines of insert2debug on source code with dbprints."</span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"defaults.src2dbp."</span> <span class="op">+</span> srcname)</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> L(srcdblist)</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">bool</span>(lines) <span class="kw">and</span> dbsrc <span class="op">==</span> <span class="va">False</span>: <span class="co"># to print out the source code and mark all the srclines </span></span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> srcdblist:</span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>            pprint(i[<span class="dv">0</span>][<span class="dv">0</span>], width<span class="op">=</span><span class="dv">157</span>)</span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>            pprint(i[<span class="dv">0</span>][<span class="dv">1</span>], width<span class="op">=</span><span class="dv">157</span>)</span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> dbsrc <span class="kw">and</span> <span class="kw">not</span> <span class="bu">bool</span>(lines): <span class="co"># to print out the entire debuggable source code</span></span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a>        defaults.multi <span class="op">=</span> <span class="va">True</span></span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> srcdblist:</span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>            insert2debug(srcname, i[<span class="dv">0</span>][<span class="dv">0</span>], i[<span class="dv">0</span>][<span class="dv">1</span>], run<span class="op">=</span><span class="va">False</span>) <span class="co"># don't exec just add up debuggable source</span></span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># export the debuggable source</span></span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a>        defaults.src2dbp.delegatesdb <span class="op">=</span> defaults.deb</span>
<span id="cb206-22"><a href="#cb206-22" aria-hidden="true" tabindex="-1"></a>        pprint(defaults.src2dbp.delegatesdb, width<span class="op">=</span><span class="dv">157</span>)</span>
<span id="cb206-23"><a href="#cb206-23" aria-hidden="true" tabindex="-1"></a>        defaults.deb <span class="op">=</span> <span class="va">None</span></span>
<span id="cb206-24"><a href="#cb206-24" aria-hidden="true" tabindex="-1"></a>        defaults.multi <span class="op">=</span> <span class="va">False</span></span>
<span id="cb206-25"><a href="#cb206-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb206-26"><a href="#cb206-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb206-27"><a href="#cb206-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(lines) <span class="op">&gt;</span> <span class="dv">1</span>: </span>
<span id="cb206-28"><a href="#cb206-28" aria-hidden="true" tabindex="-1"></a>        defaults.multi <span class="op">=</span> <span class="va">True</span></span>
<span id="cb206-29"><a href="#cb206-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">eval</span>(<span class="st">"srcdblist"</span> <span class="op">+</span> <span class="bu">str</span>(lines)):</span>
<span id="cb206-30"><a href="#cb206-30" aria-hidden="true" tabindex="-1"></a>            delegates <span class="op">=</span> insert2debug(srcname, i[<span class="dv">0</span>][<span class="dv">0</span>], i[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb206-31"><a href="#cb206-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-32"><a href="#cb206-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb206-33"><a href="#cb206-33" aria-hidden="true" tabindex="-1"></a>        item <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"srcdblist"</span> <span class="op">+</span> <span class="bu">str</span>(lines))</span>
<span id="cb206-34"><a href="#cb206-34" aria-hidden="true" tabindex="-1"></a>        delegates <span class="op">=</span> insert2debug(srcname, item[<span class="dv">0</span>][<span class="dv">0</span>], item[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb206-35"><a href="#cb206-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-36"><a href="#cb206-36" aria-hidden="true" tabindex="-1"></a>    pprint(defaults.deb, width<span class="op">=</span><span class="dv">157</span>) <span class="co"># print the debuggable source</span></span>
<span id="cb206-37"><a href="#cb206-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-38"><a href="#cb206-38" aria-hidden="true" tabindex="-1"></a>    defaults.multi <span class="op">=</span> <span class="va">False</span></span>
<span id="cb206-39"><a href="#cb206-39" aria-hidden="true" tabindex="-1"></a>    defaults.deb <span class="op">=</span> <span class="va">None</span></span>
<span id="cb206-40"><a href="#cb206-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> delegates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="improve-the-print-feature-of-dbscrlines" class="level3">
<h3 class="anchored" data-anchor-id="improve-the-print-feature-of-dbscrlines">improve the print feature of dbscrlines</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbsrclines(srcname:<span class="bu">str</span>, <span class="co"># name of the source code, e.g., delegates</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>               lines:<span class="bu">list</span> <span class="op">=</span> <span class="va">None</span>, <span class="co"># if None then print all e.g., defaults.src2dbp.delegates</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>               dbsrc:<span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span> <span class="co"># get the full debuggable source code</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>              ): </span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Doing one line or multilines of insert2debug on source code with dbprints."</span></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"defaults.src2dbp."</span> <span class="op">+</span> srcname)</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> L(srcdblist)</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">bool</span>(lines) <span class="kw">and</span> dbsrc <span class="op">==</span> <span class="va">False</span>: <span class="co"># to print out the source code and mark all the srclines </span></span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># put all srclines into a single string</span></span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>        srclines <span class="op">=</span> <span class="st">""</span></span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> srcdblist:</span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a>            srclines <span class="op">=</span> srclines <span class="op">+</span> i[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> l <span class="kw">in</span> defaults.src.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>):</span>
<span id="cb207-16"><a href="#cb207-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="kw">in</span> srclines:</span>
<span id="cb207-17"><a href="#cb207-17" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:=&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb207-18"><a href="#cb207-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb207-19"><a href="#cb207-19" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb207-20"><a href="#cb207-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb207-21"><a href="#cb207-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb207-22"><a href="#cb207-22" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb207-23"><a href="#cb207-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> dbsrc <span class="kw">and</span> <span class="kw">not</span> <span class="bu">bool</span>(lines): <span class="co"># set dbsrc to true to export the entire debuggable source code to defaults.src2dbp.delegatesdb</span></span>
<span id="cb207-24"><a href="#cb207-24" aria-hidden="true" tabindex="-1"></a>        defaults.multi <span class="op">=</span> <span class="va">True</span></span>
<span id="cb207-25"><a href="#cb207-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> srcdblist:</span>
<span id="cb207-26"><a href="#cb207-26" aria-hidden="true" tabindex="-1"></a>            insert2debug(srcname, i[<span class="dv">0</span>][<span class="dv">0</span>], i[<span class="dv">0</span>][<span class="dv">1</span>], run<span class="op">=</span><span class="va">False</span>) <span class="co"># don't exec just add up debuggable source</span></span>
<span id="cb207-27"><a href="#cb207-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># export the debuggable source</span></span>
<span id="cb207-28"><a href="#cb207-28" aria-hidden="true" tabindex="-1"></a>        defaults.src2dbp.delegatesdb <span class="op">=</span> defaults.deb</span>
<span id="cb207-29"><a href="#cb207-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># pprint(defaults.src2dbp.delegatesdb, width=157)</span></span>
<span id="cb207-30"><a href="#cb207-30" aria-hidden="true" tabindex="-1"></a>        defaults.deb <span class="op">=</span> <span class="va">None</span></span>
<span id="cb207-31"><a href="#cb207-31" aria-hidden="true" tabindex="-1"></a>        defaults.multi <span class="op">=</span> <span class="va">False</span></span>
<span id="cb207-32"><a href="#cb207-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb207-33"><a href="#cb207-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb207-34"><a href="#cb207-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(lines) <span class="op">&gt;</span> <span class="dv">1</span>: </span>
<span id="cb207-35"><a href="#cb207-35" aria-hidden="true" tabindex="-1"></a>        defaults.multi <span class="op">=</span> <span class="va">True</span></span>
<span id="cb207-36"><a href="#cb207-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">eval</span>(<span class="st">"srcdblist"</span> <span class="op">+</span> <span class="bu">str</span>(lines)):</span>
<span id="cb207-37"><a href="#cb207-37" aria-hidden="true" tabindex="-1"></a>            delegates <span class="op">=</span> insert2debug(srcname, i[<span class="dv">0</span>][<span class="dv">0</span>], i[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb207-38"><a href="#cb207-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-39"><a href="#cb207-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb207-40"><a href="#cb207-40" aria-hidden="true" tabindex="-1"></a>        item <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"srcdblist"</span> <span class="op">+</span> <span class="bu">str</span>(lines))</span>
<span id="cb207-41"><a href="#cb207-41" aria-hidden="true" tabindex="-1"></a>        delegates <span class="op">=</span> insert2debug(srcname, item[<span class="dv">0</span>][<span class="dv">0</span>], item[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb207-42"><a href="#cb207-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-43"><a href="#cb207-43" aria-hidden="true" tabindex="-1"></a>    pprint(defaults.deb, width<span class="op">=</span><span class="dv">157</span>) <span class="co"># print the debuggable source</span></span>
<span id="cb207-44"><a href="#cb207-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-45"><a href="#cb207-45" aria-hidden="true" tabindex="-1"></a>    defaults.multi <span class="op">=</span> <span class="va">False</span></span>
<span id="cb207-46"><a href="#cb207-46" aria-hidden="true" tabindex="-1"></a>    defaults.deb <span class="op">=</span> <span class="va">None</span></span>
<span id="cb207-47"><a href="#cb207-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> delegates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-return-to-the-last-dbcode-for-debugging-examples-which-cause-errors" class="level3">
<h3 class="anchored" data-anchor-id="add-return-to-the-last-dbcode-for-debugging-examples-which-cause-errors">add return to the last dbcode for debugging examples which cause errors</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dbsrclines(srcname:<span class="bu">str</span>, <span class="co"># name of the source code, e.g., delegates</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>               lines:<span class="bu">list</span> <span class="op">=</span> <span class="va">None</span>, <span class="co"># if None then print all e.g., defaults.src2dbp.delegates</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>               dbsrc:<span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, <span class="co"># get the full debuggable source code</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>               retn:<span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span> <span class="co"># choose to add return None after the last dbcode</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>              ): </span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Doing one line or multilines of insert2debug on source code with dbprints."</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"defaults.src2dbp."</span> <span class="op">+</span> srcname)</span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> L(srcdblist)</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">bool</span>(lines) <span class="kw">and</span> dbsrc <span class="op">==</span> <span class="va">False</span>: <span class="co"># to print out the source code and mark all the srclines </span></span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># put all srclines into a single string</span></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>        srclines <span class="op">=</span> <span class="st">""</span></span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> srcdblist:</span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>            srclines <span class="op">=</span> srclines <span class="op">+</span> i[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> l <span class="kw">in</span> defaults.src.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>):</span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="kw">in</span> srclines:</span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:=&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>: </span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">""</span>)</span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb208-23"><a href="#cb208-23" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb208-24"><a href="#cb208-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> dbsrc <span class="kw">and</span> <span class="kw">not</span> <span class="bu">bool</span>(lines): <span class="co"># set dbsrc to true to export the entire debuggable source code to defaults.src2dbp.delegatesdb</span></span>
<span id="cb208-25"><a href="#cb208-25" aria-hidden="true" tabindex="-1"></a>        defaults.multi <span class="op">=</span> <span class="va">True</span></span>
<span id="cb208-26"><a href="#cb208-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> srcdblist:</span>
<span id="cb208-27"><a href="#cb208-27" aria-hidden="true" tabindex="-1"></a>            insert2debug(srcname, i[<span class="dv">0</span>][<span class="dv">0</span>], i[<span class="dv">0</span>][<span class="dv">1</span>], run<span class="op">=</span><span class="va">False</span>) <span class="co"># don't exec just add up debuggable source</span></span>
<span id="cb208-28"><a href="#cb208-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># export the debuggable source</span></span>
<span id="cb208-29"><a href="#cb208-29" aria-hidden="true" tabindex="-1"></a>        defaults.src2dbp.delegatesdb <span class="op">=</span> defaults.deb</span>
<span id="cb208-30"><a href="#cb208-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># pprint(defaults.src2dbp.delegatesdb, width=157)</span></span>
<span id="cb208-31"><a href="#cb208-31" aria-hidden="true" tabindex="-1"></a>        defaults.deb <span class="op">=</span> <span class="va">None</span></span>
<span id="cb208-32"><a href="#cb208-32" aria-hidden="true" tabindex="-1"></a>        defaults.multi <span class="op">=</span> <span class="va">False</span></span>
<span id="cb208-33"><a href="#cb208-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb208-34"><a href="#cb208-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb208-35"><a href="#cb208-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(lines) <span class="op">&gt;</span> <span class="dv">1</span>: </span>
<span id="cb208-36"><a href="#cb208-36" aria-hidden="true" tabindex="-1"></a>        defaults.multi <span class="op">=</span> <span class="va">True</span></span>
<span id="cb208-37"><a href="#cb208-37" aria-hidden="true" tabindex="-1"></a>        lst <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"srcdblist"</span> <span class="op">+</span> <span class="bu">str</span>(lines))</span>
<span id="cb208-38"><a href="#cb208-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> idx, i <span class="kw">in</span> <span class="bu">zip</span>(<span class="bu">range</span>(<span class="bu">len</span>(lst)), lst): <span class="co"># add retn to the last dbcode</span></span>
<span id="cb208-39"><a href="#cb208-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> retn <span class="kw">and</span> idx <span class="op">==</span> <span class="bu">len</span>(lst)<span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb208-40"><a href="#cb208-40" aria-hidden="true" tabindex="-1"></a>                delegates <span class="op">=</span> insert2debug(srcname, i[<span class="dv">0</span>][<span class="dv">0</span>], i[<span class="dv">0</span>][<span class="dv">1</span>], dberror<span class="op">=</span><span class="va">True</span>) <span class="co">### add dberror to insert2debug</span></span>
<span id="cb208-41"><a href="#cb208-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb208-42"><a href="#cb208-42" aria-hidden="true" tabindex="-1"></a>                delegates <span class="op">=</span> insert2debug(srcname, i[<span class="dv">0</span>][<span class="dv">0</span>], i[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb208-43"><a href="#cb208-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-44"><a href="#cb208-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb208-45"><a href="#cb208-45" aria-hidden="true" tabindex="-1"></a>        item <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"srcdblist"</span> <span class="op">+</span> <span class="bu">str</span>(lines))</span>
<span id="cb208-46"><a href="#cb208-46" aria-hidden="true" tabindex="-1"></a>        delegates <span class="op">=</span> insert2debug(srcname, item[<span class="dv">0</span>][<span class="dv">0</span>], item[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb208-47"><a href="#cb208-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-48"><a href="#cb208-48" aria-hidden="true" tabindex="-1"></a>    pprint(defaults.deb, width<span class="op">=</span><span class="dv">157</span>) <span class="co"># print the debuggable source</span></span>
<span id="cb208-49"><a href="#cb208-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-50"><a href="#cb208-50" aria-hidden="true" tabindex="-1"></a>    defaults.multi <span class="op">=</span> <span class="va">False</span></span>
<span id="cb208-51"><a href="#cb208-51" aria-hidden="true" tabindex="-1"></a>    defaults.deb <span class="op">=</span> <span class="va">None</span></span>
<span id="cb208-52"><a href="#cb208-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> delegates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="dbsrclines" class="level3">
<h3 class="anchored" data-anchor-id="dbsrclines">dbsrclines</h3>
<blockquote class="blockquote">
<pre><code> dbsrclines (lines:list=None, dbsrc:bool=False, retn:bool=False)</code></pre>
</blockquote>
<p>Doing one line or multilines of insert2debug on source code with dbprints.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>lines</td>
<td>list</td>
<td>None</td>
<td>if None then print all e.g., defaults.src2dbp.delegates</td>
</tr>
<tr class="even">
<td>dbsrc</td>
<td>bool</td>
<td>False</td>
<td>get the full debuggable source code</td>
</tr>
<tr class="odd">
<td>retn</td>
<td>bool</td>
<td>False</td>
<td>choose to add return None after the last dbcode</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="check-official-source-against-debuggable-source" class="level2">
<h2 class="anchored" data-anchor-id="check-official-source-against-debuggable-source">check official source against debuggable source</h2>
<section id="add-markers-and-raise-error-when-there-is-update-of-the-srcode" class="level3">
<h3 class="anchored" data-anchor-id="add-markers-and-raise-error-when-there-is-update-of-the-srcode">Add markers and raise error when there is update of the srcode</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> checksrc(srcname):</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"check src code against dbsource. Also the latest srcode is stored inside defaults.src."</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>    defaults.src <span class="op">=</span> inspect.getsource(<span class="bu">eval</span>(srcname))</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># file1 = open("db/" + srcname + ".txt","r+") </span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># now dbsrc == defaults.src2dbp.delegatesdb</span></span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>    dbsrc <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"defaults.src2dbp."</span> <span class="op">+</span> srcname <span class="op">+</span> <span class="st">"db"</span>)</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dbsrc = file1.read()</span></span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># file1.close()</span></span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>    lst <span class="op">=</span> defaults.src.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> lst: </span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">bool</span>(dbsrc) <span class="kw">and</span> l.strip() <span class="kw">in</span> dbsrc:</span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>: </span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'</span><span class="sc">{:=&lt;157}</span><span class="st">'</span>.<span class="bu">format</span>(l))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">u'</span><span class="ch">\u2713</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>✓</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #|export</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="co"># def checksrc():</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     "check src code against dbsource. Also the latest srcode is stored inside defaults.src."</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     srcname = defaults.name</span></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     defaults.src = inspect.getsource(eval(srcname))</span></span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     # file1 = open("db/" + srcname + ".txt","r+") </span></span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     # now dbsrc == defaults.src2dbp.delegatesdb</span></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     dbsrc = eval("defaults.src2dbp." + srcname + "db")</span></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     # dbsrc = file1.read()</span></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     # file1.close()</span></span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     lst = defaults.src.split('\n')</span></span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a><span class="co">#     for l in lst: </span></span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a><span class="co">#         if bool(dbsrc) and l.strip() in dbsrc:</span></span>
<span id="cb213-17"><a href="#cb213-17" aria-hidden="true" tabindex="-1"></a><span class="co">#             marker = f'(u\'\u2713\')'</span></span>
<span id="cb213-18"><a href="#cb213-18" aria-hidden="true" tabindex="-1"></a><span class="co">#             indent = defaults.margin - len(l) - len(marker)</span></span>
<span id="cb213-19"><a href="#cb213-19" aria-hidden="true" tabindex="-1"></a><span class="co">#             print(l + "="*indent + marker)    </span></span>
<span id="cb213-20"><a href="#cb213-20" aria-hidden="true" tabindex="-1"></a><span class="co">#         else: </span></span>
<span id="cb213-21"><a href="#cb213-21" aria-hidden="true" tabindex="-1"></a><span class="co">#             print('{:=&lt;157}'.format(l))</span></span>
<span id="cb213-22"><a href="#cb213-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb213-23"><a href="#cb213-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb213-24"><a href="#cb213-24" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb213-25"><a href="#cb213-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     if bool(dbsrc) == False: </span></span>
<span id="cb213-26"><a href="#cb213-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     print(f'your debuggable srcode is empty. You have not written any, or you have lost your defaults.src2dbp.{srcname}db content.')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="checksrc" class="level3">
<h3 class="anchored" data-anchor-id="checksrc">checksrc</h3>
<blockquote class="blockquote">
<pre><code> checksrc ()</code></pre>
</blockquote>
<p>check src code against dbsource. Also the latest srcode is stored inside defaults.src.</p>
<hr>
</section>
<section id="strip_ansi" class="level3">
<h3 class="anchored" data-anchor-id="strip_ansi">strip_ansi</h3>
<blockquote class="blockquote">
<pre><code> strip_ansi (source)</code></pre>
</blockquote>
<hr>
</section>
<section id="alignright-1" class="level3">
<h3 class="anchored" data-anchor-id="alignright-1">alignright</h3>
<blockquote class="blockquote">
<pre><code> alignright (blocks)</code></pre>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>alignright(<span class="st">"this is me"</span>)</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>alignright(<span class="st">"</span><span class="ch">\x1b</span><span class="st">[91mthis is me</span><span class="ch">\x1b</span><span class="st">[0m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                                                                                   this is me
                                                                                                                                                   this is me</code></pre>
</div>
</div>
</section>
</section>
<section id="how-to-shuffle" class="level2">
<h2 class="anchored" data-anchor-id="how-to-shuffle">How to shuffle</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>src <span class="op">=</span> <span class="st">"    def low(a, b=1):</span><span class="ch">\n</span><span class="st">        c = b*2</span><span class="ch">\n</span><span class="st">        return a + b + c"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> l <span class="kw">in</span> src.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>): <span class="bu">print</span>(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    def low(a, b=1):
        c = b*2
        return a + b + c</code></pre>
</div>
</div>
<p>I have a list of tuples, and the first item of each tuple contains a line of the function above. The problem is the order of the lines are random.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>srcshuffled <span class="op">=</span> [[(<span class="st">"        return a + b + c"</span>, <span class="st">"this is the end of the func"</span>)],[(<span class="st">"        c = b*2"</span>, <span class="st">"first line inside the func"</span>)],[(<span class="st">"    def low(a, b=1):"</span>, <span class="st">"this is where signature is"</span>)]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> srcshuffled:</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(s[<span class="dv">0</span>][<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        return a + b + c
        c = b*2
    def low(a, b=1):</code></pre>
</div>
</div>
<p>How can I reorder the list so that the first item of each tuple matches the function in the right order?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>srcorrect <span class="op">=</span> [[(<span class="st">"    def low(a, b=1):"</span>, <span class="st">"this is where signature is"</span>)],[(<span class="st">"        c = b*2"</span>, <span class="st">"first line inside the func"</span>)], [(<span class="st">"        return a + b + c"</span>, <span class="st">"this is the end of the func"</span>)]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> srcorrect:</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(s[<span class="dv">0</span>][<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    def low(a, b=1):
        c = b*2
        return a + b + c</code></pre>
</div>
</div>
<p>my attempt</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, l <span class="kw">in</span> <span class="bu">zip</span>(<span class="bu">range</span>(<span class="bu">len</span>(src.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))), src.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)):</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(idx)</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0
    def low(a, b=1):
1
        c = b*2
2
        return a + b + c</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>srcorrect1 <span class="op">=</span> []</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> l <span class="kw">in</span> src.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>):</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> s <span class="kw">in</span> srcshuffled: </span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> l.strip() <span class="kw">in</span> s[<span class="dv">0</span>][<span class="dv">0</span>]:</span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>            srcorrect1.append(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> srcorrect1:</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(s[<span class="dv">0</span>][<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    def low(a, b=1):
        c = b*2
        return a + b + c</code></pre>
</div>
</div>
<hr>
<section id="matchsrcorder" class="level3">
<h3 class="anchored" data-anchor-id="matchsrcorder">matchsrcorder</h3>
<blockquote class="blockquote">
<pre><code> matchsrcorder (srcdbps:list)</code></pre>
</blockquote>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>srcdbps</td>
<td>list</td>
<td>the list contain all srclines and their dbcodes with random order</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="display-official-source-code-with-index-markers" class="level2">
<h2 class="anchored" data-anchor-id="display-official-source-code-with-index-markers">display official source code with index markers</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> displaysrc(startsrc, endsrc):</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>    mark <span class="op">=</span> <span class="va">False</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> defaults.src.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>):</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> startsrc <span class="kw">in</span> l: mark <span class="op">=</span> <span class="va">True</span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mark:</span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>            marker <span class="op">=</span> <span class="ss">f'( </span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss"> )'</span> <span class="op">+</span> <span class="st">"     "</span></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>            indent <span class="op">=</span> defaults.margin <span class="op">-</span> <span class="bu">len</span>(l) <span class="op">-</span> <span class="bu">len</span>(marker)</span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(l <span class="op">+</span> <span class="st">" "</span><span class="op">*</span>indent <span class="op">+</span> marker)</span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>            idx <span class="op">=</span> idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> endsrc <span class="kw">in</span> l: mark <span class="op">=</span> <span class="va">False</span></span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> displaysrc(srcname:<span class="bu">str</span>, <span class="co"># name of src code like delegates</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>               startsrc:<span class="bu">str</span>, <span class="co"># a piece of code like "if to is None"</span></span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>               endsrc:<span class="bu">str</span>): <span class="co"># a piece of code like "from_f.__annotations__.update(anno)"</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"defaults.src2dbp."</span> <span class="op">+</span> srcname)</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> L(srcdblist)</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>    srclines <span class="op">=</span> <span class="st">""</span> <span class="co"># store all the debuggable srclines here</span></span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> srcdblist:</span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>        srclines <span class="op">=</span> srclines <span class="op">+</span> i[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a>    mark <span class="op">=</span> <span class="va">False</span></span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> defaults.src.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>):</span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-15"><a href="#cb235-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to mark the index for the targed src codes</span></span>
<span id="cb235-16"><a href="#cb235-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> startsrc <span class="kw">in</span> l: mark <span class="op">=</span> <span class="va">True</span></span>
<span id="cb235-17"><a href="#cb235-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mark:</span>
<span id="cb235-18"><a href="#cb235-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="kw">in</span> srclines:</span>
<span id="cb235-19"><a href="#cb235-19" aria-hidden="true" tabindex="-1"></a>                marker <span class="op">=</span> <span class="ss">f'( </span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss"> )'</span> <span class="op">+</span> <span class="st">"====="</span></span>
<span id="cb235-20"><a href="#cb235-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb235-21"><a href="#cb235-21" aria-hidden="true" tabindex="-1"></a>                marker <span class="op">=</span> <span class="ss">f'( </span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss"> )'</span> <span class="op">+</span> <span class="st">"     "</span></span>
<span id="cb235-22"><a href="#cb235-22" aria-hidden="true" tabindex="-1"></a>            indent <span class="op">=</span> defaults.margin <span class="op">-</span> <span class="bu">len</span>(l) <span class="op">-</span> <span class="bu">len</span>(marker)</span>
<span id="cb235-23"><a href="#cb235-23" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(l <span class="op">+</span> <span class="st">" "</span><span class="op">*</span>indent <span class="op">+</span> marker)</span>
<span id="cb235-24"><a href="#cb235-24" aria-hidden="true" tabindex="-1"></a>            idx <span class="op">=</span> idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb235-25"><a href="#cb235-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> endsrc <span class="kw">in</span> l: mark <span class="op">=</span> <span class="va">False</span></span>
<span id="cb235-26"><a href="#cb235-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb235-27"><a href="#cb235-27" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="add-index-marker-for-debuggable-source-lines" class="level3">
<h3 class="anchored" data-anchor-id="add-index-marker-for-debuggable-source-lines">add index marker for debuggable source lines</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> displaysrc():</span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>    srcname <span class="op">=</span> defaults.name <span class="co"># name of src code like delegates</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>    startsrc <span class="op">=</span> defaults.startsrc <span class="co"># a piece of code like "if to is None"</span></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>    endsrc <span class="op">=</span> defaults.endsrc <span class="co"># a piece of code like "from_f.__annotations__.update(anno)"</span></span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"defaults.src2dbp."</span> <span class="op">+</span> srcname)</span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> L(srcdblist)</span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>    srclines <span class="op">=</span> <span class="st">""</span> <span class="co"># store all the debuggable srclines here</span></span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> srcdblist:</span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a>        srclines <span class="op">=</span> srclines <span class="op">+</span> i[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb236-13"><a href="#cb236-13" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb236-14"><a href="#cb236-14" aria-hidden="true" tabindex="-1"></a>    mark <span class="op">=</span> <span class="va">False</span></span>
<span id="cb236-15"><a href="#cb236-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> defaults.src.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>):</span>
<span id="cb236-16"><a href="#cb236-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-17"><a href="#cb236-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to mark the index for the targed src codes</span></span>
<span id="cb236-18"><a href="#cb236-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> startsrc <span class="kw">in</span> l: mark <span class="op">=</span> <span class="va">True</span></span>
<span id="cb236-19"><a href="#cb236-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mark:</span>
<span id="cb236-20"><a href="#cb236-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> l <span class="kw">in</span> srclines:</span>
<span id="cb236-21"><a href="#cb236-21" aria-hidden="true" tabindex="-1"></a>                marker <span class="op">=</span> <span class="ss">f'( </span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss"> )'</span> <span class="op">+</span> <span class="st">"====="</span></span>
<span id="cb236-22"><a href="#cb236-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb236-23"><a href="#cb236-23" aria-hidden="true" tabindex="-1"></a>                marker <span class="op">=</span> <span class="ss">f'( </span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss"> )'</span> <span class="op">+</span> <span class="st">"     "</span></span>
<span id="cb236-24"><a href="#cb236-24" aria-hidden="true" tabindex="-1"></a>            indent <span class="op">=</span> defaults.margin <span class="op">-</span> <span class="bu">len</span>(l) <span class="op">-</span> <span class="bu">len</span>(marker)</span>
<span id="cb236-25"><a href="#cb236-25" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(l <span class="op">+</span> <span class="st">" "</span><span class="op">*</span>indent <span class="op">+</span> marker)</span>
<span id="cb236-26"><a href="#cb236-26" aria-hidden="true" tabindex="-1"></a>            idx <span class="op">=</span> idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb236-27"><a href="#cb236-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> endsrc <span class="kw">in</span> l: mark <span class="op">=</span> <span class="va">False</span></span>
<span id="cb236-28"><a href="#cb236-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb236-29"><a href="#cb236-29" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="marking-the-debuggable-srcline-with-its-own-index" class="level3">
<h3 class="anchored" data-anchor-id="marking-the-debuggable-srcline-with-its-own-index">Marking the debuggable srcline with its own index</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> displaysrc():</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"display the official source code also marking the debuggable srclines"</span></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>    srcname <span class="op">=</span> defaults.name <span class="co"># name of src code like delegates</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>    startsrc <span class="op">=</span> defaults.startsrc <span class="co"># a piece of code like "if to is None"</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>    endsrc <span class="op">=</span> defaults.endsrc <span class="co"># a piece of code like "from_f.__annotations__.update(anno)"</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> <span class="bu">eval</span>(<span class="st">"defaults.src2dbp."</span> <span class="op">+</span> srcname)</span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>    srcdblist <span class="op">=</span> L(srcdblist)</span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a>    mark <span class="op">=</span> <span class="va">False</span></span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> l <span class="kw">in</span> defaults.src.split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>):</span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to mark the index for the targed src codes</span></span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> startsrc <span class="kw">in</span> l: mark <span class="op">=</span> <span class="va">True</span></span>
<span id="cb237-16"><a href="#cb237-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mark:</span>
<span id="cb237-17"><a href="#cb237-17" aria-hidden="true" tabindex="-1"></a>            marker <span class="op">=</span> <span class="ss">f'( </span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss"> )'</span> <span class="op">+</span> <span class="st">"     "</span></span>
<span id="cb237-18"><a href="#cb237-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> idxi, i <span class="kw">in</span> <span class="bu">zip</span>(<span class="bu">range</span>(<span class="bu">len</span>(srcdblist)), srcdblist):</span>
<span id="cb237-19"><a href="#cb237-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-20"><a href="#cb237-20" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> l.strip() <span class="kw">in</span> i[<span class="dv">0</span>][<span class="dv">0</span>]:</span>
<span id="cb237-21"><a href="#cb237-21" aria-hidden="true" tabindex="-1"></a>                    premark <span class="op">=</span> <span class="ss">f'=========='</span></span>
<span id="cb237-22"><a href="#cb237-22" aria-hidden="true" tabindex="-1"></a>                    marker <span class="op">=</span> premark <span class="op">+</span> <span class="ss">f'( </span><span class="sc">{</span>idx<span class="sc">}</span><span class="ss"> )'</span> <span class="op">+</span> <span class="ss">f'==</span><span class="sc">{</span>idxi<span class="sc">}</span><span class="ss">=='</span></span>
<span id="cb237-23"><a href="#cb237-23" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span></span>
<span id="cb237-24"><a href="#cb237-24" aria-hidden="true" tabindex="-1"></a>            indent <span class="op">=</span> defaults.margin <span class="op">-</span> <span class="bu">len</span>(l) <span class="op">-</span> <span class="bu">len</span>(marker)</span>
<span id="cb237-25"><a href="#cb237-25" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(l <span class="op">+</span> <span class="st">" "</span><span class="op">*</span>indent <span class="op">+</span> marker)</span>
<span id="cb237-26"><a href="#cb237-26" aria-hidden="true" tabindex="-1"></a>            idx <span class="op">=</span> idx <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb237-27"><a href="#cb237-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> endsrc <span class="kw">in</span> l: mark <span class="op">=</span> <span class="va">False</span></span>
<span id="cb237-28"><a href="#cb237-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb237-29"><a href="#cb237-29" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="displaysrc" class="level3">
<h3 class="anchored" data-anchor-id="displaysrc">displaysrc</h3>
<blockquote class="blockquote">
<pre><code> displaysrc ()</code></pre>
</blockquote>
<p>display the official source code also marking the debuggable srclines</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>